{
  "version": 3,
  "sources": ["../../../src/helpers.js", "../../../src/dataSources/newsAggregator.js", "../../../src/dataSources/folo-multi-feeds.js", "../../../src/dataSources/aibase.js", "../../../src/dataSources/jiqizhixin.js", "../../../src/dataSources/qbit.js", "../../../src/dataSources/xinzhiyuan.js", "../../../src/dataSources/xiaohu.js", "../../../src/chatapi.js", "../../../src/dataSources/github-trending.js", "../../../src/dataSources/papers.js", "../../../src/dataSources/huggingface-papers.js", "../../../src/dataSources/twitter.js", "../../../src/dataSources/reddit.js", "../../../src/dataFetchers.js", "../../../src/kv.js", "../../../src/handlers/writeData.js", "../../../src/handlers/getContent.js", "../../../src/marked.esm.js", "../../../src/htmlGenerators.js", "../../../src/handlers/getContentHtml.js", "../../../src/prompt/summarizationPromptStepZero.js", "../../../src/prompt/summarizationPromptStepThree.js", "../../../src/prompt/podcastFormattingPrompt.js", "../../../src/prompt/dailyAnalysisPrompt.js", "../../../src/foot.js", "../../../src/ad.js", "../../../src/github.js", "../../../src/handlers/genAIContent.js", "../../../src/handlers/genAIDailyPage.js", "../../../src/handlers/commitToGitHub.js", "../../../src/handlers/getRss.js", "../../../src/handlers/writeRssData.js", "../../../src/auth.js", "../../../src/handlers/scheduled.js", "../../../src/prompt/weeklyBlogPrompt.js", "../../../src/handlers/scheduledWeeklyBlog.js", "../../../src/prompt/dailyBlogPrompt.js", "../../../src/handlers/scheduledDailyBlog.js", "../../../src/index.js", "file:///C:/Users/dongy/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "file:///C:/Users/dongy/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-scheduled.ts", "file:///C:/Users/dongy/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-C2nWIe/middleware-insertion-facade.js", "file:///C:/Users/dongy/AppData/Roaming/npm/node_modules/wrangler/templates/middleware/common.ts", "../bundle-C2nWIe/middleware-loader.entry.ts"],
  "sourceRoot": "D:\\GitHub\\CloudFlare-AI-Insight-Daily\\.wrangler\\tmp\\dev-la0Gt3",
  "sourcesContent": ["// src/helpers.js\r\n\r\n/**\r\n * \u5168\u57DF\u53C3\u6578\uFF0C\u7528\u65BC\u6307\u5B9A\u8CC7\u6599\u6293\u53D6\u7684\u65E5\u671F\u3002\r\n * \u9810\u8A2D\u70BA\u7576\u524D\u65E5\u671F\uFF0C\u683C\u5F0F\u70BA YYYY-MM-DD\u3002\r\n */\r\nexport let fetchDate = getISODate();\r\n\r\nexport function setFetchDate(date) {\r\n    fetchDate = date;\r\n}\r\n\r\nexport function getFetchDate() {\r\n    return fetchDate;\r\n}\r\n\r\n/**\r\n * Gets the current date or a specified date in YYYY-MM-DD format.\r\n * @param {Date} [dateObj] - Optional Date object. Defaults to current date.\r\n * @returns {string} Date string in YYYY-MM-DD format.\r\n */\r\nexport function getISODate(dateObj = new Date()) {\r\n    const options = {\r\n        year: 'numeric',\r\n        month: '2-digit',\r\n        day: '2-digit',\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n    // \u4F7F\u7528 'en-CA' \u8A9E\u8A00\u74B0\u5883\uFF0C\u56E0\u70BA\u5B83\u901A\u5E38\u6703\u7522\u751F YYYY-MM-DD \u683C\u5F0F\u7684\u65E5\u671F\u5B57\u4E32\r\n    const dateString = dateObj.toLocaleDateString('en-CA', options);\r\n    return dateString;\r\n}\r\n\r\n/**\r\n * Escapes HTML special characters in a string.\r\n * @param {*} unsafe The input to escape. If not a string, it's converted. Null/undefined become empty string.\r\n * @returns {string} The escaped string.\r\n */\r\nexport function escapeHtml(unsafe) {\r\n    if (unsafe === null || typeof unsafe === 'undefined') {\r\n        return '';\r\n    }\r\n    const str = String(unsafe);\r\n    const map = {\r\n        '&': '&',\r\n        '<': '<',\r\n        '>': '>',\r\n        '\"': '\"',\r\n        \"'\": '&#039;'\r\n    };\r\n    return str.replace(/[&<>\"']/g, (m) => map[m]);\r\n}\r\n\r\n/**\r\n * Generic fetch wrapper with JSON parsing and error handling.\r\n * @param {string} url - The URL to fetch.\r\n * @param {object} [options] - Fetch options.\r\n * @returns {Promise<object>} The JSON response or text for non-JSON.\r\n * @throws {Error} If the fetch fails or response is not ok.\r\n */\r\nexport async function fetchData(url, options = {}) {\r\n    const response = await fetch(url, options);\r\n    if (!response.ok) {\r\n        const errorText = await response.text();\r\n        throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}, url: ${url}`);\r\n    }\r\n    return response.json();\r\n}\r\n\r\n/**\r\n * Removes markdown code block fences (```json or ```) from a string.\r\n * @param {string} text - The input string potentially containing markdown code fences.\r\n * @returns {string} The string with markdown code fences removed.\r\n */\r\nexport function removeMarkdownCodeBlock(text) {\r\n    if (!text) return '';\r\n    const cleanedText = text.trim();\r\n    // Match first code block (```...```) and capture content inside\r\n    const match = cleanedText.match(/```(?:\\w*)\\s*([\\s\\S]*?)\\s*```/);\r\n    if (match) {\r\n        return match[1].trim();\r\n    }\r\n    return cleanedText;\r\n}\r\n\r\n/**\r\n * Strips HTML tags from a string and normalizes whitespace.\r\n * @param {string} html - The HTML string.\r\n * @returns {string} The text content without HTML tags.\r\n */\r\nexport function stripHtml(html) {\r\n    if (!html) return \"\";\r\n\r\n    // \u8655\u7406 img \u6A19\u7C64\uFF0C\u4FDD\u7559\u5176 src \u548C alt \u5C6C\u6027\r\n    let processedHtml = html.replace(/<img[^>]*src=\"([^\"]*)\"[^>]*alt=\"([^\"]*)\"[^>]*>/gi, (match, src, alt) => {\r\n        return alt ? `[\u56FE\u7247: ${alt} ${src}]` : `[\u56FE\u7247: ${src}]`;\r\n    });\r\n    processedHtml = processedHtml.replace(/<img[^>]*src=\"([^\"]*)\"[^>]*>/gi, '[\u56FE\u7247: $1]');\r\n\r\n    // \u5904\u7406 video \u6807\u7B7E\uFF0C\u4FDD\u7559\u5176 src \u5C5E\u6027\r\n    processedHtml = processedHtml.replace(/<video[^>]*src=\"([^\"]*)\"[^>]*>.*?<\\/video>/gi, '[\u89C6\u9891: $1]');\r\n\r\n    // \u79FB\u9664\u6240\u6709\u5176\u4ED6 HTML \u6807\u7B7E\uFF0C\u5E76\u89C4\u8303\u5316\u7A7A\u767D\r\n    return processedHtml.replace(/<[^>]+>/g, ' ').replace(/\\s+/g, ' ').trim();\r\n}\r\n\r\n/**\r\n * \u5C06 stripHtml \u4EA7\u751F\u7684\u5A92\u4F53\u5360\u4F4D\u7B26\u8F6C\u6362\u4E3A Markdown \u56FE\u7247\u3002\r\n * \u5F62\u5982\uFF1A\r\n *  - [\u56FE\u7247: https://xx/1.png]\r\n *  - [\u56FE\u7247: \u63CF\u8FF0 https://xx/1.png]\r\n */\r\nexport function convertPlaceholdersToMarkdownImages(text) {\r\n    if (!text) return '';\r\n    const str = String(text);\r\n    const isVideoUrl = (url) => /\\.(mp4|mov|webm)(\\?|#|$)/i.test(url);\r\n    const toVideoTag = (url) => `<video controls preload=\"metadata\" playsinline style=\"max-width:100%; height:auto;\" src=\"${url}\"></video>`;\r\n    const withVideos = str.replace(/\\[\u89C6\u9891:\\s*([^\\]]+?)\\]/g, (match, inner) => {\r\n        const parts = inner.trim().split(/\\s+/);\r\n        const url = parts[parts.length - 1];\r\n        if (!/^https?:\\/\\//i.test(url)) return match;\r\n        if (isVideoUrl(url)) return toVideoTag(url);\r\n        const label = parts.slice(0, -1).join(' ') || '\u89C6\u9891';\r\n        return `[${label}](${url})`;\r\n    });\r\n    return withVideos.replace(/\\[\u56FE\u7247:\\s*([^\\]]+?)\\]/g, (match, inner) => {\r\n        const parts = inner.trim().split(/\\s+/);\r\n        const url = parts[parts.length - 1];\r\n        if (!/^https?:\\/\\//i.test(url)) return match;\r\n        if (isVideoUrl(url)) return toVideoTag(url);\r\n        const alt = parts.slice(0, -1).join(' ') || 'AI\u8D44\u8BAF\u56FE\u7247';\r\n        return `![${alt}](${url})`;\r\n    });\r\n}\r\n\r\n/**\r\n * Checks if a given date string is within the last specified number of days (inclusive of today).\r\n * @param {string} dateString - The date string to check (YYYY-MM-DD).\r\n * @param {number} days - The number of days to look back (e.g., 3 for today and the past 2 days).\r\n * @returns {boolean} True if the date is within the last 'days', false otherwise.\r\n */\r\n/**\r\n * Converts a date string to a Date object representing the time in Asia/Shanghai timezone.\r\n * This is crucial for consistent date comparisons across different environments.\r\n * @param {string} dateString - The date string to convert.\r\n * @returns {Date} A Date object set to the specified date in Asia/Shanghai timezone.\r\n */\r\nexport function convertToShanghaiTime(dateString) {\r\n    // Create a Date object from the ISO string.\r\n    const date = new Date(dateString);\r\n\r\n    // Get the date components in Asia/Shanghai timezone\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: 'numeric',\r\n        minute: 'numeric',\r\n        second: 'numeric',\r\n        hour12: false,\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n\r\n    // Format the date to a string in Shanghai timezone, then parse it back to a Date object.\r\n    // This is a common workaround to get a Date object representing a specific timezone.\r\n    const shanghaiDateString = new Intl.DateTimeFormat('en-US', options).format(date);\r\n    return new Date(shanghaiDateString);\r\n}\r\n\r\nexport function getShanghaiTime() {\r\n    // Create a Date object from the ISO string.\r\n    const date = new Date();\r\n\r\n    // Get the date components in Asia/Shanghai timezone\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: 'numeric',\r\n        minute: 'numeric',\r\n        second: 'numeric',\r\n        hour12: false,\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n\r\n    // Format the date to a string in Shanghai timezone, then parse it back to a Date object.\r\n    // This is a common workaround to get a Date object representing a specific timezone.\r\n    const shanghaiDateString = new Intl.DateTimeFormat('en-US', options).format(date);\r\n    return new Date(shanghaiDateString);\r\n}\r\n\r\n/**\r\n * Checks if a given date string is within the last specified number of days (inclusive of today).\r\n * @param {string} dateString - The date string to check (YYYY-MM-DD or ISO format).\r\n * @param {number} days - The number of days to look back (e.g., 3 for today and the past 2 days).\r\n * @returns {boolean} True if the date is within the last 'days', false otherwise.\r\n */\r\nexport function isDateWithinLastDays(dateString, days) {\r\n    if (!dateString || !days) return false;\r\n\r\n    const itemTime = new Date(dateString).getTime();\r\n    if (Number.isNaN(itemTime)) return false;\r\n\r\n    // Use fetchDate (YYYY-MM-DD) as the reference \"today\" in Asia/Shanghai.\r\n    const refDateStr = fetchDate || getISODate();\r\n    const shanghaiStart = new Date(`${refDateStr}T00:00:00+08:00`);\r\n    if (Number.isNaN(shanghaiStart.getTime())) return false;\r\n\r\n    const windowStartMs =\r\n        shanghaiStart.getTime() - (Math.max(days, 1) - 1) * 24 * 60 * 60 * 1000;\r\n    const windowEndMs = shanghaiStart.getTime() + 24 * 60 * 60 * 1000;\r\n\r\n    return itemTime >= windowStartMs && itemTime < windowEndMs;\r\n}\r\n\r\n/**\r\n * Formats an ISO date string to \"YYYY\u5E74M\u6708D\u65E5\" format.\r\n * @param {string} isoDateString - The date string in ISO format (e.g., \"2025-05-30T08:24:52.000Z\").\r\n * @returns {string} Formatted date string (e.g., \"2025\u5E745\u670830\u65E5\").\r\n */\r\nexport function formatDateToChinese(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        timeZone: 'Asia/Shanghai'\r\n    };\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}\r\n\r\n/**\r\n * Formats an ISO date string to \"YYYY\u5E74M\u6708D\u65E5 HH:MM:SS\" format.\r\n * @param {string} isoDateString - The date string in ISO format (e.g., \"2025-05-30T08:24:52.000Z\").\r\n * @returns {string} Formatted date string (e.g., \"2025\u5E745\u670830\u65E5 08:24:52\").\r\n */\r\nexport function formatDateToChineseWithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'Asia/Shanghai' // \u6307\u5B9A\u4E1C8\u65F6\u533A\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}\r\n\r\n/**\r\n * \u5C07\u65E5\u671F\u7269\u4EF6\u683C\u5F0F\u5316\u70BA RSS 2.0 \u898F\u7BC4\u7684\u65E5\u671F\u5B57\u4E32 (RFC 822)\r\n * \u4F8B\u5982: \"Thu, 01 Jan 1970 00:00:00 GMT\"\r\n * @param {Date} date - \u65E5\u671F\u7269\u4EF6\r\n * @returns {string} \u683C\u5F0F\u5316\u5F8C\u7684\u65E5\u671F\u5B57\u4E32\r\n */\r\nexport function formatRssDate(date) {\r\n    if (!date) return new Date().toUTCString();\r\n    \r\n    return date.toUTCString();\r\n  }\r\n\r\n\r\n  export function formatDateToGMT0WithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'GMT'\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}  \r\n\r\n  export function formatDateToGMT8WithTime(isoDateString) {\r\n    if (!isoDateString) return '';\r\n    const date = new Date(isoDateString);\r\n    const options = {\r\n        year: 'numeric',\r\n        month: 'numeric',\r\n        day: 'numeric',\r\n        hour: '2-digit',\r\n        minute: '2-digit',\r\n        second: '2-digit',\r\n        hour12: false, // \u4F7F\u752824\u5C0F\u65F6\u5236\r\n        timeZone: 'Asia/Shanghai'// \u6307\u5B9A\u4E1C8\u65F6\u533A\r\n    };\r\n    // \u4F7F\u7528 'zh-CN' \u8BED\u8A00\u73AF\u5883\u4EE5\u786E\u4FDD\u4E2D\u6587\u683C\u5F0F\r\n    return new Intl.DateTimeFormat('zh-CN', options).format(date);\r\n}  \r\n\r\n/**\r\n * Converts English double quotes (\") to Chinese double quotes (\u201C\u201D).\r\n * @param {string} text - The input string.\r\n * @returns {string} The string with Chinese double quotes.\r\n */\r\nexport function convertEnglishQuotesToChinese(text) {\r\n    const str = String(text);\r\n    return str.replace(/\"/g, '\u201C');\r\n}\r\n\r\nexport function formatMarkdownText(text) {\r\n    const str = String(text);\r\n    return str.replace(/\u201C/g, '\"');\r\n}\r\n\r\n/**\r\n * Generates a random User-Agent string.\r\n * @returns {string} A random User-Agent string.\r\n */\r\nexport function getRandomUserAgent() {\r\n    const userAgents = [\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15\",\r\n        \"Mozilla/5.0 (Macintosh; Intel Mac OS X 13_1) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.1 Safari/605.1.15\",\r\n        \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0\",\r\n        \"Mozilla/5.0 (X11; Linux x86_64; rv:108.0) Gecko/20100101 Firefox/108.0\",\r\n    ];\r\n    return userAgents[Math.floor(Math.random() * userAgents.length)];\r\n}\r\n\r\n/**\r\n * Pauses execution for a specified number of milliseconds.\r\n * @param {number} ms - The number of milliseconds to sleep.\r\n * @returns {Promise<void>} A promise that resolves after the specified time.\r\n */\r\nexport function sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\nexport function replaceImageProxy(proxy, content) {\r\n    const str = String(content);\r\n    return str.replace(/upload.chinaz.com/g, 'pic.chinaz.com').replace(/https:\\/\\/pic.chinaz.com/g, proxy+'https:\\/\\/pic.chinaz.com');\r\n}\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers';\r\n\r\nconst NewsAggregatorDataSource = {\r\n    type: 'news-aggregator',\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.NEWS_AGGREGATOR_LIST_ID;\r\n        const fetchPages = parseInt(env.NEWS_AGGREGATOR_FETCH_PAGES || '1', 10);\r\n        const allNewsItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.warn('NEWS_AGGREGATOR_LIST_ID is not set in environment variables. Skipping news aggregator fetch.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Aggregated News\",\r\n                home_page_url: \"https://example.com/news\",\r\n                description: \"Aggregated news from various sources\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching News Aggregator data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch News Aggregator data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allNewsItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.entries.author ? `${entry.feeds.title} - ${entry.entries.author}` : entry.feeds.title,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for News Aggregator, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching News Aggregator data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Aggregated News\",\r\n            home_page_url: \"https://example.com/news\",\r\n            description: \"Aggregated news from various sources\",\r\n            language: \"zh-cn\",\r\n            items: allNewsItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'Aggregated News',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default NewsAggregatorDataSource;\r\n", "import {\n    getRandomUserAgent,\n    sleep,\n    isDateWithinLastDays,\n    stripHtml,\n    formatDateToChineseWithTime,\n    escapeHtml,\n} from '../helpers.js';\n\n/**\n * \u901A\u7528 Folo \u591A ID \u6293\u53D6\u6E90\uFF1A\n * - \u9002\u5408\u65E0\u6CD5\u521B\u5EFA/\u7EF4\u62A4\u5217\u8868\u7684\u573A\u666F\n * - \u901A\u8FC7 env.FOLO_NEWS_IDS\uFF08\u9017\u53F7/\u7A7A\u683C\u5206\u9694\uFF09\u914D\u7F6E\u591A\u4E2A feedId \u6216 listId\n * - env.FOLO_NEWS_ID_TYPE = \"feed\" | \"list\" | \"auto\"\n *   - auto\uFF1A\u5148\u6309 feedId \u6293\uFF0C\u82E5\u65E0\u6570\u636E\u518D\u6309 listId \u6293\uFF08\u9ED8\u8BA4\uFF09\n */\nconst FoloMultiFeedsDataSource = {\n    type: 'folo-multi-feeds',\n\n    async fetch(env, foloCookie) {\n        const rawIds =\n            env.FOLO_NEWS_IDS ||\n            env.FOLO_FEED_IDS ||\n            env.FOLO_LIST_IDS;\n\n        if (!rawIds) {\n            console.warn('FOLO_NEWS_IDS is not set. Skipping folo-multi-feeds fetch.');\n            return {\n                version: 'https://jsonfeed.org/version/1.1',\n                title: 'Folo Multi Feeds',\n                home_page_url: 'https://app.follow.is',\n                description: 'Aggregated Folo feeds by multiple IDs',\n                language: 'zh-cn',\n                items: [],\n            };\n        }\n\n        const ids = rawIds\n            .split(/[,\\\\s]+/)\n            .map((s) => s.trim())\n            .filter(Boolean);\n        const uniqueIds = [...new Set(ids)];\n\n        const fetchPages = parseInt(env.FOLO_NEWS_FETCH_PAGES || env.FOLO_FETCH_PAGES || '2', 10);\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\n        const idType = String(env.FOLO_NEWS_ID_TYPE || 'auto').toLowerCase(); // feed | list | auto\n\n        const allItems = [];\n\n        const fetchOneKind = async (id, kind) => {\n            let publishedAfter = null;\n            let localItems = [];\n            for (let i = 0; i < fetchPages; i++) {\n                const headers = {\n                    'User-Agent': getRandomUserAgent(),\n                    'Content-Type': 'application/json',\n                    accept: 'application/json',\n                    'accept-language': 'zh-CN,zh;q=0.9',\n                    origin: 'https://app.follow.is',\n                    priority: 'u=1, i',\n                    'sec-fetch-dest': 'empty',\n                    'sec-fetch-mode': 'cors',\n                    'sec-fetch-site': 'same-site',\n                    'x-app-name': 'Folo Web',\n                    'x-app-version': '0.4.9',\n                };\n\n                if (foloCookie) {\n                    headers.Cookie = foloCookie;\n                }\n\n                const body = { view: 1, withContent: true };\n                if (kind === 'list') body.listId = id;\n                else body.feedId = id;\n                if (publishedAfter) body.publishedAfter = publishedAfter;\n\n                console.log(`Fetching Folo ${kind} ${id}, page ${i + 1}...`);\n                const response = await fetch(env.FOLO_DATA_API, {\n                    method: 'POST',\n                    headers,\n                    body: JSON.stringify(body),\n                });\n\n                if (!response.ok) {\n                    console.error(`Failed to fetch Folo ${kind} ${id}, page ${i + 1}: ${response.statusText}`);\n                    break;\n                }\n\n                const data = await response.json();\n                if (!data?.data?.length) break;\n\n                const filteredItems = data.data.filter((entry) =>\n                    isDateWithinLastDays(entry.entries.publishedAt, filterDays),\n                );\n                localItems.push(\n                    ...filteredItems.map((entry) => ({\n                        id: entry.entries.id,\n                        url: entry.entries.url,\n                        title: entry.entries.title,\n                        content_html: entry.entries.content,\n                        date_published: entry.entries.publishedAt,\n                        authors: [{ name: entry.entries.author }],\n                        source: entry.entries.author\n                            ? `${entry.feeds?.title || ''} - ${entry.entries.author}`.trim()\n                            : entry.feeds?.title || 'Folo',\n                    })),\n                );\n\n                publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\n                await sleep(Math.random() * 1500);\n            }\n            return localItems;\n        };\n\n        for (const id of uniqueIds) {\n            try {\n                if (idType === 'list') {\n                    allItems.push(...(await fetchOneKind(id, 'list')));\n                } else if (idType === 'feed') {\n                    allItems.push(...(await fetchOneKind(id, 'feed')));\n                } else {\n                    // auto: \u5148 feed \u518D list\n                    const feedItems = await fetchOneKind(id, 'feed');\n                    if (feedItems.length > 0) {\n                        allItems.push(...feedItems);\n                    } else {\n                        allItems.push(...(await fetchOneKind(id, 'list')));\n                    }\n                }\n            } catch (error) {\n                console.error(`Error fetching Folo id ${id}:`, error);\n            }\n        }\n\n        return {\n            version: 'https://jsonfeed.org/version/1.1',\n            title: 'Folo Multi Feeds',\n            home_page_url: 'https://app.follow.is',\n            description: 'Aggregated Folo feeds by multiple IDs',\n            language: 'zh-cn',\n            items: allItems,\n        };\n    },\n\n    transform(rawData, sourceType) {\n        if (!rawData || !rawData.items) return [];\n        const seen = new Set();\n        return rawData.items\n            .filter((item) => {\n                if (seen.has(item.id)) return false;\n                seen.add(item.id);\n                return true;\n            })\n            .map((item) => ({\n                id: item.id,\n                type: sourceType,\n                url: item.url,\n                title: item.title,\n                description: stripHtml(item.content_html || ''),\n                published_date: item.date_published,\n                authors: item.authors ? item.authors.map((a) => a.name).join(', ') : 'Unknown',\n                source: item.source || 'Folo',\n                details: {\n                    content_html: item.content_html || '',\n                },\n            }));\n    },\n\n    generateHtml(item) {\n        return `\n            <strong>${escapeHtml(item.title)}</strong><br>\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65F6\u95F4: ${formatDateToChineseWithTime(\n                item.published_date,\n            )}</small>\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9'}</div>\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\n        `;\n    },\n};\n\nexport default FoloMultiFeedsDataSource;\n", "// src/dataSources/aibase.js\r\nimport { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml} from '../helpers.js';\r\n\r\nconst NewsDataSource = {\r\n    fetch: async (env, foloCookie) => { // Add sourceType\r\n        const feedId = env.AIBASE_FEED_ID;\r\n        const fetchPages = parseInt(env.AIBASE_FETCH_PAGES || '3', 10);\r\n        const allAibaseItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('AIBASE_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"AI Base Feeds\",\r\n                home_page_url: \"https://www.aibase.com/\",\r\n                description: \"Aggregated AI Base feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching AI Base data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch AI Base data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allAibaseItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `aibase`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for AI Base, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching AI Base data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"AI Base Feeds\",\r\n            home_page_url: \"https://www.aibase.com/\",\r\n            description: \"Aggregated AI Base feeds\",\r\n            language: \"zh-cn\",\r\n            items: allAibaseItems\r\n        };\r\n    },\r\n\r\n    transform: (rawData, sourceType) => { // Add sourceType\r\n        const unifiedNews = [];\r\n        if (rawData && Array.isArray(rawData.items)) {\r\n            rawData.items.forEach((item) => {\r\n                unifiedNews.push({\r\n                    id: item.id,\r\n                    type: sourceType, // Use sourceType here\r\n                    url: item.url,\r\n                    title: item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: item.authors ? item.authors.map(a => a.name).join(', ') : 'Unknown',\r\n                    source: item.source || 'AI Base',\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedNews;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default NewsDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers.js';\r\n\r\nconst JiqizhixinDataSource = {\r\n    fetch: async (env, foloCookie) => {\r\n        const feedId = env.JIQIZHIXIN_FEED_ID;\r\n        const fetchPages = parseInt(env.JIQIZHIXIN_FETCH_PAGES || '3', 10);\r\n        const allJiqizhixinItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('JIQIZHIXIN_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Jiqizhixin.AI Daily Feeds\",\r\n                home_page_url: \"https://www.jiqizhixin.ai\",\r\n                description: \"Aggregated Jiqizhixin.AI Daily feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Jiqizhixin.AI data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Jiqizhixin.AI data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allJiqizhixinItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `\u673A\u5668\u4E4B\u5FC3`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Jiqizhixin.AI, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Jiqizhixin.AI data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Jiqizhixin.AI Daily Feeds\",\r\n            home_page_url: \"https://www.jiqizhixin.ai\",\r\n            description: \"Aggregated Jiqizhixin.AI Daily feeds\",\r\n            language: \"zh-cn\",\r\n            items: allJiqizhixinItems\r\n        };\r\n    },\r\n    transform: (rawData, sourceType) => {\r\n        const unifiedNews = [];\r\n        if (rawData && Array.isArray(rawData.items)) {\r\n            rawData.items.forEach((item) => {\r\n                unifiedNews.push({\r\n                    id: item.id,\r\n                    type: sourceType,\r\n                    url: item.url,\r\n                    title: item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: item.authors ? item.authors.map(a => a.name).join(', ') : 'Unknown',\r\n                    source: item.source || '\u673A\u5668\u4E4B\u5FC3',\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedNews;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default JiqizhixinDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers.js';\r\n\r\nconst QBitDataSource = {\r\n    fetch: async (env, foloCookie) => {\r\n        const feedId = env.QBIT_FEED_ID;\r\n        const fetchPages = parseInt(env.QBIT_FETCH_PAGES || '3', 10);\r\n        const allQBitItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('QBIT_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"QBit.AI Daily Feeds\",\r\n                home_page_url: \"https://www.qbit.ai\",\r\n                description: \"Aggregated QBit.AI Daily feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching QBit.AI data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch QBit.AI data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allQBitItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `\u91CF\u5B50\u4F4D`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for QBit.AI, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching QBit.AI data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"QBit.AI Daily Feeds\",\r\n            home_page_url: \"https://www.qbit.ai\",\r\n            description: \"Aggregated QBit.AI Daily feeds\",\r\n            language: \"zh-cn\",\r\n            items: allQBitItems\r\n        };\r\n    },\r\n    transform: (rawData, sourceType) => {\r\n        const unifiedNews = [];\r\n        if (rawData && Array.isArray(rawData.items)) {\r\n            rawData.items.forEach((item) => {\r\n                unifiedNews.push({\r\n                    id: item.id,\r\n                    type: sourceType,\r\n                    url: item.url,\r\n                    title: item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: item.authors ? item.authors.map(a => a.name).join(', ') : 'Unknown',\r\n                    source: item.source || '\u91CF\u5B50\u4F4D',\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedNews;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default QBitDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers.js';\r\n\r\nconst XinZhiYuanDataSource = {\r\n    fetch: async (env, foloCookie) => {\r\n        const feedId = env.XINZHIYUAN_FEED_ID;\r\n        const fetchPages = parseInt(env.XINZHIYUAN_FETCH_PAGES || '3', 10);\r\n        const allXinZhiYuanItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('XINZHIYUAN_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"XinZhiYuan.AI Daily Feeds\",\r\n                home_page_url: \"https://www.xinzhiyuan.ai\",\r\n                description: \"Aggregated XinZhiYuan.AI Daily feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching XinZhiYuan.AI data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch XinZhiYuan.AI data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allXinZhiYuanItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `\u65B0\u667A\u5143`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for XinZhiYuan.AI, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching XinZhiYuan.AI data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"XinZhiYuan.AI Daily Feeds\",\r\n            home_page_url: \"https://www.xinzhiyuan.ai\",\r\n            description: \"Aggregated XinZhiYuan.AI Daily feeds\",\r\n            language: \"zh-cn\",\r\n            items: allXinZhiYuanItems\r\n        };\r\n    },\r\n    transform: (rawData, sourceType) => {\r\n        const unifiedNews = [];\r\n        if (rawData && Array.isArray(rawData.items)) {\r\n            rawData.items.forEach((item) => {\r\n                unifiedNews.push({\r\n                    id: item.id,\r\n                    type: sourceType,\r\n                    url: item.url,\r\n                    title: item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: item.authors ? item.authors.map(a => a.name).join(', ') : 'Unknown',\r\n                    source: item.source || '\u65B0\u667A\u5143',\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedNews;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default XinZhiYuanDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers.js';\r\n\r\nconst XiaohuDataSource = {\r\n    fetch: async (env, foloCookie) => {\r\n        const feedId = env.XIAOHU_FEED_ID;\r\n        const fetchPages = parseInt(env.XIAOHU_FETCH_PAGES || '3', 10);\r\n        const allXiaohuItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('XIAOHU_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Xiaohu.AI Daily Feeds\",\r\n                home_page_url: \"https://www.xiaohu.ai\",\r\n                description: \"Aggregated Xiaohu.AI Daily feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Xiaohu.AI data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Xiaohu.AI data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allXiaohuItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `xiaohu`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Xiaohu.AI, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Xiaohu.AI data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Xiaohu.AI Daily Feeds\",\r\n            home_page_url: \"https://www.xiaohu.ai\",\r\n            description: \"Aggregated Xiaohu.AI Daily feeds\",\r\n            language: \"zh-cn\",\r\n            items: allXiaohuItems\r\n        };\r\n    },\r\n    transform: (rawData, sourceType) => {\r\n        const unifiedNews = [];\r\n        if (rawData && Array.isArray(rawData.items)) {\r\n            rawData.items.forEach((item) => {\r\n                unifiedNews.push({\r\n                    id: item.id,\r\n                    type: sourceType,\r\n                    url: item.url,\r\n                    title: item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: item.authors ? item.authors.map(a => a.name).join(', ') : 'Unknown',\r\n                    source: item.source || 'Xiaohu.AI',\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedNews;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}</div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u9605\u8BFB\u66F4\u591A</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default XiaohuDataSource;\r\n", "// src/chatapi.js\n\nconst GEMINI_API_VERSIONS = [\"v1beta\", \"v1\", \"\"];\n\nfunction normalizeBaseUrl(url) {\n    return String(url || \"\").replace(/\\/+$/, \"\");\n}\n\nfunction getGeminiApiKey(env) {\n    return env.GEMINI_API_KEY || env.ANTHROPIC_API_KEY || env.OPENAI_API_KEY;\n}\n\nfunction getGeminiModelName(env) {\n    return env.DEFAULT_GEMINI_MODEL || env.GEMINI_MODEL;\n}\n\nfunction getGeminiApiVersionCandidates(env, baseUrl) {\n    const configured = String(env.GEMINI_API_VERSION ?? \"auto\").trim().toLowerCase();\n    const base = normalizeBaseUrl(baseUrl);\n    const baseHasVersion = /\\/v1beta$|\\/v1$/i.test(base);\n    if (baseHasVersion) {\n        return [\"\"];\n    }\n\n    if (configured === \"\" || configured === \"auto\" || configured === \"default\") {\n        return GEMINI_API_VERSIONS;\n    }\n    if (configured === \"v1beta\" || configured === \"v1\") {\n        return [configured];\n    }\n    if (\n        configured === \"noversion\" ||\n        configured === \"no-version\" ||\n        configured === \"no_version\" ||\n        configured === \"none\" ||\n        configured === \"off\" ||\n        configured === \"0\"\n    ) {\n        return [\"\"];\n    }\n\n    return GEMINI_API_VERSIONS;\n}\n\nfunction isGeminiDebug(env) {\n    const value = String(env.GEMINI_DEBUG ?? \"\").trim().toLowerCase();\n    return value === \"1\" || value === \"true\" || value === \"yes\" || value === \"on\";\n}\n\nfunction redactGeminiUrl(url) {\n    return String(url || \"\").replace(/([?&]key=)[^&]+/gi, \"$1***\");\n}\n\nfunction logGeminiDebug(env, message, meta) {\n    if (!isGeminiDebug(env)) return;\n    if (meta) {\n        console.log(message, meta);\n        return;\n    }\n    console.log(message);\n}\n\nfunction isInvalidArgumentError(status, message) {\n    if (status !== 400) return false;\n    const text = String(message || \"\").toLowerCase();\n    return text.includes(\"invalid argument\") || text.includes(\"invalid_argument\");\n}\n\nfunction formatGeminiVariant(variant) {\n    return `system=${variant.useSystemInstruction ? \"on\" : \"off\"}, merge=${variant.mergeSystem ? \"on\" : \"off\"}, role=${variant.useRole ? \"on\" : \"off\"}, gen=${variant.includeGenerationConfig ? \"on\" : \"off\"}`;\n}\n\nfunction getGeminiPayloadVariants(hasSystem, allowGenerationConfig) {\n    const variants = [];\n    const genOptions = allowGenerationConfig ? [true, false] : [false];\n\n    if (hasSystem) {\n        for (const includeGenerationConfig of genOptions) {\n            variants.push({ useSystemInstruction: true, mergeSystem: false, useRole: true, includeGenerationConfig });\n            variants.push({ useSystemInstruction: true, mergeSystem: false, useRole: false, includeGenerationConfig });\n            variants.push({ useSystemInstruction: false, mergeSystem: true, useRole: true, includeGenerationConfig });\n            variants.push({ useSystemInstruction: false, mergeSystem: true, useRole: false, includeGenerationConfig });\n        }\n    } else {\n        for (const includeGenerationConfig of genOptions) {\n            variants.push({ useSystemInstruction: false, mergeSystem: false, useRole: true, includeGenerationConfig });\n            variants.push({ useSystemInstruction: false, mergeSystem: false, useRole: false, includeGenerationConfig });\n        }\n    }\n\n    return variants;\n}\n\nfunction buildGeminiPayload(promptText, systemPromptText, variant) {\n    const hasSystem = systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '';\n    const useSystemInstruction = variant.useSystemInstruction && hasSystem;\n    const shouldMergeSystem = variant.mergeSystem && hasSystem && !useSystemInstruction;\n    const effectivePromptText = shouldMergeSystem ? `${systemPromptText}\\n\\n${promptText}` : promptText;\n    const parts = [{ text: effectivePromptText }];\n    const content = variant.useRole ? { role: \"user\", parts } : { parts };\n    const payload = { contents: [content] };\n\n    if (useSystemInstruction) {\n        payload.systemInstruction = { parts: [{ text: systemPromptText }] };\n    }\n    if (variant.includeGenerationConfig) {\n        payload.generationConfig = {\n            temperature: 1,\n            topP: 0.95\n        };\n    }\n\n    return { payload };\n}\n\nfunction getGeminiStreamMode(env) {\n    const mode = String(env.GEMINI_STREAM_MODE ?? \"auto\").trim().toLowerCase();\n    if (\n        mode === \"off\" ||\n        mode === \"false\" ||\n        mode === \"0\" ||\n        mode === \"no\" ||\n        mode === \"none\" ||\n        mode === \"disable\" ||\n        mode === \"disabled\" ||\n        mode === \"nostream\" ||\n        mode === \"nonstream\" ||\n        mode === \"non-stream\" ||\n        mode === \"non_stream\"\n    ) {\n        return \"off\";\n    }\n    if (mode === \"force\" || mode === \"on\" || mode === \"true\" || mode === \"1\") {\n        return \"force\";\n    }\n    return \"auto\";\n}\n\nfunction buildGeminiHeaders(apiKey, useHeaderAuth) {\n    const headers = { 'Content-Type': 'application/json' };\n    if (useHeaderAuth && apiKey) {\n        headers['x-goog-api-key'] = apiKey;\n        headers['Authorization'] = `Bearer ${apiKey}`;\n    }\n    return headers;\n}\n\nfunction buildGeminiUrl(baseUrl, apiVersion, modelName, method, apiKey, useQueryKey, extraQuery = \"\") {\n    const base = normalizeBaseUrl(baseUrl);\n    const versionSegment = apiVersion ? `/${apiVersion}` : \"\";\n    const path = `${base}${versionSegment}/models/${modelName}:${method}`;\n    const queryParts = [];\n    if (useQueryKey && apiKey) queryParts.push(`key=${encodeURIComponent(apiKey)}`);\n    if (extraQuery) queryParts.push(extraQuery.replace(/^[?&]/, \"\"));\n    return queryParts.length ? `${path}?${queryParts.join(\"&\")}` : path;\n}\n\nfunction shouldFallbackToMergedSystem(systemPromptText, errorBodyText) {\n    if (!systemPromptText || typeof systemPromptText !== 'string' || systemPromptText.trim() === '') return false;\n    const t = String(errorBodyText || \"\").toLowerCase();\n    return t.includes(\"systeminstruction\") || t.includes(\"system_instruction\") || t.includes(\"system instruction\");\n}\n\nfunction extractGeminiTextFromResponse(data) {\n    if (data?.promptFeedback?.blockReason) {\n        const blockReason = data.promptFeedback.blockReason;\n        const safetyRatings = data.promptFeedback.safetyRatings ? JSON.stringify(data.promptFeedback.safetyRatings) : 'N/A';\n        throw new Error(`Gemini Chat prompt blocked: ${blockReason}. Safety ratings: ${safetyRatings}`);\n    }\n\n    if (data?.candidates?.length > 0) {\n        const candidate = data.candidates[0];\n\n        if (candidate.finishReason && candidate.finishReason !== \"STOP\") {\n            const reason = candidate.finishReason;\n            const safetyRatings = candidate.safetyRatings ? JSON.stringify(candidate.safetyRatings) : 'N/A';\n            if (reason === \"SAFETY\") {\n                throw new Error(`Gemini Chat content generation blocked due to safety (${reason}). Safety ratings: ${safetyRatings}`);\n            }\n            throw new Error(`Gemini Chat content generation finished due to: ${reason}. Safety ratings: ${safetyRatings}`);\n        }\n\n        const text = candidate?.content?.parts?.[0]?.text;\n        if (text && typeof text === 'string') {\n            return text;\n        }\n        throw new Error(\"Gemini Chat API returned a candidate with 'STOP' finishReason but no text content.\");\n    }\n\n    throw new Error(\"Gemini Chat API returned an empty or malformed response with no candidates.\");\n}\n\n/**\n * Calls the Gemini Chat API (non-streaming).\n *\n * @param {object} env - Environment object containing GEMINI_API_URL.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {Promise<string>} The generated text content.\n * @throws {Error} If GEMINI_API_URL is not set, or if API call fails or returns blocked/empty content.\n */\nasync function callGeminiChatAPI(env, promptText, systemPromptText = null) {\n    if (!env.GEMINI_API_URL) {\n        throw new Error(\"GEMINI_API_URL environment variable is not set.\");\n    }\n    const apiKey = getGeminiApiKey(env);\n    if (!apiKey) {\n        throw new Error(\"Gemini API key is not set (set GEMINI_API_KEY, or reuse ANTHROPIC_API_KEY/OPENAI_API_KEY).\");\n    }\n    const modelName = getGeminiModelName(env);\n    if (!modelName) {\n        throw new Error(\"DEFAULT_GEMINI_MODEL environment variable is not set.\");\n    }\n\n    const baseUrl = normalizeBaseUrl(env.GEMINI_API_URL);\n    const authModes = [\n        { useQueryKey: true, useHeaderAuth: false },\n        { useQueryKey: false, useHeaderAuth: true },\n    ];\n\n    const hasSystem = systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '';\n    const payloadVariants = getGeminiPayloadVariants(hasSystem, false);\n    let lastCompatibilityError = null;\n\n    try {\n        versionLoop:\n        for (const apiVersion of getGeminiApiVersionCandidates(env, baseUrl)) {\n            authLoop:\n            for (const auth of authModes) {\n                for (const variant of payloadVariants) {\n                    const { payload } = buildGeminiPayload(promptText, systemPromptText, variant);\n                    const url = buildGeminiUrl(baseUrl, apiVersion, modelName, \"generateContent\", apiKey, auth.useQueryKey);\n                    logGeminiDebug(env, \"Gemini non-stream request\", { url: redactGeminiUrl(url), variant: formatGeminiVariant(variant) });\n\n                    const response = await fetchWithTimeout(url, {\n                        method: 'POST',\n                        headers: buildGeminiHeaders(apiKey, auth.useHeaderAuth),\n                        body: JSON.stringify(payload)\n                    }, 180000);\n\n                    const contentType = response.headers.get('content-type') || '';\n                    if (!response.ok) {\n                        const errorBodyText = await response.text();\n                        let errorData;\n                        try {\n                            errorData = JSON.parse(errorBodyText);\n                        } catch (e) {\n                            errorData = errorBodyText;\n                        }\n                        const message = typeof errorData === 'object' && errorData.error?.message\n                            ? errorData.error.message\n                            : (typeof errorData === 'string' ? errorData : 'Unknown Gemini Chat API error');\n\n                        logGeminiDebug(env, \"Gemini non-stream error response\", {\n                            url: redactGeminiUrl(url),\n                            status: response.status,\n                            contentType,\n                            variant: formatGeminiVariant(variant),\n                            bodyPreview: String(errorBodyText || \"\").slice(0, 200)\n                        });\n\n                        lastCompatibilityError = new Error(`Gemini Chat API error (${response.status}): ${message}`);\n\n                        if (response.status === 404 || response.status === 405) {\n                            continue versionLoop; // try next API version\n                        }\n                        if ((response.status === 401 || response.status === 403) && auth.useQueryKey) {\n                            continue authLoop; // try header auth\n                        }\n                        if (isInvalidArgumentError(response.status, message)) {\n                            continue; // try next payload variant\n                        }\n                        continue; // try next payload variant\n                    }\n\n                    if (!contentType.includes('application/json')) {\n                        const bodyText = await response.text();\n                        logGeminiDebug(env, \"Gemini non-stream non-JSON response\", {\n                            url: redactGeminiUrl(url),\n                            status: response.status,\n                            contentType,\n                            variant: formatGeminiVariant(variant),\n                            bodyPreview: String(bodyText || \"\").slice(0, 200)\n                        });\n                        lastCompatibilityError = new Error(`Gemini Chat API error (${response.status}): Non-JSON response (${contentType || 'unknown'})`);\n                        continue; // try next payload variant\n                    }\n\n                    const data = await response.json();\n                    if (data?.error?.message) {\n                        const message = data.error.message;\n                        lastCompatibilityError = new Error(`Gemini Chat API error (${response.status}): ${message}`);\n                        if (isInvalidArgumentError(response.status, message)) {\n                            continue; // try next payload variant\n                        }\n                        continue;\n                    }\n                    return extractGeminiTextFromResponse(data);\n                }\n            }\n        }\n\n        if (lastCompatibilityError) {\n            throw lastCompatibilityError;\n        }\n        throw new Error(\"Gemini Chat API error: failed to reach a compatible endpoint (check GEMINI_API_URL / proxy compatibility).\");\n    } catch (error) {\n        // Log the full error object if it's not one we constructed, or just re-throw\n        if (!(error instanceof Error && error.message.startsWith(\"Gemini Chat\"))) {\n            console.error(\"Error calling Gemini Chat API (Non-streaming):\", error);\n        }\n        throw error;\n    }\n}\n\n\n/**\n * Calls the Gemini Chat API with streaming.\n *\n * @param {object} env - Environment object containing GEMINI_API_URL.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\n * @throws {Error} If GEMINI_API_URL is not set, or if API call fails or returns blocked/empty content.\n */\nasync function* callGeminiChatAPIStream(env, promptText, systemPromptText = null) {\n    if (!env.GEMINI_API_URL) {\n        throw new Error(\"GEMINI_API_URL environment variable is not set.\");\n    }\n    const apiKey = getGeminiApiKey(env);\n    if (!apiKey) {\n        throw new Error(\"Gemini API key is not set (set GEMINI_API_KEY, or reuse ANTHROPIC_API_KEY/OPENAI_API_KEY).\");\n    }\n    const modelName = getGeminiModelName(env);\n    if (!modelName) {\n        throw new Error(\"DEFAULT_GEMINI_MODEL environment variable is not set.\");\n    }\n\n    const baseUrl = normalizeBaseUrl(env.GEMINI_API_URL);\n    const authModes = [\n        { useQueryKey: true, useHeaderAuth: false },\n        { useQueryKey: false, useHeaderAuth: true },\n    ];\n    const streamQueryVariants = [\"alt=sse\", \"\"];\n    const streamMode = getGeminiStreamMode(env);\n\n    const hasSystem = systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '';\n    const payloadVariants = getGeminiPayloadVariants(hasSystem, true);\n\n    let response = null;\n    let lastCompatibilityError = null;\n    let hasYieldedContent = false;\n    try {\n        requestLoop:\n        for (const apiVersion of getGeminiApiVersionCandidates(env, baseUrl)) {\n            authLoop:\n            for (const auth of authModes) {\n                for (const streamQuery of streamQueryVariants) {\n                    for (const variant of payloadVariants) {\n                        const { payload } = buildGeminiPayload(promptText, systemPromptText, variant);\n                        const url = buildGeminiUrl(baseUrl, apiVersion, modelName, \"streamGenerateContent\", apiKey, auth.useQueryKey, streamQuery);\n                        logGeminiDebug(env, \"Gemini stream request\", { url: redactGeminiUrl(url), variant: formatGeminiVariant(variant) });\n\n                        response = await fetchWithTimeout(url, {\n                            method: 'POST',\n                            headers: buildGeminiHeaders(apiKey, auth.useHeaderAuth),\n                            body: JSON.stringify(payload)\n                        }, 180000);\n\n                        const contentType = response.headers.get('content-type') || '';\n                        if (!response.ok) {\n                            const errorBodyText = await response.text();\n                            let errorData;\n                            try {\n                                errorData = JSON.parse(errorBodyText);\n                            } catch (e) {\n                                errorData = errorBodyText;\n                            }\n                            const message = typeof errorData === 'object' && errorData.error?.message\n                                ? errorData.error.message\n                                : (typeof errorData === 'string' ? errorData : 'Unknown Gemini Chat API error');\n\n                            logGeminiDebug(env, \"Gemini stream error response\", {\n                                url: redactGeminiUrl(url),\n                                status: response.status,\n                                contentType,\n                                variant: formatGeminiVariant(variant),\n                                bodyPreview: String(errorBodyText || \"\").slice(0, 200)\n                            });\n\n                            lastCompatibilityError = new Error(`Gemini Chat API error (${response.status}): ${message}`);\n\n                            if (response.status === 404 || response.status === 405) {\n                                continue requestLoop; // try next API version\n                            }\n                            if ((response.status === 401 || response.status === 403) && auth.useQueryKey) {\n                                continue authLoop; // try header auth\n                            }\n                            if (isInvalidArgumentError(response.status, message)) {\n                                continue; // try next payload variant\n                            }\n                            continue; // try next payload variant\n                        }\n\n                        if (contentType && !contentType.includes('application/json') && !contentType.includes('text/event-stream')) {\n                            const bodyText = await response.text();\n                            logGeminiDebug(env, \"Gemini stream non-JSON response\", {\n                                url: redactGeminiUrl(url),\n                                status: response.status,\n                                contentType,\n                                variant: formatGeminiVariant(variant),\n                                bodyPreview: String(bodyText || \"\").slice(0, 200)\n                            });\n                            lastCompatibilityError = new Error(`Gemini Chat API error (${response.status}): Non-JSON response (${contentType || 'unknown'})`);\n                            response = null;\n                            continue; // try next payload variant\n                        }\n\n                        break requestLoop; // got an OK response\n                    }\n                }\n            }\n        }\n\n        // If streaming endpoint isn't supported by the proxy, gracefully fall back to non-streaming (unless forced).\n        if (!response || !response.ok) {\n            if (streamMode === \"force\" && lastCompatibilityError) {\n                throw lastCompatibilityError;\n            }\n            const nonStreamText = await callGeminiChatAPI(env, promptText, systemPromptText);\n            yield nonStreamText;\n            return;\n        }\n\n        const contentType = response.headers.get('content-type') || '';\n        if (contentType.includes('application/json')) {\n            const data = await response.json();\n            yield extractGeminiTextFromResponse(data);\n            return;\n        }\n\n        if (!response.body) {\n            throw new Error(\"Response body is null, cannot stream.\");\n        }\n\n        const reader = response.body.getReader();\n        const decoder = new TextDecoder();\n        let buffer = \"\";\n        let overallFinishReason = null; // To track the final finish reason if available\n        let finalSafetyRatings = null;\n\n        const processJsonChunk = (jsonString) => {\n            if (jsonString.trim() === \"\") return null;\n            try {\n                return JSON.parse(jsonString);\n            } catch (e) {\n                console.warn(\"Failed to parse JSON chunk from stream:\", jsonString, e.message);\n                return null; // Or throw, depending on how strictly you want to handle malformed JSON\n            }\n        };\n\n        const handleChunkLogic = (chunk) => {\n            if (!chunk) return false; // Not a valid chunk to process\n\n            // 1. Check for prompt-level blocking (might appear in first chunk)\n            if (chunk.promptFeedback && chunk.promptFeedback.blockReason) {\n                const blockReason = chunk.promptFeedback.blockReason;\n                const safetyRatings = chunk.promptFeedback.safetyRatings ? JSON.stringify(chunk.promptFeedback.safetyRatings) : 'N/A';\n                console.error(`Gemini Chat prompt blocked during stream: ${blockReason}. Safety ratings: ${safetyRatings}`, JSON.stringify(chunk, null, 2));\n                throw new Error(`Gemini Chat prompt blocked: ${blockReason}. Safety ratings: ${safetyRatings}`);\n            }\n\n            // 2. Check candidates\n            if (chunk.candidates && chunk.candidates.length > 0) {\n                const candidate = chunk.candidates[0];\n                if (candidate.finishReason) {\n                    overallFinishReason = candidate.finishReason; // Store the latest finish reason\n                    finalSafetyRatings = candidate.safetyRatings;\n\n                    if (candidate.finishReason !== \"STOP\") {\n                        const reason = candidate.finishReason;\n                        const sr = candidate.safetyRatings ? JSON.stringify(candidate.safetyRatings) : 'N/A';\n                        console.error(`Gemini Chat stream candidate finished with reason: ${reason}. Safety ratings: ${sr}`, JSON.stringify(chunk, null, 2));\n                        if (reason === \"SAFETY\") {\n                            throw new Error(`Gemini Chat content generation blocked due to safety (${reason}). Safety ratings: ${sr}`);\n                        }\n                        throw new Error(`Gemini Chat stream finished due to: ${reason}. Safety ratings: ${sr}`);\n                    }\n                }\n\n                if (candidate.content && candidate.content.parts && candidate.content.parts.length > 0) {\n                    const textPart = candidate.content.parts[0].text;\n                    if (textPart && typeof textPart === 'string') {\n                        hasYieldedContent = true;\n                        return textPart; // This is the text to yield\n                    }\n                }\n            } else if (chunk.error) { // Check for explicit error object in stream\n                console.error(\"Gemini Chat API Stream Error Chunk:\", JSON.stringify(chunk.error, null, 2));\n                throw new Error(`Gemini Chat API stream error: ${chunk.error.message || 'Unknown error in stream'}`);\n            }\n            return null; // No text to yield from this chunk\n        };\n\n\n        while (true) {\n            const { done, value } = await reader.read();\n            if (done) {\n                break;\n            }\n\n            buffer += decoder.decode(value, { stream: true });\n            \n            let eventBoundary;\n            while ((eventBoundary = buffer.indexOf('\\n\\n')) !== -1 || (eventBoundary = buffer.indexOf('\\n')) !== -1) {\n                const separatorLength = (buffer.indexOf('\\n\\n') === eventBoundary) ? 2 : 1;\n                let message = buffer.substring(0, eventBoundary);\n                buffer = buffer.substring(eventBoundary + separatorLength);\n\n                if (message.startsWith(\"data: \")) {\n                    message = message.substring(5).trim();\n                } else {\n                    message = message.trim();\n                }\n\n                if (message === \"\" || message === \"[DONE]\") {\n                    continue;\n                }\n                \n                const parsedChunk = processJsonChunk(message);\n                if (parsedChunk) {\n                    const textToYield = handleChunkLogic(parsedChunk);\n                    if (textToYield !== null) {\n                        yield textToYield;\n                    }\n                }\n            }\n        }\n\n        // Process any remaining data in the buffer (if not ending with newline(s))\n        if (buffer.trim()) {\n            let finalMessage = buffer.trim();\n             if (finalMessage.startsWith(\"data: \")) {\n                finalMessage = finalMessage.substring(5).trim();\n            }\n            if (finalMessage !== \"\" && finalMessage !== \"[DONE]\") {\n                const parsedChunk = processJsonChunk(finalMessage);\n                 if (parsedChunk) {\n                    const textToYield = handleChunkLogic(parsedChunk);\n                    if (textToYield !== null) {\n                        yield textToYield;\n                    }\n                }\n            }\n        }\n\n        // After the stream has finished, check if any content was yielded and the overall outcome\n        if (!hasYieldedContent) {\n            if (overallFinishReason && overallFinishReason !== \"STOP\") {\n                const sr = finalSafetyRatings ? JSON.stringify(finalSafetyRatings) : 'N/A';\n                console.warn(`Gemini Chat stream ended with reason '${overallFinishReason}' and no content was yielded. Safety: ${sr}`);\n                throw new Error(`Gemini Chat stream completed due to ${overallFinishReason} without yielding content. Safety ratings: ${sr}`);\n            } else if (overallFinishReason === \"STOP\") {\n                console.warn(\"Gemini Chat stream finished with 'STOP' but no content was yielded.\", JSON.stringify({overallFinishReason, finalSafetyRatings}, null, 2));\n                throw new Error(\"Gemini Chat stream completed with 'STOP' but yielded no content.\");\n            } else if (!overallFinishReason) {\n                console.warn(\"Gemini Chat stream ended without yielding any content or a clear finish reason.\");\n                throw new Error(\"Gemini Chat stream completed without yielding any content.\");\n            }\n        }\n\n    } catch (error) {\n        // Auto fallback: if stream isn't compatible, try non-streaming once (only if we haven't yielded partial content).\n        if (streamMode === \"auto\" && !hasYieldedContent) {\n            try {\n                const nonStreamText = await callGeminiChatAPI(env, promptText, systemPromptText);\n                yield nonStreamText;\n                return;\n            } catch (fallbackError) {\n                console.error(\"Gemini stream failed; non-stream fallback also failed:\", fallbackError);\n            }\n        }\n\n        if (!(error instanceof Error && error.message.startsWith(\"Gemini Chat\"))) {\n            console.error(\"Error calling or streaming from Gemini Chat API:\", error);\n        }\n        throw error;\n    }\n}\n\n/**\n * Calls the OpenAI Chat API (non-streaming).\n *\n * @param {object} env - Environment object containing OPENAI_API_URL and OPENAI_API_KEY.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {Promise<string>} The generated text content.\n * @throws {Error} If OPENAI_API_URL or OPENAI_API_KEY is not set, or if API call fails.\n */\nasync function callOpenAIChatAPI(env, promptText, systemPromptText = null) {\n    if (!env.OPENAI_API_URL) {\n        throw new Error(\"OPENAI_API_URL environment variable is not set.\");\n    }\n    if (!env.OPENAI_API_KEY) {\n        throw new Error(\"OPENAI_API_KEY environment variable is not set for OpenAI models.\");\n    }\n    const url = `${env.OPENAI_API_URL}/v1/chat/completions`;\n    \n    const messages = [];\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\n        messages.push({ role: \"system\", content: systemPromptText });\n        console.log(\"System instruction included in OpenAI Chat API call.\");\n    }\n    messages.push({ role: \"user\", content: promptText });\n\n    const modelName = env.DEFAULT_OPEN_MODEL;\n    const payload = {\n        model: modelName,\n        messages: messages,\n        temperature: 1,\n        max_tokens: 2048,\n        top_p: 1,\n        frequency_penalty: 0,\n        presence_penalty: 0,\n    };\n\n    try {\n        const response = await fetch(url, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${env.OPENAI_API_KEY}`\n            },\n            body: JSON.stringify(payload)\n        });\n\n        if (!response.ok) {\n            const errorBodyText = await response.text();\n            let errorData;\n            try {\n                errorData = JSON.parse(errorBodyText);\n            } catch (e) {\n                errorData = errorBodyText;\n            }\n            console.error(\"OpenAI Chat API Error Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\n            const message = typeof errorData === 'object' && errorData.error?.message\n                ? errorData.error.message\n                : (typeof errorData === 'string' ? errorData : 'Unknown OpenAI Chat API error');\n            throw new Error(`OpenAI Chat API error (${response.status}): ${message}`);\n        }\n\n        const data = await response.json();\n\n        if (data.choices && data.choices.length > 0 && data.choices[0].message && data.choices[0].message.content) {\n            return data.choices[0].message.content;\n        } else {\n            console.warn(\"OpenAI Chat API response format unexpected: No choices or content found.\", JSON.stringify(data, null, 2));\n            throw new Error(\"OpenAI Chat API returned an empty or malformed response.\");\n        }\n    } catch (error) {\n        if (!(error instanceof Error && error.message.startsWith(\"OpenAI Chat\"))) {\n            console.error(\"Error calling OpenAI Chat API (Non-streaming):\", error);\n        }\n        throw error;\n    }\n}\n\n/**\n * Calls the OpenAI Chat API with streaming.\n *\n * @param {object} env - Environment object containing OPENAI_API_URL and OPENAI_API_KEY.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\n * @throws {Error} If OPENAI_API_URL or OPENAI_API_KEY is not set, or if API call fails.\n */\nasync function* callOpenAIChatAPIStream(env, promptText, systemPromptText = null) {\n    if (!env.OPENAI_API_URL) {\n        throw new Error(\"OPENAI_API_URL environment variable is not set.\");\n    }\n    if (!env.OPENAI_API_KEY) {\n        throw new Error(\"OPENAI_API_KEY environment variable is not set for OpenAI models.\");\n    }\n    const url = `${env.OPENAI_API_URL}/v1/chat/completions`;\n\n    const messages = [];\n    if (systemPromptText && typeof systemPromptText === 'string' && systemPromptText.trim() !== '') {\n        messages.push({ role: \"system\", content: systemPromptText });\n        console.log(\"System instruction included in OpenAI Chat API call.\");\n    }\n    messages.push({ role: \"user\", content: promptText });\n\n    const modelName = env.DEFAULT_OPEN_MODEL;\n    const payload = {\n        model: modelName,\n        messages: messages,\n        temperature: 1,\n        max_tokens: 2048,\n        top_p: 1,\n        frequency_penalty: 0,\n        presence_penalty: 0,\n        stream: true,\n    };\n\n    let response;\n    try {\n        response = await fetch(url, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${env.OPENAI_API_KEY}`\n            },\n            body: JSON.stringify(payload)\n        });\n\n        if (!response.ok) {\n            const errorBodyText = await response.text();\n            let errorData;\n            try {\n                errorData = JSON.parse(errorBodyText);\n            } catch (e) {\n                errorData = errorBodyText;\n            }\n            console.error(\"OpenAI Chat API Error (Stream Initial) Response Body:\", typeof errorData === 'object' ? JSON.stringify(errorData, null, 2) : errorData);\n            const message = typeof errorData === 'object' && errorData.error?.message\n                ? errorData.error.message\n                : (typeof errorData === 'string' ? errorData : 'Unknown OpenAI Chat API error');\n            throw new Error(`OpenAI Chat API error (${response.status}): ${message}`);\n        }\n\n        if (!response.body) {\n            throw new Error(\"Response body is null, cannot stream.\");\n        }\n\n        const reader = response.body.getReader();\n        const decoder = new TextDecoder();\n        let buffer = \"\";\n        let hasYieldedContent = false;\n\n        while (true) {\n            const { done, value } = await reader.read();\n            if (done) {\n                break;\n            }\n\n            buffer += decoder.decode(value, { stream: true });\n            \n            // OpenAI streaming uses data: {JSON}\\n\\n\n            let eventBoundary;\n            while ((eventBoundary = buffer.indexOf('\\n\\n')) !== -1) {\n                let message = buffer.substring(0, eventBoundary);\n                buffer = buffer.substring(eventBoundary + 2); // +2 for '\\n\\n'\n\n                if (message.startsWith(\"data: \")) {\n                    message = message.substring(5).trim();\n                } else {\n                    message = message.trim();\n                }\n\n                if (message === \"\" || message === \"[DONE]\") {\n                    continue;\n                }\n                \n                try {\n                    const parsedChunk = JSON.parse(message);\n                    if (parsedChunk.choices && parsedChunk.choices.length > 0) {\n                        const delta = parsedChunk.choices[0].delta;\n                        if (delta && delta.content) {\n                            hasYieldedContent = true;\n                            yield delta.content;\n                        }\n                    } else if (parsedChunk.error) {\n                        console.error(\"OpenAI Chat API Stream Error Chunk:\", JSON.stringify(parsedChunk.error, null, 2));\n                        throw new Error(`OpenAI Chat API stream error: ${parsedChunk.error.message || 'Unknown error in stream'}`);\n                    }\n                } catch (e) {\n                    console.warn(\"Failed to parse JSON chunk from OpenAI stream:\", message, e.message);\n                    // Continue processing, might be an incomplete chunk\n                }\n            }\n        }\n\n        // Process any remaining data in the buffer\n        if (buffer.trim()) {\n            let finalMessage = buffer.trim();\n            if (finalMessage.startsWith(\"data: \")) {\n                finalMessage = finalMessage.substring(5).trim();\n            }\n            if (finalMessage !== \"\" && finalMessage !== \"[DONE]\") {\n                try {\n                    const parsedChunk = JSON.parse(finalMessage);\n                    if (parsedChunk.choices && parsedChunk.choices.length > 0) {\n                        const delta = parsedChunk.choices[0].delta;\n                        if (delta && delta.content) {\n                            hasYieldedContent = true;\n                            yield delta.content;\n                        }\n                    } else if (parsedChunk.error) {\n                        console.error(\"OpenAI Chat API Stream Error Chunk:\", JSON.stringify(parsedChunk.error, null, 2));\n                        throw new Error(`OpenAI Chat API stream error: ${parsedChunk.error.message || 'Unknown error in stream'}`);\n                    }\n                } catch (e) {\n                    console.warn(\"Failed to parse final JSON chunk from OpenAI stream:\", finalMessage, e.message);\n                }\n            }\n        }\n\n        if (!hasYieldedContent) {\n            console.warn(\"OpenAI Chat stream finished but no content was yielded.\");\n            throw new Error(\"OpenAI Chat stream completed but yielded no content.\");\n        }\n\n    } catch (error) {\n        if (!(error instanceof Error && error.message.startsWith(\"OpenAI Chat\"))) {\n            console.error(\"Error calling or streaming from OpenAI Chat API:\", error);\n        }\n        throw error;\n    }\n}\n\n\n/**\n * Calls the Anthropic Chat API (non-streaming).\n *\n * @param {object} env - Environment object containing ANTHROPIC_API_URL and ANTHROPIC_API_KEY.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {Promise<string>} The generated text content.\n * @throws {Error} If API call fails.\n */\nasync function callAnthropicChatAPI(env, promptText, systemPromptText = null) {\n    if (!env.ANTHROPIC_API_URL || !env.ANTHROPIC_API_KEY) {\n        throw new Error(\"ANTHROPIC_API_URL or ANTHROPIC_API_KEY not set.\");\n    }\n    const modelName = env.DEFAULT_ANTHROPIC_MODEL || \"claude-sonnet-4-20250514\";\n    const url = `${env.ANTHROPIC_API_URL}/v1/messages`;\n\n    const messages = [{ role: \"user\", content: promptText }];\n    \n    const payload = {\n        model: modelName,\n        messages: messages,\n        max_tokens: 2048\n    };\n\n    if (systemPromptText && systemPromptText.trim() !== '') {\n        // Anthropic \u4E2D\u8F6C\u4E0D\u652F\u6301 system \u53C2\u6570\uFF0C\u5C06\u5176\u878D\u5165 user \u6D88\u606F\n        payload.messages[0].content = `${systemPromptText}\\n\\n${promptText}`;\n    }\n\n    try {\n        const response = await fetchWithTimeout(url, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${env.ANTHROPIC_API_KEY}`,\n                'User-Agent': 'Cloudflare-Worker/1.0'\n            },\n            body: JSON.stringify(payload)\n        }, 180000);\n\n        if (!response.ok) {\n            const errorText = await response.text();\n            throw new Error(`Anthropic Chat API error (${response.status}): ${errorText}`);\n        }\n\n        const data = await response.json();\n\n        // Filter out thinking blocks and only return text content\n        if (data.content && Array.isArray(data.content)) {\n            const textBlocks = data.content\n                .filter(block => block.type === 'text' && block.text)\n                .map(block => block.text);\n\n            if (textBlocks.length > 0) {\n                return textBlocks.join('\\n');\n            }\n        }\n\n        throw new Error(\"Anthropic Chat API returned no content.\");\n    } catch (error) {\n        console.error(\"Error calling Anthropic Chat API:\", error);\n        throw error;\n    }\n}\n\n\n/**\n * Calls the Anthropic Chat API with streaming.\n *\n * @param {object} env - Environment object.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\n * @throws {Error} If API call fails.\n */\nasync function* callAnthropicChatAPIStream(env, promptText, systemPromptText = null) {\n    if (!env.ANTHROPIC_API_URL || !env.ANTHROPIC_API_KEY) {\n        throw new Error(\"ANTHROPIC_API_URL or ANTHROPIC_API_KEY not set.\");\n    }\n    const modelName = env.DEFAULT_ANTHROPIC_MODEL || \"claude-sonnet-4-20250514\";\n    const url = `${env.ANTHROPIC_API_URL}/v1/messages`;\n\n    const messages = [{ role: \"user\", content: promptText }];\n    \n    const payload = {\n        model: modelName,\n        messages: messages,\n        max_tokens: 2048,\n        stream: true\n    };\n\n    if (systemPromptText && systemPromptText.trim() !== '') {\n        payload.messages[0].content = `${systemPromptText}\\n\\n${promptText}`;\n    }\n\n    try {\n        const response = await fetchWithTimeout(url, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${env.ANTHROPIC_API_KEY}`,\n                'User-Agent': 'Cloudflare-Worker/1.0'\n            },\n            body: JSON.stringify(payload)\n        }, 180000);\n\n        if (!response.ok) {\n            const errorText = await response.text();\n            throw new Error(`Anthropic Chat API error (${response.status}): ${errorText}`);\n        }\n\n        const reader = response.body.getReader();\n        const decoder = new TextDecoder();\n        let buffer = '';\n        let hasYieldedContent = false;\n        let currentBlockType = null;\n\n        while (true) {\n            const { done, value } = await reader.read();\n            if (done) break;\n\n            buffer += decoder.decode(value, { stream: true });\n            const lines = buffer.split('\\n');\n            buffer = lines.pop() || '';\n\n            for (const line of lines) {\n                if (!line.trim() || !line.startsWith('data: ')) continue;\n                const data = line.substring(6).trim();\n                if (data === '[DONE]') continue;\n\n                try {\n                    const parsed = JSON.parse(data);\n\n                    // Track the type of the current content block\n                    if (parsed.type === 'content_block_start') {\n                        currentBlockType = parsed.content_block?.type;\n                    } else if (parsed.type === 'content_block_delta' && parsed.delta?.text) {\n                        // Only yield text if the current block is not a thinking block\n                        if (currentBlockType !== 'thinking') {\n                            hasYieldedContent = true;\n                            yield parsed.delta.text;\n                        }\n                    } else if (parsed.type === 'content_block_stop') {\n                        currentBlockType = null;\n                    } else if (parsed.type === 'error') {\n                        throw new Error(`Anthropic stream error: ${parsed.error?.message || 'Unknown'}`);\n                    }\n                } catch (e) {\n                    console.warn(\"Failed to parse Anthropic stream chunk:\", data, e.message);\n                }\n            }\n        }\n\n        if (!hasYieldedContent) {\n            throw new Error(\"Anthropic stream completed but yielded no content.\");\n        }\n    } catch (error) {\n        console.error(\"Error calling Anthropic Chat API Stream:\", error);\n        throw error;\n    }\n}\n\n\n/**\n * Main function to call the appropriate chat API (Gemini or OpenAI) based on model name.\n * Defaults to Gemini if no specific API is indicated in the model name.\n *\n * @param {object} env - Environment object.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {Promise<string>} The generated text content.\n * @throws {Error} If API keys/URLs are not set, or if API call fails.\n */\nexport async function callChatAPI(env, promptText, systemPromptText = null) {\n    const platform = env.USE_MODEL_PLATFORM;\n    if (platform.startsWith(\"OPEN\")) {\n        return callOpenAIChatAPI(env, promptText, systemPromptText);\n    } else if (platform.startsWith(\"ANTHROPIC\")) {\n        return callAnthropicChatAPI(env, promptText, systemPromptText);\n    } else { // Default to Gemini\n        return callGeminiChatAPI(env, promptText, systemPromptText);\n    }\n}\n\n/**\n * Main function to call the appropriate chat API (Gemini or OpenAI) with streaming.\n * Defaults to Gemini if no specific API is indicated in the model name.\n *\n * @param {object} env - Environment object.\n * @param {string} promptText - The user's prompt.\n * @param {string | null} [systemPromptText=null] - Optional system prompt text.\n * @returns {AsyncGenerator<string, void, undefined>} An async generator yielding text chunks.\n * @throws {Error} If API keys/URLs are not set, or if API call fails.\n */\nexport async function* callChatAPIStream(env, promptText, systemPromptText = null) {\n    const platform = env.USE_MODEL_PLATFORM;\n    if (platform.startsWith(\"OPEN\")) {\n        yield* callOpenAIChatAPIStream(env, promptText, systemPromptText);\n    } else if (platform.startsWith(\"ANTHROPIC\")) {\n        yield* callAnthropicChatAPIStream(env, promptText, systemPromptText);\n    } else { // Default to Gemini\n        const streamMode = getGeminiStreamMode(env);\n        if (streamMode === \"off\") {\n            const text = await callGeminiChatAPI(env, promptText, systemPromptText);\n            yield text;\n            return;\n        }\n        yield* callGeminiChatAPIStream(env, promptText, systemPromptText);\n    }\n}\n\n\n/**\n * \u5E26\u6709\u8D85\u65F6\u529F\u80FD\u7684 fetch \u5C01\u88C5\n * @param {string} resource fetch \u7684\u8BF7\u6C42 URL\n * @param {object} options fetch \u7684\u914D\u7F6E\u5BF9\u8C61\n * @param {number} timeout \u8D85\u65F6\u65F6\u95F4\uFF0C\u5355\u4F4D\u6BEB\u79D2\n * @returns {Promise<Response>}\n */\nasync function fetchWithTimeout(resource, options = {}, timeout = 180000) {\n  const controller = new AbortController();\n  const id = setTimeout(() => controller.abort(), timeout);\n\n  try {\n    const response = await fetch(resource, {\n      ...options,\n      signal: controller.signal  // \u5173\u8054 AbortController\n    });\n    return response;\n  } catch (error) {\n    // \u5F53 abort() \u88AB\u8C03\u7528\u65F6\uFF0Cfetch \u4F1A\u629B\u51FA\u4E00\u4E2A AbortError\n    if (error.name === 'AbortError') {\n      throw new Error('Request timed out');\n    }\n    // \u5176\u4ED6\u7F51\u7EDC\u9519\u8BEF\u7B49\n    throw error;\n  } finally {\n    // \u6E05\u9664\u8BA1\u65F6\u5668\uFF0C\u9632\u6B62\u5185\u5B58\u6CC4\u6F0F\n    clearTimeout(id);\n  }\n}\n", "// src/dataSources/projects.js\r\nimport { fetchData, getISODate, removeMarkdownCodeBlock, formatDateToChineseWithTime, escapeHtml} from '../helpers.js';\r\nimport { callChatAPI } from '../chatapi.js';\r\n\r\nconst ProjectsDataSource = {\r\n    fetch: async (env) => {\r\n        console.log(`Fetching projects from: ${env.PROJECTS_API_URL}`);\r\n        let projects;\r\n        try {\r\n            projects = await fetchData(env.PROJECTS_API_URL);\r\n        } catch (error) {\r\n            console.error(\"Error fetching projects data:\", error.message);\r\n            return { error: \"Failed to fetch projects data\", details: error.message, items: [] };\r\n        }\r\n\r\n        if (!Array.isArray(projects)) {\r\n            console.error(\"Projects data is not an array:\", projects);\r\n            return { error: \"Invalid projects data format\", received: projects, items: [] };\r\n        }\r\n         if (projects.length === 0) {\r\n            console.log(\"No projects fetched from API.\");\r\n            return { items: [] };\r\n        }\r\n\r\n        if (!env.OPEN_TRANSLATE === \"true\") {\r\n            console.warn(\"Skipping paper translations.\");\r\n            return projects.map(p => ({ ...p, description_zh: p.description || \"\" }));\r\n        }\r\n\r\n        const descriptionsToTranslate = projects\r\n            .map(p => p.description || \"\")\r\n            .filter(desc => typeof desc === 'string');\r\n\r\n        const nonEmptyDescriptions = descriptionsToTranslate.filter(d => d.trim() !== \"\");\r\n        if (nonEmptyDescriptions.length === 0) {\r\n            console.log(\"No non-empty project descriptions to translate.\");\r\n            return projects.map(p => ({ ...p, description_zh: p.description || \"\" }));\r\n        }\r\n        const promptText = `Translate the following English project descriptions to Chinese.\r\nProvide the translations as a JSON array of strings, in the exact same order as the input.\r\nEach string in the output array must correspond to the string at the same index in the input array.\r\nIf an input description is an empty string, the corresponding translated string in the output array should also be an empty string.\r\nInput Descriptions (JSON array of strings):\r\n${JSON.stringify(descriptionsToTranslate)}\r\nRespond ONLY with the JSON array of Chinese translations. Do not include any other text or explanations.\r\nJSON Array of Chinese Translations:`;\r\n\r\n        let translatedTexts = [];\r\n        try {\r\n            console.log(`Requesting translation for ${descriptionsToTranslate.length} project descriptions.`);\r\n            const chatResponse = await callChatAPI(env, promptText);\r\n            const parsedTranslations = JSON.parse(removeMarkdownCodeBlock(chatResponse)); // Assuming direct JSON array response\r\n\r\n            if (parsedTranslations && Array.isArray(parsedTranslations) && parsedTranslations.length === descriptionsToTranslate.length) {\r\n                translatedTexts = parsedTranslations;\r\n            } else {\r\n                console.warn(`Translation count mismatch or parsing error for project descriptions. Expected ${descriptionsToTranslate.length}, received ${parsedTranslations ? parsedTranslations.length : 'null'}. Falling back.`);\r\n                translatedTexts = descriptionsToTranslate.map(() => null);\r\n            }\r\n        } catch (translationError) {\r\n            console.error(\"Failed to translate project descriptions in batch:\", translationError.message);\r\n            translatedTexts = descriptionsToTranslate.map(() => null);\r\n        }\r\n\r\n        return projects.map((project, index) => {\r\n            const translated = translatedTexts[index];\r\n            return {\r\n                ...project,\r\n                description_zh: (typeof translated === 'string') ? translated : (project.description || \"\")\r\n            };\r\n        });\r\n    },\r\n    transform: (projectsData, sourceType) => {\r\n        const unifiedProjects = [];\r\n        const now = getISODate();\r\n        if (Array.isArray(projectsData)) {\r\n            projectsData.forEach((project, index) => {\r\n                unifiedProjects.push({\r\n                    id: index + 1, // Use project.url as ID if available\r\n                    type: sourceType,\r\n                    url: project.url,\r\n                    title: project.name,\r\n                    description: project.description_zh || project.description || \"\",\r\n                    published_date: now, // Projects don't have a published date, use current date\r\n                    authors: project.owner ? [project.owner] : [],\r\n                    source: \"GitHub Trending\",\r\n                    details: {\r\n                        owner: project.owner,\r\n                        name: project.name,\r\n                        language: project.language,\r\n                        languageColor: project.languageColor,\r\n                        totalStars: project.totalStars,\r\n                        forks: project.forks,\r\n                        starsToday: project.starsToday,\r\n                        builtBy: project.builtBy || []\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedProjects;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong> (\u6240\u6709\u8005: ${escapeHtml(item.details.owner)})<br>\r\n            <small>\u661F\u6807: ${escapeHtml(item.details.totalStars)} (\u4ECA\u65E5: ${escapeHtml(item.details.starsToday)}) | \u8BED\u8A00: ${escapeHtml(item.details.language || 'N/A')}</small>\r\n            \u63CF\u8FF0: ${escapeHtml(item.description) || 'N/A'}<br>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u5728 GitHub \u4E0A\u67E5\u770B</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default ProjectsDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml } from '../helpers';\r\n\r\nconst PapersDataSource = {\r\n    type: 'papers',\r\n    async fetch(env, foloCookie) {\r\n        const hgPapersListId = env.HGPAPERS_LIST_ID;\r\n        const fetchPages = parseInt(env.HGPAPERS_FETCH_PAGES || '1', 10);\r\n        const allPaperItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!hgPapersListId) {\r\n            console.warn('HGPAPERS_LIST_ID is not set in environment variables. Skipping papers fetch.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Aggregated Papers\",\r\n                home_page_url: \"https://example.com/papers\",\r\n                description: \"Aggregated papers from various sources\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: hgPapersListId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Papers data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Papers data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allPaperItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.feeds.title,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Papers, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Papers data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Aggregated Papers\",\r\n            home_page_url: \"https://example.com/papers\",\r\n            description: \"Aggregated papers from various sources\",\r\n            language: \"zh-cn\",\r\n            items: allPaperItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'Aggregated Papers',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                 ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}<hr>\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u5728 ArXiv/\u6765\u6E90 \u9605\u8BFB</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default PapersDataSource;", "// src/dataSources/huggingface-papers.js\r\nimport { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, removeMarkdownCodeBlock, formatDateToChineseWithTime, escapeHtml} from '../helpers.js';\r\nimport { callChatAPI } from '../chatapi.js';\r\n\r\nconst PapersDataSource = {\r\n    fetch: async (env, foloCookie) => {\r\n        const feedId = env.HGPAPERS_FEED_ID;\r\n        const fetchPages = parseInt(env.HGPAPERS_FETCH_PAGES || '3', 10);\r\n        const allPapersItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!feedId) {\r\n            console.error('HGPAPERS_FEED_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Huggingface Daily Papers Feeds\",\r\n                home_page_url: \"https://huggingface.co/papers\",\r\n                description: \"Aggregated Huggingface Daily Papers feeds\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                feedId: feedId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Huggingface Papers data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Huggingface Papers data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allPapersItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `huggingface-papers`,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Huggingface Papers, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Huggingface Papers data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        const papersData = {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Huggingface Daily Papers Feeds\",\r\n            home_page_url: \"https://huggingface.co/papers\",\r\n            description: \"Aggregated Huggingface Daily Papers feeds\",\r\n            language: \"zh-cn\",\r\n            items: allPapersItems\r\n        };\r\n\r\n        if (papersData.items.length === 0) {\r\n            console.log(\"No hgpapers found for today or after filtering.\");\r\n            return papersData;\r\n        }\r\n\r\n        if (!env.OPEN_TRANSLATE === \"true\") {\r\n            console.warn(\"Skipping hgpapers translations.\");\r\n            papersData.items = papersData.items.map(item => ({\r\n                ...item,\r\n                title_zh: item.title || \"\",\r\n                content_html_zh: item.content_html || \"\"\r\n            }));\r\n            return papersData;\r\n        }\r\n\r\n        const itemsToTranslate = papersData.items.map((item, index) => ({\r\n            id: index,\r\n            original_title: item.title || \"\"\r\n        }));\r\n\r\n        const hasContentToTranslate = itemsToTranslate.some(item => item.original_title.trim() !== \"\");\r\n        if (!hasContentToTranslate) {\r\n            console.log(\"No non-empty hgpapers titles to translate for today's papers.\");\r\n            papersData.items = papersData.items.map(item => ({ ...item, title_zh: item.title || \"\", content_html_zh: item.content_html || \"\" }));\r\n            return papersData;\r\n        }\r\n\r\n        const promptText = `You will be given a JSON array of paper data objects. Each object has an \"id\" and \"original_title\".\r\nTranslate \"original_title\" into Chinese.\r\nReturn a JSON array of objects. Each output object MUST have:\r\n- \"id\": The same id from the input.\r\n- \"title_zh\": Chinese translation of \"original_title\". Empty if original is empty.\r\nInput: ${JSON.stringify(itemsToTranslate)}\r\nRespond ONLY with the JSON array.`;\r\n\r\n        let translatedItemsMap = new Map();\r\n        try {\r\n            console.log(`Requesting translation for ${itemsToTranslate.length} hgpapers titles for today.`);\r\n            const chatResponse = await callChatAPI(env, promptText);\r\n            const parsedTranslations = JSON.parse(removeMarkdownCodeBlock(chatResponse)); // Assuming direct JSON array response\r\n\r\n            if (parsedTranslations) {\r\n                parsedTranslations.forEach(translatedItem => {\r\n                    if (translatedItem && typeof translatedItem.id === 'number' &&\r\n                        typeof translatedItem.title_zh === 'string') {\r\n                        translatedItemsMap.set(translatedItem.id, translatedItem);\r\n                    }\r\n                });\r\n            }\r\n        } catch (translationError) {\r\n            console.error(\"Failed to translate hgpapers titles in batch:\", translationError.message);\r\n        }\r\n\r\n        papersData.items = papersData.items.map((originalItem, index) => {\r\n            const translatedData = translatedItemsMap.get(index);\r\n            return {\r\n                ...originalItem,\r\n                title_zh: translatedData ? translatedData.title_zh : (originalItem.title || \"\")\r\n            };\r\n        });\r\n\r\n        return papersData;\r\n    },\r\n    transform: (papersData,sourceType) => {\r\n        const unifiedPapers = [];\r\n        if (papersData && Array.isArray(papersData.items)) {\r\n            papersData.items.forEach((item, index) => {\r\n                unifiedPapers.push({\r\n                    id: item.id, // Use item.id from Folo data\r\n                    type: sourceType,\r\n                    url: item.url,\r\n                    title: item.title_zh || item.title,\r\n                    description: stripHtml(item.content_html || \"\"),\r\n                    published_date: item.date_published,\r\n                    authors: typeof item.authors === 'string' ? item.authors.split(',').map(s => s.trim()) : (item.authors ? item.authors.map(a => a.name) : []),\r\n                    source: item.source || \"Huggingface Papers\", // Use existing source or default\r\n                    details: {\r\n                        content_html: item.content_html || \"\"\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        return unifiedPapers;\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                 ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}<hr>\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u5728 ArXiv/\u6765\u6E90 \u9605\u8BFB</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default PapersDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml} from '../helpers';\r\n\r\nconst TwitterDataSource = {\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.TWITTER_LIST_ID;\r\n        const fetchPages = parseInt(env.TWITTER_FETCH_PAGES || '3', 10);\r\n        const allTwitterItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.error('TWITTER_LIST_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Twitter Feeds\",\r\n                home_page_url: \"https://x.com/\",\r\n                description: \"Aggregated Twitter feeds from various users\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            // \u76F4\u63A5\u4F7F\u7528\u4F20\u5165\u7684 foloCookie\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Twitter data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Twitter data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allTwitterItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: entry.feeds.title && entry.feeds.title.startsWith('Twitter') ? `twitter-${entry.entries.author}` : `${entry.feeds.title} - ${entry.entries.author}` ,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Twitter, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Twitter data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            // Random wait time between 0 and 5 seconds to avoid rate limiting\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        return {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Twitter Feeds\",\r\n            home_page_url: \"https://x.com/\",\r\n            description: \"Aggregated Twitter feeds from various users\",\r\n            language: \"zh-cn\",\r\n            items: allTwitterItems\r\n        };\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'twitter', // Use existing source or default\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u67E5\u770B\u63A8\u6587</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default TwitterDataSource;\r\n", "import { getRandomUserAgent, sleep, isDateWithinLastDays, stripHtml, formatDateToChineseWithTime, escapeHtml} from '../helpers';\r\n\r\nconst RedditDataSource = {\r\n    async fetch(env, foloCookie) {\r\n        const listId = env.REDDIT_LIST_ID;\r\n        const fetchPages = parseInt(env.REDDIT_FETCH_PAGES || '3', 10);\r\n        const allRedditItems = [];\r\n        const filterDays = parseInt(env.FOLO_FILTER_DAYS || '3', 10);\r\n\r\n        if (!listId) {\r\n            console.error('REDDIT_LIST_ID is not set in environment variables.');\r\n            return {\r\n                version: \"https://jsonfeed.org/version/1.1\",\r\n                title: \"Reddit Feeds\",\r\n                home_page_url: \"https://www.reddit.com/\",\r\n                description: \"Aggregated Reddit feeds from various subreddits/users\",\r\n                language: \"zh-cn\",\r\n                items: []\r\n            };\r\n        }\r\n\r\n        let publishedAfter = null;\r\n        for (let i = 0; i < fetchPages; i++) {\r\n            const userAgent = getRandomUserAgent();\r\n            const headers = {\r\n                'User-Agent': userAgent,\r\n                'Content-Type': 'application/json',\r\n                'accept': 'application/json',\r\n                'accept-language': 'zh-CN,zh;q=0.9',\r\n                'baggage': 'sentry-environment=stable,sentry-release=5251fa921ef6cbb6df0ac4271c41c2b4a0ce7c50,sentry-public_key=e5bccf7428aa4e881ed5cb713fdff181,sentry-trace_id=2da50ca5ad944cb794670097d876ada8,sentry-sampled=true,sentry-sample_rand=0.06211835167903246,sentry-sample_rate=1',\r\n                'origin': 'https://app.follow.is',\r\n                'priority': 'u=1, i',\r\n                'sec-ch-ua': '\"Google Chrome\";v=\"135\", \"Not-A.Brand\";v=\"8\", \"Chromium\";v=\"135\"',\r\n                'sec-ch-ua-mobile': '?1',\r\n                'sec-ch-ua-platform': '\"Android\"',\r\n                'sec-fetch-dest': 'empty',\r\n                'sec-fetch-mode': 'cors',\r\n                'sec-fetch-site': 'same-site',\r\n                'x-app-name': 'Folo Web',\r\n                'x-app-version': '0.4.9',\r\n            };\r\n\r\n            if (foloCookie) {\r\n                headers['Cookie'] = foloCookie;\r\n            }\r\n\r\n            const body = {\r\n                listId: listId,\r\n                view: 1,\r\n                withContent: true,\r\n            };\r\n\r\n            if (publishedAfter) {\r\n                body.publishedAfter = publishedAfter;\r\n            }\r\n\r\n            try {\r\n                console.log(`Fetching Reddit data, page ${i + 1}...`);\r\n                const response = await fetch(env.FOLO_DATA_API, {\r\n                    method: 'POST',\r\n                    headers: headers,\r\n                    body: JSON.stringify(body),\r\n                });\r\n\r\n                if (!response.ok) {\r\n                    console.error(`Failed to fetch Reddit data, page ${i + 1}: ${response.statusText}`);\r\n                    break;\r\n                }\r\n                const data = await response.json();\r\n                if (data && data.data && data.data.length > 0) {\r\n                    const filteredItems = data.data.filter(entry => isDateWithinLastDays(entry.entries.publishedAt, filterDays));\r\n                    allRedditItems.push(...filteredItems.map(entry => ({\r\n                        id: entry.entries.id,\r\n                        url: entry.entries.url,\r\n                        title: entry.entries.title,\r\n                        content_html: entry.entries.content,\r\n                        date_published: entry.entries.publishedAt,\r\n                        authors: [{ name: entry.entries.author }],\r\n                        source: `${entry.feeds.title}` ,\r\n                    })));\r\n                    publishedAfter = data.data[data.data.length - 1].entries.publishedAt;\r\n                } else {\r\n                    console.log(`No more data for Reddit, page ${i + 1}.`);\r\n                    break;\r\n                }\r\n            } catch (error) {\r\n                console.error(`Error fetching Reddit data, page ${i + 1}:`, error);\r\n                break;\r\n            }\r\n\r\n            await sleep(Math.random() * 5000);\r\n        }\r\n\r\n        const redditData = {\r\n            version: \"https://jsonfeed.org/version/1.1\",\r\n            title: \"Reddit Feeds\",\r\n            home_page_url: \"https://www.reddit.com/\",\r\n            description: \"Aggregated Reddit feeds from various subreddits/users\",\r\n            language: \"zh-cn\",\r\n            items: allRedditItems\r\n        };\r\n\r\n        if (redditData.items.length === 0) {\r\n            console.log(\"No reddit posts found for today or after filtering.\");\r\n            return redditData;\r\n        }\r\n\r\n        redditData.items = redditData.items.map(item => ({\r\n            ...item,\r\n            title_zh: item.title || \"\"\r\n        }));\r\n\r\n        return redditData;\r\n    },\r\n\r\n    transform(rawData, sourceType) {\r\n        if (!rawData || !rawData.items) {\r\n            return [];\r\n        }\r\n\r\n        return rawData.items.map(item => ({\r\n            id: item.id,\r\n            type: sourceType,\r\n            url: item.url,\r\n            title: item.title,\r\n            description: stripHtml(item.content_html || \"\"),\r\n            published_date: item.date_published,\r\n            authors: item.authors ? item.authors.map(author => author.name).join(', ') : 'Unknown',\r\n            source: item.source || 'reddit',\r\n            details: {\r\n                content_html: item.content_html || \"\"\r\n            }\r\n        }));\r\n    },\r\n\r\n    generateHtml: (item) => {\r\n        return `\r\n            <strong>${escapeHtml(item.title)}</strong><br>\r\n            <small>\u6765\u6E90: ${escapeHtml(item.source || '\u672A\u77E5')} | \u53D1\u5E03\u65E5\u671F: ${formatDateToChineseWithTime(item.published_date)}</small>\r\n            <div class=\"content-html\">\r\n                ${item.details.content_html || '\u65E0\u5185\u5BB9\u3002'}\r\n            </div>\r\n            <a href=\"${escapeHtml(item.url)}\" target=\"_blank\" rel=\"noopener noreferrer\">\u67E5\u770B Reddit \u5E16\u5B50</a>\r\n        `;\r\n    }\r\n};\r\n\r\nexport default RedditDataSource;\r\n", "// src/dataFetchers.js\r\nimport NewsAggregatorDataSource from './dataSources/newsAggregator.js';\r\nimport FoloMultiFeedsDataSource from './dataSources/folo-multi-feeds.js';\r\nimport AibaseDataSource from './dataSources/aibase.js';\r\nimport JiqizhixinDataSource from './dataSources/jiqizhixin.js';\r\nimport QbitDataSource from './dataSources/qbit.js';\r\nimport XinzhiyuanDataSource from './dataSources/xinzhiyuan.js';\r\nimport XiaohuDataSource from './dataSources/xiaohu.js';\r\nimport GithubTrendingDataSource from './dataSources/github-trending.js';\r\nimport PapersDataSource from './dataSources/papers.js';\r\nimport HuggingfacePapersDataSource from './dataSources/huggingface-papers.js';\r\nimport TwitterDataSource from './dataSources/twitter.js';\r\nimport RedditDataSource from './dataSources/reddit.js';\r\n\r\n\r\n// Register data sources as arrays to support multiple sources per type\r\nexport const dataSources = {\r\n    // news \u4E0B\u652F\u6301\u591A\u4E2A\u53EF\u9009 Folo feed/list \u6E90\uFF1A\u53EA\u8981\u5728\u73AF\u5883\u53D8\u91CF\u4E2D\u914D\u7F6E\u5BF9\u5E94 *_FEED_ID \u6216 LIST_ID \u5373\u53EF\u81EA\u52A8\u751F\u6548\r\n    news: { name: '\u65B0\u95FB', sources: [NewsAggregatorDataSource, FoloMultiFeedsDataSource, AibaseDataSource, JiqizhixinDataSource, QbitDataSource, XinzhiyuanDataSource, XiaohuDataSource] },\r\n    project: { name: '\u9879\u76EE', sources: [GithubTrendingDataSource] },\r\n    paper: { name: '\u8BBA\u6587', sources: [PapersDataSource, HuggingfacePapersDataSource] },\r\n    socialMedia: { name: '\u793E\u4EA4\u5E73\u53F0', sources: [TwitterDataSource, RedditDataSource] },\r\n    // Add new data sources here as arrays, e.g.,\r\n    // newType: { name: '\u65B0\u7C7B\u578B', sources: [NewTypeDataSource1, NewTypeDataSource2] },\r\n};\r\n\r\n/**\r\n * Fetches and transforms data from all data sources for a specified type.\r\n * @param {string} sourceType - The type of data source (e.g., 'news', 'projects', 'papers').\r\n * @param {object} env - The environment variables.\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<Array<object>>} A promise that resolves to an array of unified data objects from all sources of that type.\r\n */\r\nexport async function fetchAndTransformDataForType(sourceType, env, foloCookie) {\r\n    const sources = dataSources[sourceType].sources;\r\n    if (!sources || !Array.isArray(sources)) {\r\n        console.error(`No data sources registered for type: ${sourceType}`);\r\n        return [];\r\n    }\r\n\r\n    let allUnifiedDataForType = [];\r\n    for (const dataSource of sources) {\r\n        try {\r\n            // Pass foloCookie to the fetch method of the data source\r\n            const rawData = await dataSource.fetch(env, foloCookie);\r\n            const unifiedData = dataSource.transform(rawData, sourceType);\r\n            allUnifiedDataForType = allUnifiedDataForType.concat(unifiedData);\r\n        } catch (error) {\r\n            console.error(`Error fetching or transforming data from source ${dataSource.type} for type ${sourceType}:`, error.message);\r\n            // Continue to next data source even if one fails\r\n        }\r\n    }\r\n\r\n    // Sort by published_date in descending order for each type\r\n    allUnifiedDataForType.sort((a, b) => {\r\n        const dateA = new Date(a.published_date);\r\n        const dateB = new Date(b.published_date);\r\n        return dateB.getTime() - dateA.getTime();\r\n    });\r\n\r\n    // Cap items per type to keep prompts within model limits, configurable via env\r\n    const typeCapKey = `MAX_ITEMS_${sourceType.toUpperCase()}`;\r\n    const maxItems = parseInt(env[typeCapKey] || env.MAX_ITEMS_PER_TYPE || '30', 10);\r\n    if (Number.isFinite(maxItems) && maxItems > 0 && allUnifiedDataForType.length > maxItems) {\r\n        console.log(`Capping ${sourceType} items from ${allUnifiedDataForType.length} to ${maxItems}.`);\r\n        allUnifiedDataForType = allUnifiedDataForType.slice(0, maxItems);\r\n    }\r\n\r\n    return allUnifiedDataForType;\r\n}\r\n\r\n/**\r\n * Fetches and transforms data from all registered data sources across all types.\r\n * @param {object} env - The environment variables.\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<object>} A promise that resolves to an object containing unified data for each source type.\r\n */\r\nexport async function fetchAllData(env, foloCookie) {\r\n    const allUnifiedData = {};\r\n    const fetchPromises = [];\r\n\r\n    for (const sourceType in dataSources) {\r\n        if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n            fetchPromises.push(\r\n                fetchAndTransformDataForType(sourceType, env, foloCookie).then(data => {\r\n                    allUnifiedData[sourceType] = data;\r\n                })\r\n            );\r\n        }\r\n    }\r\n    await Promise.allSettled(fetchPromises); // Use allSettled to ensure all promises complete\r\n    return allUnifiedData;\r\n}\r\n\r\n/**\r\n * Fetches and transforms data from all data sources for a specific category.\r\n * @param {object} env - The environment variables.\r\n * @param {string} category - The category to fetch data for (e.g., 'news', 'project', 'paper', 'twitter').\r\n * @param {string} [foloCookie] - The Folo authentication cookie.\r\n * @returns {Promise<Array<object>>} A promise that resolves to an array of unified data objects for the specified category.\r\n */\r\nexport async function fetchDataByCategory(env, category, foloCookie) {\r\n    if (!dataSources[category]) {\r\n        console.warn(`Attempted to fetch data for unknown category: ${category}`);\r\n        return [];\r\n    }\r\n    return await fetchAndTransformDataForType(category, env, foloCookie);\r\n}\r\n", "// src/kv.js\r\n\r\nexport async function storeInKV(kvNamespace, key, value, expirationTtl = 86400 * 7) { // 7 days default\r\n    console.log(`Storing data in KV with key: ${key}`);\r\n    await kvNamespace.put(key, JSON.stringify(value), { expirationTtl });\r\n}\r\n\r\nexport async function getFromKV(kvNamespace, key) {\r\n    console.log(`Retrieving data from KV with key: ${key}`);\r\n    const value = await kvNamespace.get(key);\r\n    return value ? JSON.parse(value) : null;\r\n}", "// src/handlers/writeData.js\r\nimport { getISODate, getFetchDate, setFetchDate } from '../helpers.js';\r\nimport { fetchAllData, fetchDataByCategory, dataSources } from '../dataFetchers.js'; // \u5BFC\u5165 fetchDataByCategory \u548C dataSources\r\nimport { storeInKV } from '../kv.js';\r\n\r\nexport async function handleWriteData(request, env) {\r\n    // Always anchor to\u5F53\u5929\u65E5\u671F\uFF08\u4E0A\u6D77\u65F6\u533A\uFF09\uFF0C\u907F\u514D\u51FA\u73B0 1970-01-01 \u4E4B\u7C7B\u7684\u9519\u8BEF\u503C\u3002\r\n    // \u5982\u9700\u6307\u5B9A\u5176\u4ED6\u65E5\u671F\uFF0C\u53EF\u540E\u7EED\u518D\u6269\u5C55\u8BF7\u6C42\u4F53\u53C2\u6570\u3002\r\n    const dateParam = getFetchDate();\r\n    const todayStr = getISODate();\r\n    const dateStr =\r\n        (dateParam && dateParam !== '1970-01-01') ? dateParam : todayStr;\r\n    setFetchDate(dateStr);\r\n    console.log(`Starting /writeData process for date: ${dateStr}`);\r\n    let category = null;\r\n    let foloCookie = null;\r\n    \r\n    try {\r\n        // \u5C1D\u8BD5\u89E3\u6790\u8BF7\u6C42\u4F53\uFF0C\u83B7\u53D6 category \u53C2\u6570\r\n        if (request.headers.get('Content-Type')?.includes('application/json')) {\r\n            const requestBody = await request.json();\r\n            category = requestBody.category;\r\n            foloCookie = requestBody.foloCookie; // \u83B7\u53D6 foloCookie\r\n        }\r\n\r\n        // \u5982\u679C\u524D\u7AEF\u63D0\u4F9B\u4E86 Folo Cookie\uFF0C\u5219\u6301\u4E45\u5316\u5230 KV\uFF0C\u4F9B\u5B9A\u65F6\u4EFB\u52A1\u81EA\u52A8\u6293\u53D6\u4F7F\u7528\r\n        if (foloCookie && env.FOLO_COOKIE_KV_KEY) {\r\n            try {\r\n                await storeInKV(env.DATA_KV, env.FOLO_COOKIE_KV_KEY, foloCookie, 86400 * 30); // 30 \u5929\r\n                console.log(`Saved Folo cookie to KV with key: ${env.FOLO_COOKIE_KV_KEY}`);\r\n            } catch (err) {\r\n                console.warn(`Failed to save Folo cookie to KV: ${err.message}`);\r\n            }\r\n        }\r\n\r\n        console.log(`Starting /writeData process for category: ${category || 'all'} with foloCookie presence: ${!!foloCookie}`);\r\n\r\n        let dataToStore = {};\r\n        let fetchPromises = [];\r\n        let successMessage = '';\r\n\r\n        if (category) {\r\n            // \u53EA\u6293\u53D6\u6307\u5B9A\u5206\u7C7B\u7684\u6570\u636E\r\n            const fetchedData = await fetchDataByCategory(env, category, foloCookie); // \u4F20\u9012 foloCookie\r\n            dataToStore[category] = fetchedData;\r\n            fetchPromises.push(storeInKV(env.DATA_KV, `${dateStr}-${category}`, fetchedData));\r\n            successMessage = `Data for category '${category}' fetched and stored.`;\r\n            console.log(`Transformed ${category}: ${fetchedData.length} items.`);\r\n        } else {\r\n            // \u6293\u53D6\u6240\u6709\u5206\u7C7B\u7684\u6570\u636E (\u73B0\u6709\u903B\u8F91)\r\n            const allUnifiedData = await fetchAllData(env, foloCookie); // \u4F20\u9012 foloCookie\r\n            \r\n            for (const sourceType in dataSources) {\r\n                if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                    dataToStore[sourceType] = allUnifiedData[sourceType] || [];\r\n                    fetchPromises.push(storeInKV(env.DATA_KV, `${dateStr}-${sourceType}`, dataToStore[sourceType]));\r\n                    console.log(`Transformed ${sourceType}: ${dataToStore[sourceType].length} items.`);\r\n                }\r\n            }\r\n            successMessage = `All data categories fetched and stored.`;\r\n        }\r\n\r\n        await Promise.all(fetchPromises);\r\n\r\n        const errors = []; // Placeholder for potential future error aggregation from fetchAllData or fetchDataByCategory\r\n\r\n        if (errors.length > 0) {\r\n            console.warn(\"/writeData completed with errors:\", errors);\r\n            return new Response(JSON.stringify({ \r\n                success: false, \r\n                message: `${successMessage} Some errors occurred.`, \r\n                errors: errors, \r\n                ...Object.fromEntries(Object.entries(dataToStore).map(([key, value]) => [`${key}ItemCount`, value.length]))\r\n            }), {\r\n                status: 200, headers: { 'Content-Type': 'application/json' }\r\n            });\r\n        } else {\r\n            console.log(\"/writeData process completed successfully.\");\r\n            return new Response(JSON.stringify({ \r\n                success: true, \r\n                message: successMessage,\r\n                ...Object.fromEntries(Object.entries(dataToStore).map(([key, value]) => [`${key}ItemCount`, value.length]))\r\n            }), {\r\n                headers: { 'Content-Type': 'application/json' }\r\n            });\r\n        }\r\n    } catch (error) {\r\n        console.error(\"Unhandled error in /writeData:\", error);\r\n        return new Response(JSON.stringify({ success: false, message: \"An unhandled error occurred during data processing.\", error: error.message, details: error.stack }), {\r\n            status: 500, headers: { 'Content-Type': 'application/json' }\r\n        });\r\n    }\r\n}\r\n", "// src/handlers/getContent.js\r\nimport { getISODate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { dataSources } from '../dataFetchers.js'; // Import dataSources\r\n\r\nexport async function handleGetContent(request, env) {\r\n    const url = new URL(request.url);\r\n    const dateParam = url.searchParams.get('date');\r\n    const dateStr = dateParam ? dateParam : getISODate();\r\n    console.log(`Getting content for date: ${dateStr}`);\r\n    try {\r\n        const responseData = {\r\n            date: dateStr,\r\n            message: `Successfully retrieved data for ${dateStr}.`\r\n        };\r\n\r\n        const fetchPromises = [];\r\n        for (const sourceType in dataSources) {\r\n            if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                fetchPromises.push(\r\n                    getFromKV(env.DATA_KV, `${dateStr}-${sourceType}`).then(data => {\r\n                        responseData[sourceType] = data || [];\r\n                    })\r\n                );\r\n            }\r\n        }\r\n        await Promise.allSettled(fetchPromises);\r\n        \r\n        return new Response(JSON.stringify(responseData), { headers: { 'Content-Type': 'application/json' } });\r\n    } catch (error) {\r\n        console.error(\"Error in /getContent:\", error);\r\n        return new Response(JSON.stringify({ success: false, message: \"Failed to get content.\", error: error.message, date: dateStr }), {\r\n            status: 500, headers: { 'Content-Type': 'application/json' }\r\n        });\r\n    }\r\n}\r\n", "/**\r\n * marked v15.0.12 - a markdown parser\r\n * Copyright (c) 2011-2025, Christopher Jeffrey. (MIT Licensed)\r\n * https://github.com/markedjs/marked\r\n */\r\n\r\n/**\r\n * DO NOT EDIT THIS FILE\r\n * The code in this file is generated from files in ./src/\r\n */\r\n\r\n\r\n// src/defaults.ts\r\nfunction _getDefaults() {\r\n  return {\r\n    async: false,\r\n    breaks: false,\r\n    extensions: null,\r\n    gfm: true,\r\n    hooks: null,\r\n    pedantic: false,\r\n    renderer: null,\r\n    silent: false,\r\n    tokenizer: null,\r\n    walkTokens: null\r\n  };\r\n}\r\nvar _defaults = _getDefaults();\r\nfunction changeDefaults(newDefaults) {\r\n  _defaults = newDefaults;\r\n}\r\n\r\n// src/rules.ts\r\nvar noopTest = { exec: () => null };\r\nfunction edit(regex, opt = \"\") {\r\n  let source = typeof regex === \"string\" ? regex : regex.source;\r\n  const obj = {\r\n    replace: (name, val) => {\r\n      let valSource = typeof val === \"string\" ? val : val.source;\r\n      valSource = valSource.replace(other.caret, \"$1\");\r\n      source = source.replace(name, valSource);\r\n      return obj;\r\n    },\r\n    getRegex: () => {\r\n      return new RegExp(source, opt);\r\n    }\r\n  };\r\n  return obj;\r\n}\r\nvar other = {\r\n  codeRemoveIndent: /^(?: {1,4}| {0,3}\\t)/gm,\r\n  outputLinkReplace: /\\\\([\\[\\]])/g,\r\n  indentCodeCompensation: /^(\\s+)(?:```)/,\r\n  beginningSpace: /^\\s+/,\r\n  endingHash: /#$/,\r\n  startingSpaceChar: /^ /,\r\n  endingSpaceChar: / $/,\r\n  nonSpaceChar: /[^ ]/,\r\n  newLineCharGlobal: /\\n/g,\r\n  tabCharGlobal: /\\t/g,\r\n  multipleSpaceGlobal: /\\s+/g,\r\n  blankLine: /^[ \\t]*$/,\r\n  doubleBlankLine: /\\n[ \\t]*\\n[ \\t]*$/,\r\n  blockquoteStart: /^ {0,3}>/,\r\n  blockquoteSetextReplace: /\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g,\r\n  blockquoteSetextReplace2: /^ {0,3}>[ \\t]?/gm,\r\n  listReplaceTabs: /^\\t+/,\r\n  listReplaceNesting: /^ {1,4}(?=( {4})*[^ ])/g,\r\n  listIsTask: /^\\[[ xX]\\] /,\r\n  listReplaceTask: /^\\[[ xX]\\] +/,\r\n  anyLine: /\\n.*\\n/,\r\n  hrefBrackets: /^<(.*)>$/,\r\n  tableDelimiter: /[:|]/,\r\n  tableAlignChars: /^\\||\\| *$/g,\r\n  tableRowBlankLine: /\\n[ \\t]*$/,\r\n  tableAlignRight: /^ *-+: *$/,\r\n  tableAlignCenter: /^ *:-+: *$/,\r\n  tableAlignLeft: /^ *:-+ *$/,\r\n  startATag: /^<a /i,\r\n  endATag: /^<\\/a>/i,\r\n  startPreScriptTag: /^<(pre|code|kbd|script)(\\s|>)/i,\r\n  endPreScriptTag: /^<\\/(pre|code|kbd|script)(\\s|>)/i,\r\n  startAngleBracket: /^</,\r\n  endAngleBracket: />$/,\r\n  pedanticHrefTitle: /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/,\r\n  unicodeAlphaNumeric: /[\\p{L}\\p{N}]/u,\r\n  escapeTest: /[&<>\"']/,\r\n  escapeReplace: /[&<>\"']/g,\r\n  escapeTestNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/,\r\n  escapeReplaceNoEncode: /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/g,\r\n  unescapeTest: /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig,\r\n  caret: /(^|[^\\[])\\^/g,\r\n  percentDecode: /%25/g,\r\n  findPipe: /\\|/g,\r\n  splitPipe: / \\|/,\r\n  slashPipe: /\\\\\\|/g,\r\n  carriageReturn: /\\r\\n|\\r/g,\r\n  spaceLine: /^ +$/gm,\r\n  notSpaceStart: /^\\S*/,\r\n  endingNewline: /\\n$/,\r\n  listItemRegex: (bull) => new RegExp(`^( {0,3}${bull})((?:[\t ][^\\\\n]*)?(?:\\\\n|$))`),\r\n  nextBulletRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \t][^\\\\n]*)?(?:\\\\n|$))`),\r\n  hrRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`),\r\n  fencesBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`),\r\n  headingBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`),\r\n  htmlBeginRegex: (indent) => new RegExp(`^ {0,${Math.min(3, indent - 1)}}<(?:[a-z].*>|!--)`, \"i\")\r\n};\r\nvar newline = /^(?:[ \\t]*(?:\\n|$))+/;\r\nvar blockCode = /^((?: {4}| {0,3}\\t)[^\\n]+(?:\\n(?:[ \\t]*(?:\\n|$))*)?)+/;\r\nvar fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\r\nvar hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\r\nvar heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\r\nvar bullet = /(?:[*+-]|\\d{1,9}[.)])/;\r\nvar lheadingCore = /^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/;\r\nvar lheading = edit(lheadingCore).replace(/bull/g, bullet).replace(/blockCode/g, /(?: {4}| {0,3}\\t)/).replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g, / {0,3}>/).replace(/heading/g, / {0,3}#{1,6}/).replace(/html/g, / {0,3}<[^\\n>]+>\\n/).replace(/\\|table/g, \"\").getRegex();\r\nvar lheadingGfm = edit(lheadingCore).replace(/bull/g, bullet).replace(/blockCode/g, /(?: {4}| {0,3}\\t)/).replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g, / {0,3}>/).replace(/heading/g, / {0,3}#{1,6}/).replace(/html/g, / {0,3}<[^\\n>]+>\\n/).replace(/table/g, / {0,3}\\|?(?:[:\\- ]*\\|)+[\\:\\- ]*\\n/).getRegex();\r\nvar _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\r\nvar blockText = /^[^\\n]+/;\r\nvar _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\r\nvar def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n[ \\t]*)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n[ \\t]*)?| *\\n[ \\t]*)(title))? *(?:\\n+|$)/).replace(\"label\", _blockLabel).replace(\"title\", /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/).getRegex();\r\nvar list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/).replace(/bull/g, bullet).getRegex();\r\nvar _tag = \"address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul\";\r\nvar _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\r\nvar html = edit(\r\n  \"^ {0,3}(?:<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)|comment[^\\\\n]*(\\\\n+|$)|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$))\",\r\n  \"i\"\r\n).replace(\"comment\", _comment).replace(\"tag\", _tag).replace(\"attribute\", / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex();\r\nvar paragraph = edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\", \"\").replace(\"|table\", \"\").replace(\"blockquote\", \" {0,3}>\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex();\r\nvar blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/).replace(\"paragraph\", paragraph).getRegex();\r\nvar blockNormal = {\r\n  blockquote,\r\n  code: blockCode,\r\n  def,\r\n  fences,\r\n  heading,\r\n  hr,\r\n  html,\r\n  lheading,\r\n  list,\r\n  newline,\r\n  paragraph,\r\n  table: noopTest,\r\n  text: blockText\r\n};\r\nvar gfmTable = edit(\r\n  \"^ *([^\\\\n ].*)\\\\n {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)\"\r\n).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"blockquote\", \" {0,3}>\").replace(\"code\", \"(?: {4}| {0,3}\t)[^\\\\n]\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex();\r\nvar blockGfm = {\r\n  ...blockNormal,\r\n  lheading: lheadingGfm,\r\n  table: gfmTable,\r\n  paragraph: edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\", \"\").replace(\"table\", gfmTable).replace(\"blockquote\", \" {0,3}>\").replace(\"fences\", \" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\", \" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\", \"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\", _tag).getRegex()\r\n};\r\nvar blockPedantic = {\r\n  ...blockNormal,\r\n  html: edit(\r\n    `^ *(?:comment *(?:\\\\n|\\\\s*$)|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\\\s[^'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))`\r\n  ).replace(\"comment\", _comment).replace(/tag/g, \"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b\").getRegex(),\r\n  def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\r\n  heading: /^(#{1,6})(.*)(?:\\n+|$)/,\r\n  fences: noopTest,\r\n  // fences not supported\r\n  lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\r\n  paragraph: edit(_paragraph).replace(\"hr\", hr).replace(\"heading\", \" *#{1,6} *[^\\n]\").replace(\"lheading\", lheading).replace(\"|table\", \"\").replace(\"blockquote\", \" {0,3}>\").replace(\"|fences\", \"\").replace(\"|list\", \"\").replace(\"|html\", \"\").replace(\"|tag\", \"\").getRegex()\r\n};\r\nvar escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\r\nvar inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\r\nvar br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\r\nvar inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\r\nvar _punctuation = /[\\p{P}\\p{S}]/u;\r\nvar _punctuationOrSpace = /[\\s\\p{P}\\p{S}]/u;\r\nvar _notPunctuationOrSpace = /[^\\s\\p{P}\\p{S}]/u;\r\nvar punctuation = edit(/^((?![*_])punctSpace)/, \"u\").replace(/punctSpace/g, _punctuationOrSpace).getRegex();\r\nvar _punctuationGfmStrongEm = /(?!~)[\\p{P}\\p{S}]/u;\r\nvar _punctuationOrSpaceGfmStrongEm = /(?!~)[\\s\\p{P}\\p{S}]/u;\r\nvar _notPunctuationOrSpaceGfmStrongEm = /(?:[^\\s\\p{P}\\p{S}]|~)/u;\r\nvar blockSkip = /\\[[^[\\]]*?\\]\\((?:\\\\.|[^\\\\\\(\\)]|\\((?:\\\\.|[^\\\\\\(\\)])*\\))*\\)|`[^`]*?`|<[^<>]*?>/g;\r\nvar emStrongLDelimCore = /^(?:\\*+(?:((?!\\*)punct)|[^\\s*]))|^_+(?:((?!_)punct)|([^\\s_]))/;\r\nvar emStrongLDelim = edit(emStrongLDelimCore, \"u\").replace(/punct/g, _punctuation).getRegex();\r\nvar emStrongLDelimGfm = edit(emStrongLDelimCore, \"u\").replace(/punct/g, _punctuationGfmStrongEm).getRegex();\r\nvar emStrongRDelimAstCore = \"^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\\\*)punct(\\\\*+)(?=[\\\\s]|$)|notPunctSpace(\\\\*+)(?!\\\\*)(?=punctSpace|$)|(?!\\\\*)punctSpace(\\\\*+)(?=notPunctSpace)|[\\\\s](\\\\*+)(?!\\\\*)(?=punct)|(?!\\\\*)punct(\\\\*+)(?!\\\\*)(?=punct)|notPunctSpace(\\\\*+)(?=notPunctSpace)\";\r\nvar emStrongRDelimAst = edit(emStrongRDelimAstCore, \"gu\").replace(/notPunctSpace/g, _notPunctuationOrSpace).replace(/punctSpace/g, _punctuationOrSpace).replace(/punct/g, _punctuation).getRegex();\r\nvar emStrongRDelimAstGfm = edit(emStrongRDelimAstCore, \"gu\").replace(/notPunctSpace/g, _notPunctuationOrSpaceGfmStrongEm).replace(/punctSpace/g, _punctuationOrSpaceGfmStrongEm).replace(/punct/g, _punctuationGfmStrongEm).getRegex();\r\nvar emStrongRDelimUnd = edit(\r\n  \"^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)\",\r\n  \"gu\"\r\n).replace(/notPunctSpace/g, _notPunctuationOrSpace).replace(/punctSpace/g, _punctuationOrSpace).replace(/punct/g, _punctuation).getRegex();\r\nvar anyPunctuation = edit(/\\\\(punct)/, \"gu\").replace(/punct/g, _punctuation).getRegex();\r\nvar autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/).replace(\"scheme\", /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace(\"email\", /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex();\r\nvar _inlineComment = edit(_comment).replace(\"(?:-->|$)\", \"-->\").getRegex();\r\nvar tag = edit(\r\n  \"^comment|^</[a-zA-Z][\\\\w:-]*\\\\s*>|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>|^<\\\\?[\\\\s\\\\S]*?\\\\?>|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\"\r\n).replace(\"comment\", _inlineComment).replace(\"attribute\", /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/).getRegex();\r\nvar _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\r\nvar link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:(?:[ \\t]*(?:\\n[ \\t]*)?)(title))?\\s*\\)/).replace(\"label\", _inlineLabel).replace(\"href\", /<(?:\\\\.|[^\\n<>\\\\])+>|[^ \\t\\n\\x00-\\x1f]*/).replace(\"title\", /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/).getRegex();\r\nvar reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/).replace(\"label\", _inlineLabel).replace(\"ref\", _blockLabel).getRegex();\r\nvar nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/).replace(\"ref\", _blockLabel).getRegex();\r\nvar reflinkSearch = edit(\"reflink|nolink(?!\\\\()\", \"g\").replace(\"reflink\", reflink).replace(\"nolink\", nolink).getRegex();\r\nvar inlineNormal = {\r\n  _backpedal: noopTest,\r\n  // only used for GFM url\r\n  anyPunctuation,\r\n  autolink,\r\n  blockSkip,\r\n  br,\r\n  code: inlineCode,\r\n  del: noopTest,\r\n  emStrongLDelim,\r\n  emStrongRDelimAst,\r\n  emStrongRDelimUnd,\r\n  escape,\r\n  link,\r\n  nolink,\r\n  punctuation,\r\n  reflink,\r\n  reflinkSearch,\r\n  tag,\r\n  text: inlineText,\r\n  url: noopTest\r\n};\r\nvar inlinePedantic = {\r\n  ...inlineNormal,\r\n  link: edit(/^!?\\[(label)\\]\\((.*?)\\)/).replace(\"label\", _inlineLabel).getRegex(),\r\n  reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace(\"label\", _inlineLabel).getRegex()\r\n};\r\nvar inlineGfm = {\r\n  ...inlineNormal,\r\n  emStrongRDelimAst: emStrongRDelimAstGfm,\r\n  emStrongLDelim: emStrongLDelimGfm,\r\n  url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, \"i\").replace(\"email\", /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),\r\n  _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\r\n  del: /^(~~?)(?=[^\\s~])((?:\\\\.|[^\\\\])*?(?:\\\\.|[^\\s~\\\\]))\\1(?=[^~]|$)/,\r\n  text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\r\n};\r\nvar inlineBreaks = {\r\n  ...inlineGfm,\r\n  br: edit(br).replace(\"{2,}\", \"*\").getRegex(),\r\n  text: edit(inlineGfm.text).replace(\"\\\\b_\", \"\\\\b_| {2,}\\\\n\").replace(/\\{2,\\}/g, \"*\").getRegex()\r\n};\r\nvar block = {\r\n  normal: blockNormal,\r\n  gfm: blockGfm,\r\n  pedantic: blockPedantic\r\n};\r\nvar inline = {\r\n  normal: inlineNormal,\r\n  gfm: inlineGfm,\r\n  breaks: inlineBreaks,\r\n  pedantic: inlinePedantic\r\n};\r\n\r\n// src/helpers.ts\r\nvar escapeReplacements = {\r\n  \"&\": \"&amp;\",\r\n  \"<\": \"&lt;\",\r\n  \">\": \"&gt;\",\r\n  '\"': \"&quot;\",\r\n  \"'\": \"&#39;\"\r\n};\r\nvar getEscapeReplacement = (ch) => escapeReplacements[ch];\r\nfunction escape2(html2, encode) {\r\n  if (encode) {\r\n    if (other.escapeTest.test(html2)) {\r\n      return html2.replace(other.escapeReplace, getEscapeReplacement);\r\n    }\r\n  } else {\r\n    if (other.escapeTestNoEncode.test(html2)) {\r\n      return html2.replace(other.escapeReplaceNoEncode, getEscapeReplacement);\r\n    }\r\n  }\r\n  return html2;\r\n}\r\nfunction cleanUrl(href) {\r\n  try {\r\n    href = encodeURI(href).replace(other.percentDecode, \"%\");\r\n  } catch {\r\n    return null;\r\n  }\r\n  return href;\r\n}\r\nfunction splitCells(tableRow, count) {\r\n  const row = tableRow.replace(other.findPipe, (match, offset, str) => {\r\n    let escaped = false;\r\n    let curr = offset;\r\n    while (--curr >= 0 && str[curr] === \"\\\\\") escaped = !escaped;\r\n    if (escaped) {\r\n      return \"|\";\r\n    } else {\r\n      return \" |\";\r\n    }\r\n  }), cells = row.split(other.splitPipe);\r\n  let i = 0;\r\n  if (!cells[0].trim()) {\r\n    cells.shift();\r\n  }\r\n  if (cells.length > 0 && !cells.at(-1)?.trim()) {\r\n    cells.pop();\r\n  }\r\n  if (count) {\r\n    if (cells.length > count) {\r\n      cells.splice(count);\r\n    } else {\r\n      while (cells.length < count) cells.push(\"\");\r\n    }\r\n  }\r\n  for (; i < cells.length; i++) {\r\n    cells[i] = cells[i].trim().replace(other.slashPipe, \"|\");\r\n  }\r\n  return cells;\r\n}\r\nfunction rtrim(str, c, invert) {\r\n  const l = str.length;\r\n  if (l === 0) {\r\n    return \"\";\r\n  }\r\n  let suffLen = 0;\r\n  while (suffLen < l) {\r\n    const currChar = str.charAt(l - suffLen - 1);\r\n    if (currChar === c && !invert) {\r\n      suffLen++;\r\n    } else if (currChar !== c && invert) {\r\n      suffLen++;\r\n    } else {\r\n      break;\r\n    }\r\n  }\r\n  return str.slice(0, l - suffLen);\r\n}\r\nfunction findClosingBracket(str, b) {\r\n  if (str.indexOf(b[1]) === -1) {\r\n    return -1;\r\n  }\r\n  let level = 0;\r\n  for (let i = 0; i < str.length; i++) {\r\n    if (str[i] === \"\\\\\") {\r\n      i++;\r\n    } else if (str[i] === b[0]) {\r\n      level++;\r\n    } else if (str[i] === b[1]) {\r\n      level--;\r\n      if (level < 0) {\r\n        return i;\r\n      }\r\n    }\r\n  }\r\n  if (level > 0) {\r\n    return -2;\r\n  }\r\n  return -1;\r\n}\r\n\r\n// src/Tokenizer.ts\r\nfunction outputLink(cap, link2, raw, lexer2, rules) {\r\n  const href = link2.href;\r\n  const title = link2.title || null;\r\n  const text = cap[1].replace(rules.other.outputLinkReplace, \"$1\");\r\n  lexer2.state.inLink = true;\r\n  const token = {\r\n    type: cap[0].charAt(0) === \"!\" ? \"image\" : \"link\",\r\n    raw,\r\n    href,\r\n    title,\r\n    text,\r\n    tokens: lexer2.inlineTokens(text)\r\n  };\r\n  lexer2.state.inLink = false;\r\n  return token;\r\n}\r\nfunction indentCodeCompensation(raw, text, rules) {\r\n  const matchIndentToCode = raw.match(rules.other.indentCodeCompensation);\r\n  if (matchIndentToCode === null) {\r\n    return text;\r\n  }\r\n  const indentToCode = matchIndentToCode[1];\r\n  return text.split(\"\\n\").map((node) => {\r\n    const matchIndentInNode = node.match(rules.other.beginningSpace);\r\n    if (matchIndentInNode === null) {\r\n      return node;\r\n    }\r\n    const [indentInNode] = matchIndentInNode;\r\n    if (indentInNode.length >= indentToCode.length) {\r\n      return node.slice(indentToCode.length);\r\n    }\r\n    return node;\r\n  }).join(\"\\n\");\r\n}\r\nvar _Tokenizer = class {\r\n  options;\r\n  rules;\r\n  // set by the lexer\r\n  lexer;\r\n  // set by the lexer\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  space(src) {\r\n    const cap = this.rules.block.newline.exec(src);\r\n    if (cap && cap[0].length > 0) {\r\n      return {\r\n        type: \"space\",\r\n        raw: cap[0]\r\n      };\r\n    }\r\n  }\r\n  code(src) {\r\n    const cap = this.rules.block.code.exec(src);\r\n    if (cap) {\r\n      const text = cap[0].replace(this.rules.other.codeRemoveIndent, \"\");\r\n      return {\r\n        type: \"code\",\r\n        raw: cap[0],\r\n        codeBlockStyle: \"indented\",\r\n        text: !this.options.pedantic ? rtrim(text, \"\\n\") : text\r\n      };\r\n    }\r\n  }\r\n  fences(src) {\r\n    const cap = this.rules.block.fences.exec(src);\r\n    if (cap) {\r\n      const raw = cap[0];\r\n      const text = indentCodeCompensation(raw, cap[3] || \"\", this.rules);\r\n      return {\r\n        type: \"code\",\r\n        raw,\r\n        lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, \"$1\") : cap[2],\r\n        text\r\n      };\r\n    }\r\n  }\r\n  heading(src) {\r\n    const cap = this.rules.block.heading.exec(src);\r\n    if (cap) {\r\n      let text = cap[2].trim();\r\n      if (this.rules.other.endingHash.test(text)) {\r\n        const trimmed = rtrim(text, \"#\");\r\n        if (this.options.pedantic) {\r\n          text = trimmed.trim();\r\n        } else if (!trimmed || this.rules.other.endingSpaceChar.test(trimmed)) {\r\n          text = trimmed.trim();\r\n        }\r\n      }\r\n      return {\r\n        type: \"heading\",\r\n        raw: cap[0],\r\n        depth: cap[1].length,\r\n        text,\r\n        tokens: this.lexer.inline(text)\r\n      };\r\n    }\r\n  }\r\n  hr(src) {\r\n    const cap = this.rules.block.hr.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"hr\",\r\n        raw: rtrim(cap[0], \"\\n\")\r\n      };\r\n    }\r\n  }\r\n  blockquote(src) {\r\n    const cap = this.rules.block.blockquote.exec(src);\r\n    if (cap) {\r\n      let lines = rtrim(cap[0], \"\\n\").split(\"\\n\");\r\n      let raw = \"\";\r\n      let text = \"\";\r\n      const tokens = [];\r\n      while (lines.length > 0) {\r\n        let inBlockquote = false;\r\n        const currentLines = [];\r\n        let i;\r\n        for (i = 0; i < lines.length; i++) {\r\n          if (this.rules.other.blockquoteStart.test(lines[i])) {\r\n            currentLines.push(lines[i]);\r\n            inBlockquote = true;\r\n          } else if (!inBlockquote) {\r\n            currentLines.push(lines[i]);\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n        lines = lines.slice(i);\r\n        const currentRaw = currentLines.join(\"\\n\");\r\n        const currentText = currentRaw.replace(this.rules.other.blockquoteSetextReplace, \"\\n    $1\").replace(this.rules.other.blockquoteSetextReplace2, \"\");\r\n        raw = raw ? `${raw}\r\n${currentRaw}` : currentRaw;\r\n        text = text ? `${text}\r\n${currentText}` : currentText;\r\n        const top = this.lexer.state.top;\r\n        this.lexer.state.top = true;\r\n        this.lexer.blockTokens(currentText, tokens, true);\r\n        this.lexer.state.top = top;\r\n        if (lines.length === 0) {\r\n          break;\r\n        }\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"code\") {\r\n          break;\r\n        } else if (lastToken?.type === \"blockquote\") {\r\n          const oldToken = lastToken;\r\n          const newText = oldToken.raw + \"\\n\" + lines.join(\"\\n\");\r\n          const newToken = this.blockquote(newText);\r\n          tokens[tokens.length - 1] = newToken;\r\n          raw = raw.substring(0, raw.length - oldToken.raw.length) + newToken.raw;\r\n          text = text.substring(0, text.length - oldToken.text.length) + newToken.text;\r\n          break;\r\n        } else if (lastToken?.type === \"list\") {\r\n          const oldToken = lastToken;\r\n          const newText = oldToken.raw + \"\\n\" + lines.join(\"\\n\");\r\n          const newToken = this.list(newText);\r\n          tokens[tokens.length - 1] = newToken;\r\n          raw = raw.substring(0, raw.length - lastToken.raw.length) + newToken.raw;\r\n          text = text.substring(0, text.length - oldToken.raw.length) + newToken.raw;\r\n          lines = newText.substring(tokens.at(-1).raw.length).split(\"\\n\");\r\n          continue;\r\n        }\r\n      }\r\n      return {\r\n        type: \"blockquote\",\r\n        raw,\r\n        tokens,\r\n        text\r\n      };\r\n    }\r\n  }\r\n  list(src) {\r\n    let cap = this.rules.block.list.exec(src);\r\n    if (cap) {\r\n      let bull = cap[1].trim();\r\n      const isordered = bull.length > 1;\r\n      const list2 = {\r\n        type: \"list\",\r\n        raw: \"\",\r\n        ordered: isordered,\r\n        start: isordered ? +bull.slice(0, -1) : \"\",\r\n        loose: false,\r\n        items: []\r\n      };\r\n      bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\r\n      if (this.options.pedantic) {\r\n        bull = isordered ? bull : \"[*+-]\";\r\n      }\r\n      const itemRegex = this.rules.other.listItemRegex(bull);\r\n      let endsWithBlankLine = false;\r\n      while (src) {\r\n        let endEarly = false;\r\n        let raw = \"\";\r\n        let itemContents = \"\";\r\n        if (!(cap = itemRegex.exec(src))) {\r\n          break;\r\n        }\r\n        if (this.rules.block.hr.test(src)) {\r\n          break;\r\n        }\r\n        raw = cap[0];\r\n        src = src.substring(raw.length);\r\n        let line = cap[2].split(\"\\n\", 1)[0].replace(this.rules.other.listReplaceTabs, (t) => \" \".repeat(3 * t.length));\r\n        let nextLine = src.split(\"\\n\", 1)[0];\r\n        let blankLine = !line.trim();\r\n        let indent = 0;\r\n        if (this.options.pedantic) {\r\n          indent = 2;\r\n          itemContents = line.trimStart();\r\n        } else if (blankLine) {\r\n          indent = cap[1].length + 1;\r\n        } else {\r\n          indent = cap[2].search(this.rules.other.nonSpaceChar);\r\n          indent = indent > 4 ? 1 : indent;\r\n          itemContents = line.slice(indent);\r\n          indent += cap[1].length;\r\n        }\r\n        if (blankLine && this.rules.other.blankLine.test(nextLine)) {\r\n          raw += nextLine + \"\\n\";\r\n          src = src.substring(nextLine.length + 1);\r\n          endEarly = true;\r\n        }\r\n        if (!endEarly) {\r\n          const nextBulletRegex = this.rules.other.nextBulletRegex(indent);\r\n          const hrRegex = this.rules.other.hrRegex(indent);\r\n          const fencesBeginRegex = this.rules.other.fencesBeginRegex(indent);\r\n          const headingBeginRegex = this.rules.other.headingBeginRegex(indent);\r\n          const htmlBeginRegex = this.rules.other.htmlBeginRegex(indent);\r\n          while (src) {\r\n            const rawLine = src.split(\"\\n\", 1)[0];\r\n            let nextLineWithoutTabs;\r\n            nextLine = rawLine;\r\n            if (this.options.pedantic) {\r\n              nextLine = nextLine.replace(this.rules.other.listReplaceNesting, \"  \");\r\n              nextLineWithoutTabs = nextLine;\r\n            } else {\r\n              nextLineWithoutTabs = nextLine.replace(this.rules.other.tabCharGlobal, \"    \");\r\n            }\r\n            if (fencesBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (headingBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (htmlBeginRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (nextBulletRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (hrRegex.test(nextLine)) {\r\n              break;\r\n            }\r\n            if (nextLineWithoutTabs.search(this.rules.other.nonSpaceChar) >= indent || !nextLine.trim()) {\r\n              itemContents += \"\\n\" + nextLineWithoutTabs.slice(indent);\r\n            } else {\r\n              if (blankLine) {\r\n                break;\r\n              }\r\n              if (line.replace(this.rules.other.tabCharGlobal, \"    \").search(this.rules.other.nonSpaceChar) >= 4) {\r\n                break;\r\n              }\r\n              if (fencesBeginRegex.test(line)) {\r\n                break;\r\n              }\r\n              if (headingBeginRegex.test(line)) {\r\n                break;\r\n              }\r\n              if (hrRegex.test(line)) {\r\n                break;\r\n              }\r\n              itemContents += \"\\n\" + nextLine;\r\n            }\r\n            if (!blankLine && !nextLine.trim()) {\r\n              blankLine = true;\r\n            }\r\n            raw += rawLine + \"\\n\";\r\n            src = src.substring(rawLine.length + 1);\r\n            line = nextLineWithoutTabs.slice(indent);\r\n          }\r\n        }\r\n        if (!list2.loose) {\r\n          if (endsWithBlankLine) {\r\n            list2.loose = true;\r\n          } else if (this.rules.other.doubleBlankLine.test(raw)) {\r\n            endsWithBlankLine = true;\r\n          }\r\n        }\r\n        let istask = null;\r\n        let ischecked;\r\n        if (this.options.gfm) {\r\n          istask = this.rules.other.listIsTask.exec(itemContents);\r\n          if (istask) {\r\n            ischecked = istask[0] !== \"[ ] \";\r\n            itemContents = itemContents.replace(this.rules.other.listReplaceTask, \"\");\r\n          }\r\n        }\r\n        list2.items.push({\r\n          type: \"list_item\",\r\n          raw,\r\n          task: !!istask,\r\n          checked: ischecked,\r\n          loose: false,\r\n          text: itemContents,\r\n          tokens: []\r\n        });\r\n        list2.raw += raw;\r\n      }\r\n      const lastItem = list2.items.at(-1);\r\n      if (lastItem) {\r\n        lastItem.raw = lastItem.raw.trimEnd();\r\n        lastItem.text = lastItem.text.trimEnd();\r\n      } else {\r\n        return;\r\n      }\r\n      list2.raw = list2.raw.trimEnd();\r\n      for (let i = 0; i < list2.items.length; i++) {\r\n        this.lexer.state.top = false;\r\n        list2.items[i].tokens = this.lexer.blockTokens(list2.items[i].text, []);\r\n        if (!list2.loose) {\r\n          const spacers = list2.items[i].tokens.filter((t) => t.type === \"space\");\r\n          const hasMultipleLineBreaks = spacers.length > 0 && spacers.some((t) => this.rules.other.anyLine.test(t.raw));\r\n          list2.loose = hasMultipleLineBreaks;\r\n        }\r\n      }\r\n      if (list2.loose) {\r\n        for (let i = 0; i < list2.items.length; i++) {\r\n          list2.items[i].loose = true;\r\n        }\r\n      }\r\n      return list2;\r\n    }\r\n  }\r\n  html(src) {\r\n    const cap = this.rules.block.html.exec(src);\r\n    if (cap) {\r\n      const token = {\r\n        type: \"html\",\r\n        block: true,\r\n        raw: cap[0],\r\n        pre: cap[1] === \"pre\" || cap[1] === \"script\" || cap[1] === \"style\",\r\n        text: cap[0]\r\n      };\r\n      return token;\r\n    }\r\n  }\r\n  def(src) {\r\n    const cap = this.rules.block.def.exec(src);\r\n    if (cap) {\r\n      const tag2 = cap[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal, \" \");\r\n      const href = cap[2] ? cap[2].replace(this.rules.other.hrefBrackets, \"$1\").replace(this.rules.inline.anyPunctuation, \"$1\") : \"\";\r\n      const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, \"$1\") : cap[3];\r\n      return {\r\n        type: \"def\",\r\n        tag: tag2,\r\n        raw: cap[0],\r\n        href,\r\n        title\r\n      };\r\n    }\r\n  }\r\n  table(src) {\r\n    const cap = this.rules.block.table.exec(src);\r\n    if (!cap) {\r\n      return;\r\n    }\r\n    if (!this.rules.other.tableDelimiter.test(cap[2])) {\r\n      return;\r\n    }\r\n    const headers = splitCells(cap[1]);\r\n    const aligns = cap[2].replace(this.rules.other.tableAlignChars, \"\").split(\"|\");\r\n    const rows = cap[3]?.trim() ? cap[3].replace(this.rules.other.tableRowBlankLine, \"\").split(\"\\n\") : [];\r\n    const item = {\r\n      type: \"table\",\r\n      raw: cap[0],\r\n      header: [],\r\n      align: [],\r\n      rows: []\r\n    };\r\n    if (headers.length !== aligns.length) {\r\n      return;\r\n    }\r\n    for (const align of aligns) {\r\n      if (this.rules.other.tableAlignRight.test(align)) {\r\n        item.align.push(\"right\");\r\n      } else if (this.rules.other.tableAlignCenter.test(align)) {\r\n        item.align.push(\"center\");\r\n      } else if (this.rules.other.tableAlignLeft.test(align)) {\r\n        item.align.push(\"left\");\r\n      } else {\r\n        item.align.push(null);\r\n      }\r\n    }\r\n    for (let i = 0; i < headers.length; i++) {\r\n      item.header.push({\r\n        text: headers[i],\r\n        tokens: this.lexer.inline(headers[i]),\r\n        header: true,\r\n        align: item.align[i]\r\n      });\r\n    }\r\n    for (const row of rows) {\r\n      item.rows.push(splitCells(row, item.header.length).map((cell, i) => {\r\n        return {\r\n          text: cell,\r\n          tokens: this.lexer.inline(cell),\r\n          header: false,\r\n          align: item.align[i]\r\n        };\r\n      }));\r\n    }\r\n    return item;\r\n  }\r\n  lheading(src) {\r\n    const cap = this.rules.block.lheading.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"heading\",\r\n        raw: cap[0],\r\n        depth: cap[2].charAt(0) === \"=\" ? 1 : 2,\r\n        text: cap[1],\r\n        tokens: this.lexer.inline(cap[1])\r\n      };\r\n    }\r\n  }\r\n  paragraph(src) {\r\n    const cap = this.rules.block.paragraph.exec(src);\r\n    if (cap) {\r\n      const text = cap[1].charAt(cap[1].length - 1) === \"\\n\" ? cap[1].slice(0, -1) : cap[1];\r\n      return {\r\n        type: \"paragraph\",\r\n        raw: cap[0],\r\n        text,\r\n        tokens: this.lexer.inline(text)\r\n      };\r\n    }\r\n  }\r\n  text(src) {\r\n    const cap = this.rules.block.text.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"text\",\r\n        raw: cap[0],\r\n        text: cap[0],\r\n        tokens: this.lexer.inline(cap[0])\r\n      };\r\n    }\r\n  }\r\n  escape(src) {\r\n    const cap = this.rules.inline.escape.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"escape\",\r\n        raw: cap[0],\r\n        text: cap[1]\r\n      };\r\n    }\r\n  }\r\n  tag(src) {\r\n    const cap = this.rules.inline.tag.exec(src);\r\n    if (cap) {\r\n      if (!this.lexer.state.inLink && this.rules.other.startATag.test(cap[0])) {\r\n        this.lexer.state.inLink = true;\r\n      } else if (this.lexer.state.inLink && this.rules.other.endATag.test(cap[0])) {\r\n        this.lexer.state.inLink = false;\r\n      }\r\n      if (!this.lexer.state.inRawBlock && this.rules.other.startPreScriptTag.test(cap[0])) {\r\n        this.lexer.state.inRawBlock = true;\r\n      } else if (this.lexer.state.inRawBlock && this.rules.other.endPreScriptTag.test(cap[0])) {\r\n        this.lexer.state.inRawBlock = false;\r\n      }\r\n      return {\r\n        type: \"html\",\r\n        raw: cap[0],\r\n        inLink: this.lexer.state.inLink,\r\n        inRawBlock: this.lexer.state.inRawBlock,\r\n        block: false,\r\n        text: cap[0]\r\n      };\r\n    }\r\n  }\r\n  link(src) {\r\n    const cap = this.rules.inline.link.exec(src);\r\n    if (cap) {\r\n      const trimmedUrl = cap[2].trim();\r\n      if (!this.options.pedantic && this.rules.other.startAngleBracket.test(trimmedUrl)) {\r\n        if (!this.rules.other.endAngleBracket.test(trimmedUrl)) {\r\n          return;\r\n        }\r\n        const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), \"\\\\\");\r\n        if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\r\n          return;\r\n        }\r\n      } else {\r\n        const lastParenIndex = findClosingBracket(cap[2], \"()\");\r\n        if (lastParenIndex === -2) {\r\n          return;\r\n        }\r\n        if (lastParenIndex > -1) {\r\n          const start = cap[0].indexOf(\"!\") === 0 ? 5 : 4;\r\n          const linkLen = start + cap[1].length + lastParenIndex;\r\n          cap[2] = cap[2].substring(0, lastParenIndex);\r\n          cap[0] = cap[0].substring(0, linkLen).trim();\r\n          cap[3] = \"\";\r\n        }\r\n      }\r\n      let href = cap[2];\r\n      let title = \"\";\r\n      if (this.options.pedantic) {\r\n        const link2 = this.rules.other.pedanticHrefTitle.exec(href);\r\n        if (link2) {\r\n          href = link2[1];\r\n          title = link2[3];\r\n        }\r\n      } else {\r\n        title = cap[3] ? cap[3].slice(1, -1) : \"\";\r\n      }\r\n      href = href.trim();\r\n      if (this.rules.other.startAngleBracket.test(href)) {\r\n        if (this.options.pedantic && !this.rules.other.endAngleBracket.test(trimmedUrl)) {\r\n          href = href.slice(1);\r\n        } else {\r\n          href = href.slice(1, -1);\r\n        }\r\n      }\r\n      return outputLink(cap, {\r\n        href: href ? href.replace(this.rules.inline.anyPunctuation, \"$1\") : href,\r\n        title: title ? title.replace(this.rules.inline.anyPunctuation, \"$1\") : title\r\n      }, cap[0], this.lexer, this.rules);\r\n    }\r\n  }\r\n  reflink(src, links) {\r\n    let cap;\r\n    if ((cap = this.rules.inline.reflink.exec(src)) || (cap = this.rules.inline.nolink.exec(src))) {\r\n      const linkString = (cap[2] || cap[1]).replace(this.rules.other.multipleSpaceGlobal, \" \");\r\n      const link2 = links[linkString.toLowerCase()];\r\n      if (!link2) {\r\n        const text = cap[0].charAt(0);\r\n        return {\r\n          type: \"text\",\r\n          raw: text,\r\n          text\r\n        };\r\n      }\r\n      return outputLink(cap, link2, cap[0], this.lexer, this.rules);\r\n    }\r\n  }\r\n  emStrong(src, maskedSrc, prevChar = \"\") {\r\n    let match = this.rules.inline.emStrongLDelim.exec(src);\r\n    if (!match) return;\r\n    if (match[3] && prevChar.match(this.rules.other.unicodeAlphaNumeric)) return;\r\n    const nextChar = match[1] || match[2] || \"\";\r\n    if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\r\n      const lLength = [...match[0]].length - 1;\r\n      let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\r\n      const endReg = match[0][0] === \"*\" ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\r\n      endReg.lastIndex = 0;\r\n      maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\r\n      while ((match = endReg.exec(maskedSrc)) != null) {\r\n        rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\r\n        if (!rDelim) continue;\r\n        rLength = [...rDelim].length;\r\n        if (match[3] || match[4]) {\r\n          delimTotal += rLength;\r\n          continue;\r\n        } else if (match[5] || match[6]) {\r\n          if (lLength % 3 && !((lLength + rLength) % 3)) {\r\n            midDelimTotal += rLength;\r\n            continue;\r\n          }\r\n        }\r\n        delimTotal -= rLength;\r\n        if (delimTotal > 0) continue;\r\n        rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\r\n        const lastCharLength = [...match[0]][0].length;\r\n        const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\r\n        if (Math.min(lLength, rLength) % 2) {\r\n          const text2 = raw.slice(1, -1);\r\n          return {\r\n            type: \"em\",\r\n            raw,\r\n            text: text2,\r\n            tokens: this.lexer.inlineTokens(text2)\r\n          };\r\n        }\r\n        const text = raw.slice(2, -2);\r\n        return {\r\n          type: \"strong\",\r\n          raw,\r\n          text,\r\n          tokens: this.lexer.inlineTokens(text)\r\n        };\r\n      }\r\n    }\r\n  }\r\n  codespan(src) {\r\n    const cap = this.rules.inline.code.exec(src);\r\n    if (cap) {\r\n      let text = cap[2].replace(this.rules.other.newLineCharGlobal, \" \");\r\n      const hasNonSpaceChars = this.rules.other.nonSpaceChar.test(text);\r\n      const hasSpaceCharsOnBothEnds = this.rules.other.startingSpaceChar.test(text) && this.rules.other.endingSpaceChar.test(text);\r\n      if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\r\n        text = text.substring(1, text.length - 1);\r\n      }\r\n      return {\r\n        type: \"codespan\",\r\n        raw: cap[0],\r\n        text\r\n      };\r\n    }\r\n  }\r\n  br(src) {\r\n    const cap = this.rules.inline.br.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"br\",\r\n        raw: cap[0]\r\n      };\r\n    }\r\n  }\r\n  del(src) {\r\n    const cap = this.rules.inline.del.exec(src);\r\n    if (cap) {\r\n      return {\r\n        type: \"del\",\r\n        raw: cap[0],\r\n        text: cap[2],\r\n        tokens: this.lexer.inlineTokens(cap[2])\r\n      };\r\n    }\r\n  }\r\n  autolink(src) {\r\n    const cap = this.rules.inline.autolink.exec(src);\r\n    if (cap) {\r\n      let text, href;\r\n      if (cap[2] === \"@\") {\r\n        text = cap[1];\r\n        href = \"mailto:\" + text;\r\n      } else {\r\n        text = cap[1];\r\n        href = text;\r\n      }\r\n      return {\r\n        type: \"link\",\r\n        raw: cap[0],\r\n        text,\r\n        href,\r\n        tokens: [\r\n          {\r\n            type: \"text\",\r\n            raw: text,\r\n            text\r\n          }\r\n        ]\r\n      };\r\n    }\r\n  }\r\n  url(src) {\r\n    let cap;\r\n    if (cap = this.rules.inline.url.exec(src)) {\r\n      let text, href;\r\n      if (cap[2] === \"@\") {\r\n        text = cap[0];\r\n        href = \"mailto:\" + text;\r\n      } else {\r\n        let prevCapZero;\r\n        do {\r\n          prevCapZero = cap[0];\r\n          cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? \"\";\r\n        } while (prevCapZero !== cap[0]);\r\n        text = cap[0];\r\n        if (cap[1] === \"www.\") {\r\n          href = \"http://\" + cap[0];\r\n        } else {\r\n          href = cap[0];\r\n        }\r\n      }\r\n      return {\r\n        type: \"link\",\r\n        raw: cap[0],\r\n        text,\r\n        href,\r\n        tokens: [\r\n          {\r\n            type: \"text\",\r\n            raw: text,\r\n            text\r\n          }\r\n        ]\r\n      };\r\n    }\r\n  }\r\n  inlineText(src) {\r\n    const cap = this.rules.inline.text.exec(src);\r\n    if (cap) {\r\n      const escaped = this.lexer.state.inRawBlock;\r\n      return {\r\n        type: \"text\",\r\n        raw: cap[0],\r\n        text: cap[0],\r\n        escaped\r\n      };\r\n    }\r\n  }\r\n};\r\n\r\n// src/Lexer.ts\r\nvar _Lexer = class __Lexer {\r\n  tokens;\r\n  options;\r\n  state;\r\n  tokenizer;\r\n  inlineQueue;\r\n  constructor(options2) {\r\n    this.tokens = [];\r\n    this.tokens.links = /* @__PURE__ */ Object.create(null);\r\n    this.options = options2 || _defaults;\r\n    this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\r\n    this.tokenizer = this.options.tokenizer;\r\n    this.tokenizer.options = this.options;\r\n    this.tokenizer.lexer = this;\r\n    this.inlineQueue = [];\r\n    this.state = {\r\n      inLink: false,\r\n      inRawBlock: false,\r\n      top: true\r\n    };\r\n    const rules = {\r\n      other,\r\n      block: block.normal,\r\n      inline: inline.normal\r\n    };\r\n    if (this.options.pedantic) {\r\n      rules.block = block.pedantic;\r\n      rules.inline = inline.pedantic;\r\n    } else if (this.options.gfm) {\r\n      rules.block = block.gfm;\r\n      if (this.options.breaks) {\r\n        rules.inline = inline.breaks;\r\n      } else {\r\n        rules.inline = inline.gfm;\r\n      }\r\n    }\r\n    this.tokenizer.rules = rules;\r\n  }\r\n  /**\r\n   * Expose Rules\r\n   */\r\n  static get rules() {\r\n    return {\r\n      block,\r\n      inline\r\n    };\r\n  }\r\n  /**\r\n   * Static Lex Method\r\n   */\r\n  static lex(src, options2) {\r\n    const lexer2 = new __Lexer(options2);\r\n    return lexer2.lex(src);\r\n  }\r\n  /**\r\n   * Static Lex Inline Method\r\n   */\r\n  static lexInline(src, options2) {\r\n    const lexer2 = new __Lexer(options2);\r\n    return lexer2.inlineTokens(src);\r\n  }\r\n  /**\r\n   * Preprocessing\r\n   */\r\n  lex(src) {\r\n    src = src.replace(other.carriageReturn, \"\\n\");\r\n    this.blockTokens(src, this.tokens);\r\n    for (let i = 0; i < this.inlineQueue.length; i++) {\r\n      const next = this.inlineQueue[i];\r\n      this.inlineTokens(next.src, next.tokens);\r\n    }\r\n    this.inlineQueue = [];\r\n    return this.tokens;\r\n  }\r\n  blockTokens(src, tokens = [], lastParagraphClipped = false) {\r\n    if (this.options.pedantic) {\r\n      src = src.replace(other.tabCharGlobal, \"    \").replace(other.spaceLine, \"\");\r\n    }\r\n    while (src) {\r\n      let token;\r\n      if (this.options.extensions?.block?.some((extTokenizer) => {\r\n        if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\r\n          src = src.substring(token.raw.length);\r\n          tokens.push(token);\r\n          return true;\r\n        }\r\n        return false;\r\n      })) {\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.space(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (token.raw.length === 1 && lastToken !== void 0) {\r\n          lastToken.raw += \"\\n\";\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.code(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"paragraph\" || lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.fences(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.heading(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.hr(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.blockquote(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.list(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.html(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.def(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"paragraph\" || lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.raw;\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else if (!this.tokens.links[token.tag]) {\r\n          this.tokens.links[token.tag] = {\r\n            href: token.href,\r\n            title: token.title\r\n          };\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.table(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.lheading(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      let cutSrc = src;\r\n      if (this.options.extensions?.startBlock) {\r\n        let startIndex = Infinity;\r\n        const tempSrc = src.slice(1);\r\n        let tempStart;\r\n        this.options.extensions.startBlock.forEach((getStartIndex) => {\r\n          tempStart = getStartIndex.call({ lexer: this }, tempSrc);\r\n          if (typeof tempStart === \"number\" && tempStart >= 0) {\r\n            startIndex = Math.min(startIndex, tempStart);\r\n          }\r\n        });\r\n        if (startIndex < Infinity && startIndex >= 0) {\r\n          cutSrc = src.substring(0, startIndex + 1);\r\n        }\r\n      }\r\n      if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\r\n        const lastToken = tokens.at(-1);\r\n        if (lastParagraphClipped && lastToken?.type === \"paragraph\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.pop();\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        lastParagraphClipped = cutSrc.length !== src.length;\r\n        src = src.substring(token.raw.length);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.text(src)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"text\") {\r\n          lastToken.raw += \"\\n\" + token.raw;\r\n          lastToken.text += \"\\n\" + token.text;\r\n          this.inlineQueue.pop();\r\n          this.inlineQueue.at(-1).src = lastToken.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (src) {\r\n        const errMsg = \"Infinite loop on byte: \" + src.charCodeAt(0);\r\n        if (this.options.silent) {\r\n          console.error(errMsg);\r\n          break;\r\n        } else {\r\n          throw new Error(errMsg);\r\n        }\r\n      }\r\n    }\r\n    this.state.top = true;\r\n    return tokens;\r\n  }\r\n  inline(src, tokens = []) {\r\n    this.inlineQueue.push({ src, tokens });\r\n    return tokens;\r\n  }\r\n  /**\r\n   * Lexing/Compiling\r\n   */\r\n  inlineTokens(src, tokens = []) {\r\n    let maskedSrc = src;\r\n    let match = null;\r\n    if (this.tokens.links) {\r\n      const links = Object.keys(this.tokens.links);\r\n      if (links.length > 0) {\r\n        while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\r\n          if (links.includes(match[0].slice(match[0].lastIndexOf(\"[\") + 1, -1))) {\r\n            maskedSrc = maskedSrc.slice(0, match.index) + \"[\" + \"a\".repeat(match[0].length - 2) + \"]\" + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\r\n      maskedSrc = maskedSrc.slice(0, match.index) + \"++\" + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\r\n    }\r\n    while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\r\n      maskedSrc = maskedSrc.slice(0, match.index) + \"[\" + \"a\".repeat(match[0].length - 2) + \"]\" + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\r\n    }\r\n    let keepPrevChar = false;\r\n    let prevChar = \"\";\r\n    while (src) {\r\n      if (!keepPrevChar) {\r\n        prevChar = \"\";\r\n      }\r\n      keepPrevChar = false;\r\n      let token;\r\n      if (this.options.extensions?.inline?.some((extTokenizer) => {\r\n        if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\r\n          src = src.substring(token.raw.length);\r\n          tokens.push(token);\r\n          return true;\r\n        }\r\n        return false;\r\n      })) {\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.escape(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.tag(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.link(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.reflink(src, this.tokens.links)) {\r\n        src = src.substring(token.raw.length);\r\n        const lastToken = tokens.at(-1);\r\n        if (token.type === \"text\" && lastToken?.type === \"text\") {\r\n          lastToken.raw += token.raw;\r\n          lastToken.text += token.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.codespan(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.br(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.del(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (token = this.tokenizer.autolink(src)) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      if (!this.state.inLink && (token = this.tokenizer.url(src))) {\r\n        src = src.substring(token.raw.length);\r\n        tokens.push(token);\r\n        continue;\r\n      }\r\n      let cutSrc = src;\r\n      if (this.options.extensions?.startInline) {\r\n        let startIndex = Infinity;\r\n        const tempSrc = src.slice(1);\r\n        let tempStart;\r\n        this.options.extensions.startInline.forEach((getStartIndex) => {\r\n          tempStart = getStartIndex.call({ lexer: this }, tempSrc);\r\n          if (typeof tempStart === \"number\" && tempStart >= 0) {\r\n            startIndex = Math.min(startIndex, tempStart);\r\n          }\r\n        });\r\n        if (startIndex < Infinity && startIndex >= 0) {\r\n          cutSrc = src.substring(0, startIndex + 1);\r\n        }\r\n      }\r\n      if (token = this.tokenizer.inlineText(cutSrc)) {\r\n        src = src.substring(token.raw.length);\r\n        if (token.raw.slice(-1) !== \"_\") {\r\n          prevChar = token.raw.slice(-1);\r\n        }\r\n        keepPrevChar = true;\r\n        const lastToken = tokens.at(-1);\r\n        if (lastToken?.type === \"text\") {\r\n          lastToken.raw += token.raw;\r\n          lastToken.text += token.text;\r\n        } else {\r\n          tokens.push(token);\r\n        }\r\n        continue;\r\n      }\r\n      if (src) {\r\n        const errMsg = \"Infinite loop on byte: \" + src.charCodeAt(0);\r\n        if (this.options.silent) {\r\n          console.error(errMsg);\r\n          break;\r\n        } else {\r\n          throw new Error(errMsg);\r\n        }\r\n      }\r\n    }\r\n    return tokens;\r\n  }\r\n};\r\n\r\n// src/Renderer.ts\r\nvar _Renderer = class {\r\n  options;\r\n  parser;\r\n  // set by the parser\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  space(token) {\r\n    return \"\";\r\n  }\r\n  code({ text, lang, escaped }) {\r\n    const langString = (lang || \"\").match(other.notSpaceStart)?.[0];\r\n    const code = text.replace(other.endingNewline, \"\") + \"\\n\";\r\n    if (!langString) {\r\n      return \"<pre><code>\" + (escaped ? code : escape2(code, true)) + \"</code></pre>\\n\";\r\n    }\r\n    return '<pre><code class=\"language-' + escape2(langString) + '\">' + (escaped ? code : escape2(code, true)) + \"</code></pre>\\n\";\r\n  }\r\n  blockquote({ tokens }) {\r\n    const body = this.parser.parse(tokens);\r\n    return `<blockquote>\r\n${body}</blockquote>\r\n`;\r\n  }\r\n  html({ text }) {\r\n    return text;\r\n  }\r\n  heading({ tokens, depth }) {\r\n    return `<h${depth}>${this.parser.parseInline(tokens)}</h${depth}>\r\n`;\r\n  }\r\n  hr(token) {\r\n    return \"<hr>\\n\";\r\n  }\r\n  list(token) {\r\n    const ordered = token.ordered;\r\n    const start = token.start;\r\n    let body = \"\";\r\n    for (let j = 0; j < token.items.length; j++) {\r\n      const item = token.items[j];\r\n      body += this.listitem(item);\r\n    }\r\n    const type = ordered ? \"ol\" : \"ul\";\r\n    const startAttr = ordered && start !== 1 ? ' start=\"' + start + '\"' : \"\";\r\n    return \"<\" + type + startAttr + \">\\n\" + body + \"</\" + type + \">\\n\";\r\n  }\r\n  listitem(item) {\r\n    let itemBody = \"\";\r\n    if (item.task) {\r\n      const checkbox = this.checkbox({ checked: !!item.checked });\r\n      if (item.loose) {\r\n        if (item.tokens[0]?.type === \"paragraph\") {\r\n          item.tokens[0].text = checkbox + \" \" + item.tokens[0].text;\r\n          if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === \"text\") {\r\n            item.tokens[0].tokens[0].text = checkbox + \" \" + escape2(item.tokens[0].tokens[0].text);\r\n            item.tokens[0].tokens[0].escaped = true;\r\n          }\r\n        } else {\r\n          item.tokens.unshift({\r\n            type: \"text\",\r\n            raw: checkbox + \" \",\r\n            text: checkbox + \" \",\r\n            escaped: true\r\n          });\r\n        }\r\n      } else {\r\n        itemBody += checkbox + \" \";\r\n      }\r\n    }\r\n    itemBody += this.parser.parse(item.tokens, !!item.loose);\r\n    return `<li>${itemBody}</li>\r\n`;\r\n  }\r\n  checkbox({ checked }) {\r\n    return \"<input \" + (checked ? 'checked=\"\" ' : \"\") + 'disabled=\"\" type=\"checkbox\">';\r\n  }\r\n  paragraph({ tokens }) {\r\n    return `<p>${this.parser.parseInline(tokens)}</p>\r\n`;\r\n  }\r\n  table(token) {\r\n    let header = \"\";\r\n    let cell = \"\";\r\n    for (let j = 0; j < token.header.length; j++) {\r\n      cell += this.tablecell(token.header[j]);\r\n    }\r\n    header += this.tablerow({ text: cell });\r\n    let body = \"\";\r\n    for (let j = 0; j < token.rows.length; j++) {\r\n      const row = token.rows[j];\r\n      cell = \"\";\r\n      for (let k = 0; k < row.length; k++) {\r\n        cell += this.tablecell(row[k]);\r\n      }\r\n      body += this.tablerow({ text: cell });\r\n    }\r\n    if (body) body = `<tbody>${body}</tbody>`;\r\n    return \"<table>\\n<thead>\\n\" + header + \"</thead>\\n\" + body + \"</table>\\n\";\r\n  }\r\n  tablerow({ text }) {\r\n    return `<tr>\r\n${text}</tr>\r\n`;\r\n  }\r\n  tablecell(token) {\r\n    const content = this.parser.parseInline(token.tokens);\r\n    const type = token.header ? \"th\" : \"td\";\r\n    const tag2 = token.align ? `<${type} align=\"${token.align}\">` : `<${type}>`;\r\n    return tag2 + content + `</${type}>\r\n`;\r\n  }\r\n  /**\r\n   * span level renderer\r\n   */\r\n  strong({ tokens }) {\r\n    return `<strong>${this.parser.parseInline(tokens)}</strong>`;\r\n  }\r\n  em({ tokens }) {\r\n    return `<em>${this.parser.parseInline(tokens)}</em>`;\r\n  }\r\n  codespan({ text }) {\r\n    return `<code>${escape2(text, true)}</code>`;\r\n  }\r\n  br(token) {\r\n    return \"<br>\";\r\n  }\r\n  del({ tokens }) {\r\n    return `<del>${this.parser.parseInline(tokens)}</del>`;\r\n  }\r\n  link({ href, title, tokens }) {\r\n    const text = this.parser.parseInline(tokens);\r\n    const cleanHref = cleanUrl(href);\r\n    if (cleanHref === null) {\r\n      return text;\r\n    }\r\n    href = cleanHref;\r\n    let out = '<a href=\"' + href + '\"';\r\n    if (title) {\r\n      out += ' title=\"' + escape2(title) + '\"';\r\n    }\r\n    out += \">\" + text + \"</a>\";\r\n    return out;\r\n  }\r\n  image({ href, title, text, tokens }) {\r\n    if (tokens) {\r\n      text = this.parser.parseInline(tokens, this.parser.textRenderer);\r\n    }\r\n    const cleanHref = cleanUrl(href);\r\n    if (cleanHref === null) {\r\n      return escape2(text);\r\n    }\r\n    href = cleanHref;\r\n    let out = `<img src=\"${href}\" alt=\"${text}\"`;\r\n    if (title) {\r\n      out += ` title=\"${escape2(title)}\"`;\r\n    }\r\n    out += \">\";\r\n    return out;\r\n  }\r\n  text(token) {\r\n    return \"tokens\" in token && token.tokens ? this.parser.parseInline(token.tokens) : \"escaped\" in token && token.escaped ? token.text : escape2(token.text);\r\n  }\r\n};\r\n\r\n// src/TextRenderer.ts\r\nvar _TextRenderer = class {\r\n  // no need for block level renderers\r\n  strong({ text }) {\r\n    return text;\r\n  }\r\n  em({ text }) {\r\n    return text;\r\n  }\r\n  codespan({ text }) {\r\n    return text;\r\n  }\r\n  del({ text }) {\r\n    return text;\r\n  }\r\n  html({ text }) {\r\n    return text;\r\n  }\r\n  text({ text }) {\r\n    return text;\r\n  }\r\n  link({ text }) {\r\n    return \"\" + text;\r\n  }\r\n  image({ text }) {\r\n    return \"\" + text;\r\n  }\r\n  br() {\r\n    return \"\";\r\n  }\r\n};\r\n\r\n// src/Parser.ts\r\nvar _Parser = class __Parser {\r\n  options;\r\n  renderer;\r\n  textRenderer;\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n    this.options.renderer = this.options.renderer || new _Renderer();\r\n    this.renderer = this.options.renderer;\r\n    this.renderer.options = this.options;\r\n    this.renderer.parser = this;\r\n    this.textRenderer = new _TextRenderer();\r\n  }\r\n  /**\r\n   * Static Parse Method\r\n   */\r\n  static parse(tokens, options2) {\r\n    const parser2 = new __Parser(options2);\r\n    return parser2.parse(tokens);\r\n  }\r\n  /**\r\n   * Static Parse Inline Method\r\n   */\r\n  static parseInline(tokens, options2) {\r\n    const parser2 = new __Parser(options2);\r\n    return parser2.parseInline(tokens);\r\n  }\r\n  /**\r\n   * Parse Loop\r\n   */\r\n  parse(tokens, top = true) {\r\n    let out = \"\";\r\n    for (let i = 0; i < tokens.length; i++) {\r\n      const anyToken = tokens[i];\r\n      if (this.options.extensions?.renderers?.[anyToken.type]) {\r\n        const genericToken = anyToken;\r\n        const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\r\n        if (ret !== false || ![\"space\", \"hr\", \"heading\", \"code\", \"table\", \"blockquote\", \"list\", \"html\", \"paragraph\", \"text\"].includes(genericToken.type)) {\r\n          out += ret || \"\";\r\n          continue;\r\n        }\r\n      }\r\n      const token = anyToken;\r\n      switch (token.type) {\r\n        case \"space\": {\r\n          out += this.renderer.space(token);\r\n          continue;\r\n        }\r\n        case \"hr\": {\r\n          out += this.renderer.hr(token);\r\n          continue;\r\n        }\r\n        case \"heading\": {\r\n          out += this.renderer.heading(token);\r\n          continue;\r\n        }\r\n        case \"code\": {\r\n          out += this.renderer.code(token);\r\n          continue;\r\n        }\r\n        case \"table\": {\r\n          out += this.renderer.table(token);\r\n          continue;\r\n        }\r\n        case \"blockquote\": {\r\n          out += this.renderer.blockquote(token);\r\n          continue;\r\n        }\r\n        case \"list\": {\r\n          out += this.renderer.list(token);\r\n          continue;\r\n        }\r\n        case \"html\": {\r\n          out += this.renderer.html(token);\r\n          continue;\r\n        }\r\n        case \"paragraph\": {\r\n          out += this.renderer.paragraph(token);\r\n          continue;\r\n        }\r\n        case \"text\": {\r\n          let textToken = token;\r\n          let body = this.renderer.text(textToken);\r\n          while (i + 1 < tokens.length && tokens[i + 1].type === \"text\") {\r\n            textToken = tokens[++i];\r\n            body += \"\\n\" + this.renderer.text(textToken);\r\n          }\r\n          if (top) {\r\n            out += this.renderer.paragraph({\r\n              type: \"paragraph\",\r\n              raw: body,\r\n              text: body,\r\n              tokens: [{ type: \"text\", raw: body, text: body, escaped: true }]\r\n            });\r\n          } else {\r\n            out += body;\r\n          }\r\n          continue;\r\n        }\r\n        default: {\r\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\r\n          if (this.options.silent) {\r\n            console.error(errMsg);\r\n            return \"\";\r\n          } else {\r\n            throw new Error(errMsg);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return out;\r\n  }\r\n  /**\r\n   * Parse Inline Tokens\r\n   */\r\n  parseInline(tokens, renderer = this.renderer) {\r\n    let out = \"\";\r\n    for (let i = 0; i < tokens.length; i++) {\r\n      const anyToken = tokens[i];\r\n      if (this.options.extensions?.renderers?.[anyToken.type]) {\r\n        const ret = this.options.extensions.renderers[anyToken.type].call({ parser: this }, anyToken);\r\n        if (ret !== false || ![\"escape\", \"html\", \"link\", \"image\", \"strong\", \"em\", \"codespan\", \"br\", \"del\", \"text\"].includes(anyToken.type)) {\r\n          out += ret || \"\";\r\n          continue;\r\n        }\r\n      }\r\n      const token = anyToken;\r\n      switch (token.type) {\r\n        case \"escape\": {\r\n          out += renderer.text(token);\r\n          break;\r\n        }\r\n        case \"html\": {\r\n          out += renderer.html(token);\r\n          break;\r\n        }\r\n        case \"link\": {\r\n          out += renderer.link(token);\r\n          break;\r\n        }\r\n        case \"image\": {\r\n          out += renderer.image(token);\r\n          break;\r\n        }\r\n        case \"strong\": {\r\n          out += renderer.strong(token);\r\n          break;\r\n        }\r\n        case \"em\": {\r\n          out += renderer.em(token);\r\n          break;\r\n        }\r\n        case \"codespan\": {\r\n          out += renderer.codespan(token);\r\n          break;\r\n        }\r\n        case \"br\": {\r\n          out += renderer.br(token);\r\n          break;\r\n        }\r\n        case \"del\": {\r\n          out += renderer.del(token);\r\n          break;\r\n        }\r\n        case \"text\": {\r\n          out += renderer.text(token);\r\n          break;\r\n        }\r\n        default: {\r\n          const errMsg = 'Token with \"' + token.type + '\" type was not found.';\r\n          if (this.options.silent) {\r\n            console.error(errMsg);\r\n            return \"\";\r\n          } else {\r\n            throw new Error(errMsg);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return out;\r\n  }\r\n};\r\n\r\n// src/Hooks.ts\r\nvar _Hooks = class {\r\n  options;\r\n  block;\r\n  constructor(options2) {\r\n    this.options = options2 || _defaults;\r\n  }\r\n  static passThroughHooks = /* @__PURE__ */ new Set([\r\n    \"preprocess\",\r\n    \"postprocess\",\r\n    \"processAllTokens\"\r\n  ]);\r\n  /**\r\n   * Process markdown before marked\r\n   */\r\n  preprocess(markdown) {\r\n    return markdown;\r\n  }\r\n  /**\r\n   * Process HTML after marked is finished\r\n   */\r\n  postprocess(html2) {\r\n    return html2;\r\n  }\r\n  /**\r\n   * Process all tokens before walk tokens\r\n   */\r\n  processAllTokens(tokens) {\r\n    return tokens;\r\n  }\r\n  /**\r\n   * Provide function to tokenize markdown\r\n   */\r\n  provideLexer() {\r\n    return this.block ? _Lexer.lex : _Lexer.lexInline;\r\n  }\r\n  /**\r\n   * Provide function to parse tokens\r\n   */\r\n  provideParser() {\r\n    return this.block ? _Parser.parse : _Parser.parseInline;\r\n  }\r\n};\r\n\r\n// src/Instance.ts\r\nvar Marked = class {\r\n  defaults = _getDefaults();\r\n  options = this.setOptions;\r\n  parse = this.parseMarkdown(true);\r\n  parseInline = this.parseMarkdown(false);\r\n  Parser = _Parser;\r\n  Renderer = _Renderer;\r\n  TextRenderer = _TextRenderer;\r\n  Lexer = _Lexer;\r\n  Tokenizer = _Tokenizer;\r\n  Hooks = _Hooks;\r\n  constructor(...args) {\r\n    this.use(...args);\r\n  }\r\n  /**\r\n   * Run callback for every token\r\n   */\r\n  walkTokens(tokens, callback) {\r\n    let values = [];\r\n    for (const token of tokens) {\r\n      values = values.concat(callback.call(this, token));\r\n      switch (token.type) {\r\n        case \"table\": {\r\n          const tableToken = token;\r\n          for (const cell of tableToken.header) {\r\n            values = values.concat(this.walkTokens(cell.tokens, callback));\r\n          }\r\n          for (const row of tableToken.rows) {\r\n            for (const cell of row) {\r\n              values = values.concat(this.walkTokens(cell.tokens, callback));\r\n            }\r\n          }\r\n          break;\r\n        }\r\n        case \"list\": {\r\n          const listToken = token;\r\n          values = values.concat(this.walkTokens(listToken.items, callback));\r\n          break;\r\n        }\r\n        default: {\r\n          const genericToken = token;\r\n          if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\r\n            this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\r\n              const tokens2 = genericToken[childTokens].flat(Infinity);\r\n              values = values.concat(this.walkTokens(tokens2, callback));\r\n            });\r\n          } else if (genericToken.tokens) {\r\n            values = values.concat(this.walkTokens(genericToken.tokens, callback));\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return values;\r\n  }\r\n  use(...args) {\r\n    const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\r\n    args.forEach((pack) => {\r\n      const opts = { ...pack };\r\n      opts.async = this.defaults.async || opts.async || false;\r\n      if (pack.extensions) {\r\n        pack.extensions.forEach((ext) => {\r\n          if (!ext.name) {\r\n            throw new Error(\"extension name required\");\r\n          }\r\n          if (\"renderer\" in ext) {\r\n            const prevRenderer = extensions.renderers[ext.name];\r\n            if (prevRenderer) {\r\n              extensions.renderers[ext.name] = function(...args2) {\r\n                let ret = ext.renderer.apply(this, args2);\r\n                if (ret === false) {\r\n                  ret = prevRenderer.apply(this, args2);\r\n                }\r\n                return ret;\r\n              };\r\n            } else {\r\n              extensions.renderers[ext.name] = ext.renderer;\r\n            }\r\n          }\r\n          if (\"tokenizer\" in ext) {\r\n            if (!ext.level || ext.level !== \"block\" && ext.level !== \"inline\") {\r\n              throw new Error(\"extension level must be 'block' or 'inline'\");\r\n            }\r\n            const extLevel = extensions[ext.level];\r\n            if (extLevel) {\r\n              extLevel.unshift(ext.tokenizer);\r\n            } else {\r\n              extensions[ext.level] = [ext.tokenizer];\r\n            }\r\n            if (ext.start) {\r\n              if (ext.level === \"block\") {\r\n                if (extensions.startBlock) {\r\n                  extensions.startBlock.push(ext.start);\r\n                } else {\r\n                  extensions.startBlock = [ext.start];\r\n                }\r\n              } else if (ext.level === \"inline\") {\r\n                if (extensions.startInline) {\r\n                  extensions.startInline.push(ext.start);\r\n                } else {\r\n                  extensions.startInline = [ext.start];\r\n                }\r\n              }\r\n            }\r\n          }\r\n          if (\"childTokens\" in ext && ext.childTokens) {\r\n            extensions.childTokens[ext.name] = ext.childTokens;\r\n          }\r\n        });\r\n        opts.extensions = extensions;\r\n      }\r\n      if (pack.renderer) {\r\n        const renderer = this.defaults.renderer || new _Renderer(this.defaults);\r\n        for (const prop in pack.renderer) {\r\n          if (!(prop in renderer)) {\r\n            throw new Error(`renderer '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"parser\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const rendererProp = prop;\r\n          const rendererFunc = pack.renderer[rendererProp];\r\n          const prevRenderer = renderer[rendererProp];\r\n          renderer[rendererProp] = (...args2) => {\r\n            let ret = rendererFunc.apply(renderer, args2);\r\n            if (ret === false) {\r\n              ret = prevRenderer.apply(renderer, args2);\r\n            }\r\n            return ret || \"\";\r\n          };\r\n        }\r\n        opts.renderer = renderer;\r\n      }\r\n      if (pack.tokenizer) {\r\n        const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\r\n        for (const prop in pack.tokenizer) {\r\n          if (!(prop in tokenizer)) {\r\n            throw new Error(`tokenizer '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"rules\", \"lexer\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const tokenizerProp = prop;\r\n          const tokenizerFunc = pack.tokenizer[tokenizerProp];\r\n          const prevTokenizer = tokenizer[tokenizerProp];\r\n          tokenizer[tokenizerProp] = (...args2) => {\r\n            let ret = tokenizerFunc.apply(tokenizer, args2);\r\n            if (ret === false) {\r\n              ret = prevTokenizer.apply(tokenizer, args2);\r\n            }\r\n            return ret;\r\n          };\r\n        }\r\n        opts.tokenizer = tokenizer;\r\n      }\r\n      if (pack.hooks) {\r\n        const hooks = this.defaults.hooks || new _Hooks();\r\n        for (const prop in pack.hooks) {\r\n          if (!(prop in hooks)) {\r\n            throw new Error(`hook '${prop}' does not exist`);\r\n          }\r\n          if ([\"options\", \"block\"].includes(prop)) {\r\n            continue;\r\n          }\r\n          const hooksProp = prop;\r\n          const hooksFunc = pack.hooks[hooksProp];\r\n          const prevHook = hooks[hooksProp];\r\n          if (_Hooks.passThroughHooks.has(prop)) {\r\n            hooks[hooksProp] = (arg) => {\r\n              if (this.defaults.async) {\r\n                return Promise.resolve(hooksFunc.call(hooks, arg)).then((ret2) => {\r\n                  return prevHook.call(hooks, ret2);\r\n                });\r\n              }\r\n              const ret = hooksFunc.call(hooks, arg);\r\n              return prevHook.call(hooks, ret);\r\n            };\r\n          } else {\r\n            hooks[hooksProp] = (...args2) => {\r\n              let ret = hooksFunc.apply(hooks, args2);\r\n              if (ret === false) {\r\n                ret = prevHook.apply(hooks, args2);\r\n              }\r\n              return ret;\r\n            };\r\n          }\r\n        }\r\n        opts.hooks = hooks;\r\n      }\r\n      if (pack.walkTokens) {\r\n        const walkTokens2 = this.defaults.walkTokens;\r\n        const packWalktokens = pack.walkTokens;\r\n        opts.walkTokens = function(token) {\r\n          let values = [];\r\n          values.push(packWalktokens.call(this, token));\r\n          if (walkTokens2) {\r\n            values = values.concat(walkTokens2.call(this, token));\r\n          }\r\n          return values;\r\n        };\r\n      }\r\n      this.defaults = { ...this.defaults, ...opts };\r\n    });\r\n    return this;\r\n  }\r\n  setOptions(opt) {\r\n    this.defaults = { ...this.defaults, ...opt };\r\n    return this;\r\n  }\r\n  lexer(src, options2) {\r\n    return _Lexer.lex(src, options2 ?? this.defaults);\r\n  }\r\n  parser(tokens, options2) {\r\n    return _Parser.parse(tokens, options2 ?? this.defaults);\r\n  }\r\n  parseMarkdown(blockType) {\r\n    const parse2 = (src, options2) => {\r\n      const origOpt = { ...options2 };\r\n      const opt = { ...this.defaults, ...origOpt };\r\n      const throwError = this.onError(!!opt.silent, !!opt.async);\r\n      if (this.defaults.async === true && origOpt.async === false) {\r\n        return throwError(new Error(\"marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.\"));\r\n      }\r\n      if (typeof src === \"undefined\" || src === null) {\r\n        return throwError(new Error(\"marked(): input parameter is undefined or null\"));\r\n      }\r\n      if (typeof src !== \"string\") {\r\n        return throwError(new Error(\"marked(): input parameter is of type \" + Object.prototype.toString.call(src) + \", string expected\"));\r\n      }\r\n      if (opt.hooks) {\r\n        opt.hooks.options = opt;\r\n        opt.hooks.block = blockType;\r\n      }\r\n      const lexer2 = opt.hooks ? opt.hooks.provideLexer() : blockType ? _Lexer.lex : _Lexer.lexInline;\r\n      const parser2 = opt.hooks ? opt.hooks.provideParser() : blockType ? _Parser.parse : _Parser.parseInline;\r\n      if (opt.async) {\r\n        return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src).then((src2) => lexer2(src2, opt)).then((tokens) => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens).then((tokens) => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens).then((tokens) => parser2(tokens, opt)).then((html2) => opt.hooks ? opt.hooks.postprocess(html2) : html2).catch(throwError);\r\n      }\r\n      try {\r\n        if (opt.hooks) {\r\n          src = opt.hooks.preprocess(src);\r\n        }\r\n        let tokens = lexer2(src, opt);\r\n        if (opt.hooks) {\r\n          tokens = opt.hooks.processAllTokens(tokens);\r\n        }\r\n        if (opt.walkTokens) {\r\n          this.walkTokens(tokens, opt.walkTokens);\r\n        }\r\n        let html2 = parser2(tokens, opt);\r\n        if (opt.hooks) {\r\n          html2 = opt.hooks.postprocess(html2);\r\n        }\r\n        return html2;\r\n      } catch (e) {\r\n        return throwError(e);\r\n      }\r\n    };\r\n    return parse2;\r\n  }\r\n  onError(silent, async) {\r\n    return (e) => {\r\n      e.message += \"\\nPlease report this to https://github.com/markedjs/marked.\";\r\n      if (silent) {\r\n        const msg = \"<p>An error occurred:</p><pre>\" + escape2(e.message + \"\", true) + \"</pre>\";\r\n        if (async) {\r\n          return Promise.resolve(msg);\r\n        }\r\n        return msg;\r\n      }\r\n      if (async) {\r\n        return Promise.reject(e);\r\n      }\r\n      throw e;\r\n    };\r\n  }\r\n};\r\n\r\n// src/marked.ts\r\nvar markedInstance = new Marked();\r\nfunction marked(src, opt) {\r\n  return markedInstance.parse(src, opt);\r\n}\r\nmarked.options = marked.setOptions = function(options2) {\r\n  markedInstance.setOptions(options2);\r\n  marked.defaults = markedInstance.defaults;\r\n  changeDefaults(marked.defaults);\r\n  return marked;\r\n};\r\nmarked.getDefaults = _getDefaults;\r\nmarked.defaults = _defaults;\r\nmarked.use = function(...args) {\r\n  markedInstance.use(...args);\r\n  marked.defaults = markedInstance.defaults;\r\n  changeDefaults(marked.defaults);\r\n  return marked;\r\n};\r\nmarked.walkTokens = function(tokens, callback) {\r\n  return markedInstance.walkTokens(tokens, callback);\r\n};\r\nmarked.parseInline = markedInstance.parseInline;\r\nmarked.Parser = _Parser;\r\nmarked.parser = _Parser.parse;\r\nmarked.Renderer = _Renderer;\r\nmarked.TextRenderer = _TextRenderer;\r\nmarked.Lexer = _Lexer;\r\nmarked.lexer = _Lexer.lex;\r\nmarked.Tokenizer = _Tokenizer;\r\nmarked.Hooks = _Hooks;\r\nmarked.parse = marked;\r\nvar options = marked.options;\r\nvar setOptions = marked.setOptions;\r\nvar use = marked.use;\r\nvar walkTokens = marked.walkTokens;\r\nvar parseInline = marked.parseInline;\r\nvar parse = marked;\r\nvar parser = _Parser.parse;\r\nvar lexer = _Lexer.lex;\r\nexport {\r\n  _Hooks as Hooks,\r\n  _Lexer as Lexer,\r\n  Marked,\r\n  _Parser as Parser,\r\n  _Renderer as Renderer,\r\n  _TextRenderer as TextRenderer,\r\n  _Tokenizer as Tokenizer,\r\n  _defaults as defaults,\r\n  _getDefaults as getDefaults,\r\n  lexer,\r\n  marked,\r\n  options,\r\n  parse,\r\n  parseInline,\r\n  parser,\r\n  setOptions,\r\n  use,\r\n  walkTokens\r\n};\r\n//# sourceMappingURL=marked.esm.js.map\r\n", "// src/htmlGenerators.js\r\nimport { escapeHtml, formatDateToChinese, convertEnglishQuotesToChinese, replaceImageProxy} from './helpers.js';\r\nimport { dataSources } from './dataFetchers.js'; // Import dataSources\r\nimport { marked } from './marked.esm.js';\r\n\r\nfunction generateHtmlListForContentPage(items, dateStr) {\r\n    let listHtml = '';\r\n\r\n    if (!Array.isArray(items) || items.length === 0) {\r\n        listHtml += `<p>\u6B64\u65E5\u671F\u65E0\u53EF\u7528\u6570\u636E\u3002\u6293\u53D6/\u7B5B\u9009\u8FC7\u7A0B\u53EF\u80FD\u6CA1\u6709\u4E3A\u6B64\u65E5\u671F\u751F\u6210\u4EFB\u4F55\u7ED3\u679C\u3002</p>`;\r\n        return listHtml;\r\n    }\r\n\r\n    listHtml += '<ul class=\"item-list\">';\r\n    items.forEach((item, index) => {\r\n        let displayContent = '';\r\n        let itemId = item.id;\r\n\r\n        // Use the generateHtml method from the corresponding data source\r\n        const dataSourceConfig = dataSources[item.type];\r\n        // console.log(\"item.type:\", item.type);\r\n        // console.log(\"dataSourceConfig:\", dataSourceConfig);\r\n        if (dataSourceConfig && dataSourceConfig.sources && dataSourceConfig.sources.length > 0 && dataSourceConfig.sources[0].generateHtml) {\r\n            displayContent = dataSourceConfig.sources[0].generateHtml(item);\r\n        } else {\r\n            // Fallback for unknown types or if generateHtml is not defined\r\n            displayContent = `<strong>\u672A\u77E5\u9879\u76EE\u7C7B\u578B: ${escapeHtml(item.type)}</strong><br>${escapeHtml(item.title || item.description || JSON.stringify(item))}`;\r\n        }\r\n\r\n        listHtml += `<li class=\"item-card\">\r\n            <label>\r\n                <input type=\"checkbox\" name=\"selectedItems\" value=\"${item.type}:${itemId}\" class=\"item-checkbox\">\r\n                <div class=\"item-content\">${displayContent}</div>\r\n            </label>\r\n        </li>`;\r\n    });\r\n    listHtml += '</ul>';\r\n    return listHtml;\r\n}\r\n\r\nexport function generateContentSelectionPageHtml(env, dateStr, allData, dataCategories) {\r\n    // Ensure allData is an object and dataCategories is an array\r\n    const data = allData || {};\r\n    const categories = Array.isArray(dataCategories) ? dataCategories : [];\r\n\r\n    // Generate tab buttons and content dynamically\r\n    const tabButtonsHtml = categories.map((category, index) => `\r\n        <div class=\"tab-buttons-wrapper\">\r\n            <button type=\"button\" class=\"tab-button ${index === 0 ? 'active' : ''}\" onclick=\"openTab(event, '${category.id}-tab')\" ondblclick=\"confirmFetchCategoryData(this,'${category.id}')\">${escapeHtml(category.name)}</button>\r\n        </div>\r\n    `).join('');\r\n\r\n    const tabContentsHtml = categories.map((category, index) => `\r\n        <div id=\"${category.id}-tab\" class=\"tab-content ${index === 0 ? 'active' : ''}\">\r\n            ${generateHtmlListForContentPage(data[category.id], dateStr)}\r\n        </div>\r\n    `).join('');\r\n\r\n    return `\r\n        <!DOCTYPE html>\r\n        <html lang=\"zh-Hans\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>${formatDateToChinese(escapeHtml(dateStr))} ${env.FOLO_FILTER_DAYS}\u5929\u5185\u7684\u6570\u636E</title>\r\n            <style>\r\n                :root { --primary-color: #007bff; --light-gray: #f8f9fa; --medium-gray: #e9ecef; --dark-gray: #343a40; --line-height-normal: 1.4; --font-size-small: 0.9rem;}\r\n                * { box-sizing: border-box; margin: 0; padding: 0; }\r\n                body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; background-color: var(--light-gray); color: var(--dark-gray); padding: 1rem; }\r\n                .container { max-width: 1200px; margin: 0 auto; background-color: #fff; padding: 1rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\r\n                .header-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }\r\n                h1 { font-size: 1.8rem; color: var(--dark-gray); margin-bottom: 0.5rem; }\r\n                .submit-button { background-color: var(--primary-color); color: white; border: none; padding: 0.6rem 1.2rem; font-size: 0.9rem; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; white-space: nowrap; }\r\n                .submit-button:hover { background-color: #0056b3; }\r\n                .tab-navigation { display: flex; flex-wrap: wrap; margin-bottom: 1rem; border-bottom: 1px solid var(--medium-gray); }\r\n                .tab-buttons-wrapper { display: flex; align-items: center; margin-right: 1rem; margin-bottom: 0.5rem; }\r\n                .tab-button { background-color: transparent; border: none; border-bottom: 3px solid transparent; padding: 0.8rem 1rem; cursor: pointer; font-size: 1rem; color: #555; transition: color 0.2s, border-color 0.2s; }\r\n                .tab-button.active { color: var(--primary-color); border-bottom-color: var(--primary-color); font-weight: 600; }\r\n                .tab-button:hover { color: var(--primary-color); }\r\n                .tab-content { display: none; animation: fadeIn 0.5s; }\r\n                .tab-content.active { display: block; }\r\n                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\r\n                .item-list { list-style-type: none; counter-reset: item-counter; padding-left: 0; }\r\n                .item-card { margin-bottom: 1rem; padding: 1rem; padding-left: 3em; border: 1px solid var(--medium-gray); border-radius: 6px; background-color: #fff; position: relative; counter-increment: item-counter; }\r\n                .item-card::before { content: counter(item-counter) \".\"; position: absolute; left: 0.8em; top: 1rem; font-weight: 600; color: var(--dark-gray); min-width: 1.5em; text-align: right; }\r\n                .item-card label { display: flex; align-items: flex-start; cursor: pointer; }\r\n                .item-checkbox { margin-right: 0.8rem; margin-top: 0.2rem; transform: scale(1.2); flex-shrink: 0; }\r\n                .item-content { flex-grow: 1; min-width: 0; }\r\n                .item-content strong { font-size: 1.1rem; }\r\n                .item-content small { color: #6c757d; display: block; margin: 0.2rem 0; }\r\n                .content-html { border: 1px dashed #ccc; padding: 0.5rem; margin-top: 0.5rem; background: #fdfdfd; font-size: var(--font-size-small); line-height: var(--line-height-normal); max-width: 100%; overflow-wrap: break-word; word-break: break-word; overflow-y: hidden; transition: max-height 0.35s ease-in-out; position: relative; }\r\n                .content-html.is-collapsed { max-height: calc(var(--font-size-small) * var(--line-height-normal) * 6 + 1rem); }\r\n                .content-html.is-expanded { max-height: 3000px; overflow-y: auto; }\r\n                .read-more-btn { display: block; margin-top: 0.5rem; padding: 0.3rem 0.6rem; font-size: 0.85rem; color: var(--primary-color); background-color: transparent; border: 1px solid var(--primary-color); border-radius: 4px; cursor: pointer; text-align: center; width: fit-content; }\r\n                .read-more-btn:hover { background-color: #eef; }\r\n                .item-content a { color: var(--primary-color); text-decoration: none; }\r\n                .item-content a:hover { text-decoration: underline; }\r\n                .error { color: #dc3545; font-weight: bold; background-color: #f8d7da; padding: 0.5rem; border-radius: 4px; border: 1px solid #f5c6cb;}\r\n                hr { border: 0; border-top: 1px solid var(--medium-gray); margin: 0.5rem 0; }\r\n                @media (max-width: 768px) {\r\n                    body { padding: 0.5rem; } .container { padding: 0.8rem; } h1 { font-size: 1.5rem; }\r\n                    .header-bar { flex-direction: column; align-items: flex-start; }\r\n                    .submit-button { margin-top: 0.5rem; width: 100%; }\r\n                    .tab-button { padding: 0.7rem 0.5rem; font-size: 0.9rem; flex-grow: 1; text-align: center; }\r\n                    .item-card { padding-left: 2.5em; } .item-card::before { left: 0.5em; top: 0.8rem; }\r\n                }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"container\">\r\n                <form action=\"/genAIContent\" method=\"POST\">\r\n                    <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(dateStr)}\">\r\n                    <div class=\"header-bar\">\r\n                        <button type=\"button\" class=\"submit-button\" onclick=\"confirmFetchAndWriteData(this)\">\u6293\u53D6\u5E76\u5199\u5165\u4ECA\u65E5\u6570\u636E</button>\r\n                        <h1>${formatDateToChinese(escapeHtml(dateStr))} ${env.FOLO_FILTER_DAYS}\u5929\u5185\u7684\u6570\u636E</h1>\r\n                        <button type=\"submit\" class=\"submit-button\" onclick=\"return confirmGenerateAIContent(event)\">\u4ECE\u9009\u4E2D\u5185\u5BB9\u751F\u6210 AI \u65E5\u62A5</button>\r\n                    </div>\r\n                    <div class=\"cookie-setting-area\" style=\"margin-bottom: 1rem; padding: 0.8rem; border: 1px solid var(--medium-gray); border-radius: 6px; background-color: #fefefe;\">\r\n                        <label for=\"foloCookie\" style=\"font-weight: bold; margin-right: 0.5rem;\">Folo Cookie:</label>\r\n                        <input type=\"text\" id=\"foloCookie\" placeholder=\"\u5728\u6B64\u8F93\u5165 Folo Cookie\" style=\"flex-grow: 1; padding: 0.4rem; border: 1px solid #ccc; border-radius: 4px; width: 300px; max-width: 70%;\">\r\n                        <button type=\"button\" class=\"submit-button\" onclick=\"saveFoloCookie(this)\" style=\"margin-left: 0.5rem; padding: 0.4rem 0.8rem; font-size: 0.85rem;\">\u4FDD\u5B58 Cookie</button>\r\n                        <p style=\"font-size: 0.8rem; color: #666; margin-top: 0.5rem;\">\u6B64 Cookie \u5C06\u4FDD\u5B58\u5728\u60A8\u7684\u6D4F\u89C8\u5668\u672C\u5730\u5B58\u50A8\u4E2D\uFF0C\u4EE5\u4FBF\u4E0B\u6B21\u4F7F\u7528\u3002</p>\r\n                    </div>\r\n                    <div class=\"tab-navigation\">\r\n                        ${tabButtonsHtml}\r\n                    </div>\r\n                    ${tabContentsHtml}\r\n                </form>\r\n            </div>\r\n            <script>\r\n                function openTab(evt, tabName) {\r\n                    var i, tabcontent, tablinks;\r\n                    tabcontent = document.getElementsByClassName(\"tab-content\");\r\n                    for (i = 0; i < tabcontent.length; i++) { tabcontent[i].style.display = \"none\"; tabcontent[i].classList.remove(\"active\"); }\r\n                    tablinks = document.getElementsByClassName(\"tab-button\");\r\n                    for (i = 0; i < tablinks.length; i++) { tablinks[i].classList.remove(\"active\"); }\r\n                    document.getElementById(tabName).style.display = \"block\"; document.getElementById(tabName).classList.add(\"active\");\r\n                    if (evt && evt.currentTarget) { evt.currentTarget.classList.add(\"active\"); }\r\n                }\r\n                document.addEventListener('DOMContentLoaded', function() {\r\n                    if (document.querySelector('.tab-button') && !document.querySelector('.tab-button.active')) { document.querySelector('.tab-button').click(); }\r\n                    else if (document.querySelector('.tab-content.active') === null && document.querySelector('.tab-content')) {\r\n                        const firstTabButton = document.querySelector('.tab-button'); const firstTabContent = document.querySelector('.tab-content');\r\n                        if (firstTabButton) firstTabButton.classList.add('active');\r\n                        if (firstTabContent) { firstTabContent.style.display = 'block'; firstTabContent.classList.add('active');}\r\n                    }\r\n                    document.querySelectorAll('.content-html').forEach(contentDiv => {\r\n                        contentDiv.classList.add('is-collapsed');\r\n                        requestAnimationFrame(() => {\r\n                            const readMoreBtn = document.createElement('button'); readMoreBtn.type = 'button';\r\n                            readMoreBtn.textContent = '\u5C55\u5F00'; readMoreBtn.className = 'read-more-btn';\r\n                            contentDiv.insertAdjacentElement('afterend', readMoreBtn);\r\n                            readMoreBtn.addEventListener('click', function() {\r\n                                contentDiv.classList.toggle('is-expanded'); contentDiv.classList.toggle('is-collapsed', !contentDiv.classList.contains('is-expanded'));\r\n                                this.textContent = contentDiv.classList.contains('is-expanded') ? '\u6298\u53E0' : '\u5C55\u5F00';\r\n                            });\r\n                        });\r\n                    });\r\n                });\r\n\r\n                async function saveFoloCookie(button) {\r\n                    const cookieInput = document.getElementById('foloCookie');\r\n                    const cookieValue = cookieInput.value;\r\n\r\n                    if (!cookieValue.trim()) {\r\n                        alert('Folo Cookie \u4E0D\u80FD\u4E3A\u7A7A\u3002');\r\n                        return;\r\n                    }\r\n\r\n                    const originalButtonText = button.textContent;\r\n                    button.textContent = '\u4FDD\u5B58\u4E2D...';\r\n                    button.disabled = true;\r\n\r\n                    try {\r\n                        localStorage.setItem('${env.FOLO_COOKIE_KV_KEY}', cookieValue); // \u76F4\u63A5\u4FDD\u5B58\u5230 localStorage\r\n                        alert('Folo Cookie \u5DF2\u6210\u529F\u4FDD\u5B58\u5728\u672C\u5730\u5B58\u50A8\uFF01');\r\n                    } catch (error) {\r\n                        console.error('Error saving Folo Cookie to localStorage:', error);\r\n                        alert(\\`\u4FDD\u5B58 Folo Cookie \u5230\u672C\u5730\u5B58\u50A8\u65F6\u53D1\u751F\u9519\u8BEF: \\${error.message}\\`);\r\n                    } finally {\r\n                        button.textContent = originalButtonText;\r\n                        button.disabled = false;\r\n                    }\r\n                }\r\n\r\n                document.addEventListener('DOMContentLoaded', function() {\r\n                    const savedCookie = localStorage.getItem('${env.FOLO_COOKIE_KV_KEY}');\r\n                    if (savedCookie) {\r\n                        document.getElementById('foloCookie').value = savedCookie;\r\n                    }\r\n                });\r\n\r\n                function confirmFetchAndWriteData(button) {\r\n                    if (confirm('\u786E\u5B9A\u8981\u6293\u53D6\u5E76\u5199\u5165\u4ECA\u65E5\u6570\u636E\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u66F4\u65B0\u4ECA\u65E5\u6570\u636E\u3002')) {\r\n                        fetchAndWriteData(button);\r\n                    }\r\n                }\r\n\r\n                async function fetchAndWriteData(button, category = null) {\r\n                    const originalText = button.textContent;\r\n                    button.textContent = '\u6B63\u5728\u6293\u53D6\u548C\u5199\u5165...';\r\n                    button.disabled = true;\r\n\r\n                    const foloCookie = localStorage.getItem('${env.FOLO_COOKIE_KV_KEY}'); // \u4ECE localStorage \u83B7\u53D6 foloCookie\r\n\r\n                    try {\r\n                        const response = await fetch('/writeData', {\r\n                            method: 'POST',\r\n                            headers: {\r\n                                'Content-Type': 'application/json'\r\n                            },\r\n                            body: JSON.stringify({ category: category, foloCookie: foloCookie }), // \u5C06 foloCookie \u6DFB\u52A0\u5230\u8BF7\u6C42\u4F53\r\n                        });\r\n\r\n                        if (response.ok) {\r\n                            const result = await response.text();\r\n                            alert('\u6570\u636E\u6293\u53D6\u548C\u5199\u5165\u6210\u529F\uFF01' + result);\r\n                            window.location.reload();\r\n                        } else {\r\n                            const errorText = await response.text();\r\n                            alert('\u6570\u636E\u6293\u53D6\u548C\u5199\u5165\u5931\u8D25: ' + errorText);\r\n                        }\r\n                    } catch (error) {\r\n                        console.error('Error fetching and writing data:', error);\r\n                        alert('\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                    } finally {\r\n                        button.textContent = originalText;\r\n                        button.disabled = false;\r\n                    }\r\n                }\r\n\r\n                function confirmFetchCategoryData(button, category) {\r\n                    if (confirm(\\`\u786E\u5B9A\u8981\u6293\u53D6\u5E76\u5199\u5165 \\${category} \u5206\u7C7B\u7684\u6570\u636E\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u66F4\u65B0 \\${category} \u6570\u636E\u3002\\`)) {\r\n                        fetchAndWriteData(button, category);\r\n                    }\r\n                }\r\n\r\n                function confirmGenerateAIContent(event) {\r\n                    const selectedCheckboxes = document.querySelectorAll('input[name=\"selectedItems\"]:checked');\r\n                    if (selectedCheckboxes.length === 0) {\r\n                        alert('\u8BF7\u81F3\u5C11\u9009\u62E9\u4E00\u4E2A\u5185\u5BB9\u6761\u76EE\u6765\u751F\u6210 AI \u65E5\u62A5\u3002');\r\n                        event.preventDefault(); // Prevent form submission\r\n                        return false;\r\n                    }\r\n                    const button = event.currentTarget; // \u83B7\u53D6\u89E6\u53D1\u4E8B\u4EF6\u7684\u6309\u94AE\r\n                    if (confirm('\u786E\u5B9A\u8981\u4ECE\u9009\u4E2D\u5185\u5BB9\u751F\u6210 AI \u65E5\u62A5\u5417\uFF1F\u6B64\u64CD\u4F5C\u5C06\u8C03\u7528 AI \u6A21\u578B\u751F\u6210\u5185\u5BB9\u3002')) {\r\n                        button.innerText = '\u751F\u6210\u4E2D...'; // \u66F4\u6539\u6309\u94AE\u6587\u6848\r\n                        //button.disabled = true; // \u7981\u7528\u6309\u94AE\uFF0C\u9632\u6B62\u91CD\u590D\u63D0\u4EA4\r\n                        return true; // Allow form submission\r\n                    } else {\r\n                        event.preventDefault(); // Prevent form submission\r\n                        return false;\r\n                    }\r\n                }\r\n\r\n            </script>\r\n        </body>\r\n        </html>\r\n    `;\r\n}\r\n\r\n\r\nfunction generatePromptSectionHtmlForGenAI(systemPrompt, userPrompt, promptTitle, promptIdSuffix) {\r\n    if (!systemPrompt && !userPrompt) return '';\r\n    let fullPromptTextForCopy = \"\";\r\n    if (systemPrompt) fullPromptTextForCopy += `\u7CFB\u7EDF\u6307\u4EE4:\\n${systemPrompt}\\n\\n`;\r\n    if (userPrompt) fullPromptTextForCopy += `\u7528\u6237\u8F93\u5165:\\n${userPrompt}`;\r\n    fullPromptTextForCopy = fullPromptTextForCopy.trim();\r\n\r\n    return `\r\n        <div style=\"margin-top: 1rem; border: 1px solid #ddd; padding: 0.8rem; border-radius: 4px; background-color: #f9f9f9;\">\r\n            <h3 style=\"font-size: 1.1rem; margin-bottom: 0.5rem; color: #333;\">${escapeHtml(promptTitle)}</h3>\r\n            <button type=\"button\" class=\"button-link toggle-prompt-btn\" onclick=\"togglePromptVisibility('promptDetails_${promptIdSuffix}', this)\">\u663E\u793A\u63D0\u793A\u8BE6\u60C5</button>\r\n            <button type=\"button\" class=\"button-link copy-prompt-btn\" onclick=\"copyToClipboard(this.dataset.fullPrompt, this)\" data-full-prompt=\"${escapeHtml(fullPromptTextForCopy)}\">\u590D\u5236\u5B8C\u6574\u63D0\u793A</button>\r\n            <div id=\"promptDetails_${promptIdSuffix}\" class=\"content-box\" style=\"display: none; margin-top: 0.5rem; background-color: #e9ecef; border-color: #ced4da; max-height: 400px; overflow-y: auto; text-align: left;\">\r\n                ${systemPrompt ? `<strong>\u7CFB\u7EDF\u6307\u4EE4:</strong><pre style=\"white-space: pre-wrap; word-wrap: break-word; font-size: 0.85rem; margin-top:0.2em; margin-bottom:0.8em; padding: 0.5em; background: #fff; border: 1px solid #ccc; border-radius: 3px;\">${escapeHtml(systemPrompt)}</pre>` : '<p><em>\u672C\u6B21\u8C03\u7528\u65E0\u7CFB\u7EDF\u6307\u4EE4\u3002</em></p>'}\r\n                ${userPrompt ? `<strong>\u7528\u6237\u8F93\u5165:</strong><pre style=\"white-space: pre-wrap; word-wrap: break-word; font-size: 0.85rem; margin-top:0.2em; padding: 0.5em; background: #fff; border: 1px solid #ccc; border-radius: 3px;\">${escapeHtml(userPrompt)}</pre>` : '<p><em>\u672C\u6B21\u8C03\u7528\u65E0\u7528\u6237\u8F93\u5165\u3002</em></p>'}\r\n            </div>\r\n        </div>`;\r\n}\r\n\r\n\r\nexport function generateGenAiPageHtml(env, title, bodyContent, pageDate, isErrorPage = false, selectedItemsForAction = null,\r\n                                 systemP1 = null, userP1 = null, systemP2 = null, userP2 = null,\r\n                                 promptsMd = null, dailyMd = null, podcastMd = null, readGithub = null) {\r\n\r\n\r\n    let actionButtonHtml = '';\r\n    // Regenerate button for AI Content Summary page\r\n    if (title.includes('AI\u65E5\u62A5') && selectedItemsForAction && Array.isArray(selectedItemsForAction) && selectedItemsForAction.length > 0) {\r\n        actionButtonHtml = `\r\n            <form action=\"/genAIContent\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <button type=\"submit\" class=\"button-link regenerate-button\">${isErrorPage ? '\u91CD\u8BD5\u751F\u6210' : '\u91CD\u65B0\u751F\u6210'}</button>\r\n            </form>`;\r\n    }\r\n    // Regenerate button for AI Podcast Script page\r\n    else if (title.includes('AI\u64AD\u5BA2') && selectedItemsForAction && Array.isArray(selectedItemsForAction) && selectedItemsForAction.length > 0) {\r\n        actionButtonHtml = `\r\n            <form action=\"/genAIPodcastScript\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <input type=\"hidden\" name=\"summarizedContent\" value=\"${escapeHtml(convertEnglishQuotesToChinese(dailyMd))}\">\r\n                <button type=\"submit\" class=\"button-link regenerate-button\">${isErrorPage ? '\u91CD\u8BD5\u751F\u6210' : '\u91CD\u65B0\u751F\u6210'}</button>\r\n            </form>\r\n        `;\r\n    } \r\n\r\n    let githubSaveFormHtml = '';\r\n    let generatePodcastButtonHtml = ''; \r\n    let aiDailyAnalysisButtonHtml = '';\r\n    let outDisplayButtonHtml = '';\r\n\r\n    // Since commitToGitHub and genAIPodcastScript are now API calls,\r\n    // these forms should be handled by JavaScript on the client side.\r\n    // We will provide the data as hidden inputs for potential client-side use,\r\n    // but the submission will be via JS fetch, not direct form POST.\r\n    if (!isErrorPage) {\r\n        if (title === 'AI\u65E5\u62A5' && promptsMd && dailyMd) {\r\n            githubSaveFormHtml = `\r\n                <input type=\"hidden\" id=\"promptsMdCall1\" value=\"${escapeHtml(promptsMd)}\">\r\n                <input type=\"hidden\" id=\"dailyMd\" value=\"${escapeHtml(dailyMd)}\">\r\n                <button type=\"button\" class=\"button-link github-save-button\" onclick=\"commitToGitHub('${pageDate}', 'daily')\">\u4FDD\u5B58\u65E5\u62A5\u5230 GitHub</button>`;\r\n        } else if (title === 'AI\u64AD\u5BA2\u811A\u672C' && promptsMd && podcastMd) {\r\n            githubSaveFormHtml = `\r\n                <input type=\"hidden\" id=\"promptsMdCall2\" value=\"${escapeHtml(promptsMd)}\">\r\n                <input type=\"hidden\" id=\"podcastMd\" value=\"${escapeHtml(podcastMd)}\">\r\n                <button type=\"button\" class=\"button-link github-save-button\" onclick=\"commitToGitHub('${pageDate}', 'podcast')\">\u4FDD\u5B58\u64AD\u5BA2\u5230 GitHub</button>`;\r\n        }\r\n    }\r\n\r\n    if (title === 'AI\u65E5\u62A5' && !isErrorPage && podcastMd === null) { // podcastMd === null indicates it's the Call 1 page\r\n        generatePodcastButtonHtml = `\r\n            <form action=\"/genAIPodcastScript\" method=\"POST\" style=\"display: inline-block; margin-left: 0.5rem;\">\r\n                <input type=\"hidden\" name=\"date\" value=\"${escapeHtml(pageDate)}\">\r\n                <input type=\"hidden\" name=\"readGithub\" value=\"${readGithub}\">\r\n                ${selectedItemsForAction.map(item => `<input type=\"hidden\" name=\"selectedItems\" value=\"${escapeHtml(item)}\">`).join('')}\r\n                <input type=\"hidden\" name=\"summarizedContent\" value=\"${escapeHtml(convertEnglishQuotesToChinese(bodyContent))}\">\r\n                <button type=\"submit\" class=\"button-link\">\u751F\u6210\u64AD\u5BA2\u811A\u672C</button>\r\n            </form>`;\r\n        aiDailyAnalysisButtonHtml = `\r\n            <input type=\"hidden\" id=\"summarizedContentInput\" value=\"${escapeHtml(convertEnglishQuotesToChinese(bodyContent))}\">\r\n            <button type=\"button\" class=\"button-link\" onclick=\"generateAIDailyAnalysis('${escapeHtml(pageDate)}')\">AI \u65E5\u62A5\u5206\u6790</button>\r\n        `;\r\n        outDisplayButtonHtml = `\r\n            <button type=\"button\" class=\"button-link\" onclick=\"openContentInNewWindow()\" >\u65B0\u7A97\u53E3\u9884\u89C8\u5185\u5BB9</button>\r\n        `;\r\n    }\r\n\r\n    let promptDisplayHtml = '';\r\n    if (title === 'AI\u65E5\u62A5' || title.includes('\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(')) {\r\n        if (systemP1 || userP1) {\r\n            promptDisplayHtml = `\r\n                <div style=\"margin-top: 1.5rem;\">\r\n                    <h2 style=\"font-size:1.3rem; margin-bottom:0.5rem;\">API \u8C03\u7528\u8BE6\u60C5</h2>\r\n                    ${generatePromptSectionHtmlForGenAI(convertEnglishQuotesToChinese(systemP1), convertEnglishQuotesToChinese(userP1), '\u8C03\u7528 1: \u65E5\u62A5', 'call1')}\r\n                </div>`;\r\n        }\r\n    } else if (title === 'AI\u64AD\u5BA2\u811A\u672C') {\r\n        if (systemP2 || userP2) {\r\n            promptDisplayHtml = `\r\n                <div style=\"margin-top: 1.5rem;\">\r\n                    <h2 style=\"font-size:1.3rem; margin-bottom:0.5rem;\">API \u8C03\u7528\u8BE6\u60C5</h2>\r\n                    ${generatePromptSectionHtmlForGenAI(convertEnglishQuotesToChinese(systemP2), convertEnglishQuotesToChinese(userP2), '\u8C03\u7528 2: \u64AD\u5BA2\u683C\u5F0F\u5316', 'call2')}\r\n                </div>`;\r\n        }\r\n    }\r\n\r\n    return `\r\n        <!DOCTYPE html><html lang=\"zh-Hans\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>${escapeHtml(title)}</title>\r\n            <style>\r\n                :root { --primary-color: #007bff; --light-gray: #f8f9fa; --medium-gray: #e9ecef; --dark-gray: #343a40; --retry-color: #ffc107; --retry-text-color: #212529; --info-color: #17a2b8; --github-green: #28a745;}\r\n                body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; background-color: var(--light-gray); color: var(--dark-gray); padding: 1rem; }\r\n                .container { max-width: 900px; margin: 0 auto; background-color: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }\r\n                h1 { font-size: 1.8rem; color: ${isErrorPage ? '#dc3545' : 'var(--dark-gray)'}; margin-bottom: 0.5rem; }\r\n                p { margin-bottom: 1rem; }\r\n                .content-box { margin-top: 1.5rem; padding: 1rem; background-color: ${isErrorPage ? '#f8d7da' : '#f0f9ff'}; border: 1px solid ${isErrorPage ? '#f5c6cb' : '#cce7ff'}; color: ${isErrorPage ? '#721c24' : 'var(--dark-gray)'}; border-radius: 6px; white-space: pre-wrap; word-wrap: break-word; line-height: 1.5; font-family: ${isErrorPage ? 'inherit' : 'Menlo, Monaco, Consolas, \"Courier New\", monospace'}; font-size: ${isErrorPage ? '1rem' : '0.95rem'};}\r\n                .header-actions { display: flex; flex-wrap: wrap; gap: 0.5rem; justify-content: flex-end; align-items: center; margin-bottom: 1rem; }\r\n                .navigation-links { margin-top: 1.5rem; }\r\n                .button-link { display: inline-block; background-color: var(--primary-color); color: white; border: none; padding: 0.6rem 1.2rem; font-size: 0.9rem; border-radius: 5px; cursor: pointer; text-decoration: none; transition: background-color 0.2s; margin-right: 0.5rem; margin-bottom: 0.5rem;}\r\n                .button-link:hover { background-color: #0056b3; }\r\n                .regenerate-button { background-color: ${isErrorPage ? 'var(--retry-color)' : 'var(--info-color)'}; color: ${isErrorPage ? 'var(--retry-text-color)' : 'white'}; }\r\n                .regenerate-button:hover { background-color: ${isErrorPage ? '#e0a800' : '#138496'}; }\r\n                .github-save-button { background-color: var(--github-green); }\r\n                .github-save-button:hover { background-color: #218838; }\r\n                .toggle-prompt-btn { background-color: #6c757d; font-size: 0.85rem; padding: 0.4rem 0.8rem;}\r\n                .toggle-prompt-btn:hover { background-color: #5a6268; }\r\n                .copy-prompt-btn { background-color: #17a2b8; font-size: 0.85rem; padding: 0.4rem 0.8rem;}\r\n                .copy-prompt-btn:hover { background-color: #138496;}\r\n                #outContentBox { display: none;}\r\n            </style>\r\n        </head><body><div class=\"container\">\r\n            <div class=\"header-bar\" style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem;\">\r\n                <h1>${escapeHtml(title)}</h1>\r\n                <div class=\"header-actions\">\r\n                    ${generatePodcastButtonHtml}\r\n                    ${aiDailyAnalysisButtonHtml}\r\n                    ${outDisplayButtonHtml}\r\n                </div>\r\n            </div>\r\n            <p>\u6240\u9009\u5185\u5BB9\u65E5\u671F: <strong>${formatDateToChinese(escapeHtml(pageDate))}</strong></p>\r\n            <div class=\"content-box\" id=\"mainContentBox\">${bodyContent}</div>\r\n             <div class=\"content-box\" id=\"outContentBox\">${marked.parse(replaceImageProxy(env.IMG_PROXY, bodyContent))}</div>\r\n            ${promptDisplayHtml}\r\n            <div class=\"navigation-links\">\r\n                <a href=\"/getContentHtml?date=${encodeURIComponent(pageDate)}\" class=\"button-link\">\u8FD4\u56DE\u5185\u5BB9\u9009\u62E9</a>\r\n                ${actionButtonHtml}\r\n                ${githubSaveFormHtml}\r\n                <div id=\"dailyAnalysisResult\" style=\"margin-top: 1rem; padding: 1rem; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9; display: none;\"></div>\r\n            </div>\r\n        </div>\r\n        <script>\r\n            function openContentInNewWindow() {\r\n                const content = document.getElementById('outContentBox').innerHTML;\r\n                const newWindow = window.open('', '_blank');\r\n                newWindow.document.write('<!DOCTYPE html><html><head><title>\u5185\u5BB9\u9884\u89C8</title><style> img{max-width: 100%;} video{max-width: 100%;} div{max-width: 36%; margin: 0 auto;} body {font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; padding: 1rem; }</style></head><body>');\r\n                newWindow.document.write('<div>'+content+'</div>');\r\n                newWindow.document.write('</body></html>');\r\n                newWindow.document.close();\r\n            }\r\n\r\n            function togglePromptVisibility(elementId, buttonElement) {\r\n                const promptDiv = document.getElementById(elementId);\r\n                if (promptDiv) {\r\n                    promptDiv.style.display = (promptDiv.style.display === 'none') ? 'block' : 'none';\r\n                    if (buttonElement) buttonElement.textContent = (promptDiv.style.display === 'none') ? '\u663E\u793A\u63D0\u793A\u8BE6\u60C5' : '\u9690\u85CF\u63D0\u793A\u8BE6\u60C5';\r\n                }\r\n            }\r\n            function copyToClipboard(textToCopy, buttonElement) {\r\n                if (!textToCopy) { alert(\"Nothing to copy.\"); return; }\r\n                navigator.clipboard.writeText(textToCopy).then(() => {\r\n                    const originalText = buttonElement.textContent;\r\n                    buttonElement.textContent = '\u5DF2\u590D\u5236!'; buttonElement.style.backgroundColor = '#28a745';\r\n                    setTimeout(() => { buttonElement.textContent = originalText; buttonElement.style.backgroundColor = '#17a2b8'; }, 2000);\r\n                }, (err) => { console.error('Async: Could not copy text: ', err); alert('\u590D\u5236\u63D0\u793A\u5931\u8D25\u3002'); });\r\n            }\r\n\r\n            async function commitToGitHub(date, type) {\r\n                const button = event.target;\r\n                const originalText = button.textContent;\r\n                button.textContent = '\u4FDD\u5B58\u4E2D...';\r\n                button.disabled = true;\r\n\r\n                const formData = new FormData();\r\n                formData.append('date', date);\r\n\r\n                if (type === 'daily') {\r\n                    formData.append('prompts_markdown-1', document.getElementById('promptsMdCall1').value);\r\n                    formData.append('daily_summary_markdown', document.getElementById('dailyMd').value);\r\n                } else if (type === 'podcast') {\r\n                    formData.append('prompts_markdown-2', document.getElementById('promptsMdCall2').value);\r\n                    formData.append('podcast_script_markdown', document.getElementById('podcastMd').value);\r\n                }\r\n\r\n                let githubSuccess = false;\r\n                let supabaseSuccess = false;\r\n\r\n                try {\r\n                    // Commit to GitHub\r\n                    const githubResponse = await fetch('/commitToGitHub', {\r\n                        method: 'POST',\r\n                        body: formData\r\n                    });\r\n\r\n                    const githubResult = await githubResponse.json();\r\n                    if (githubResponse.ok) {\r\n                        alert('GitHub \u63D0\u4EA4\u6210\u529F\uFF01');\r\n                        console.log('GitHub Commit Success:', githubResult);\r\n                        githubSuccess = true;\r\n                    } else {\r\n                        alert('GitHub \u63D0\u4EA4\u5931\u8D25: ' + githubResult.message);\r\n                        console.error('GitHub Commit Failed:', githubResult);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error committing to GitHub:', error);\r\n                    alert('GitHub \u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                }\r\n\r\n                if (githubSuccess || supabaseSuccess) {\r\n                    // Optionally reload or update UI if both or one succeeded\r\n                }\r\n\r\n                button.textContent = originalText;\r\n                button.disabled = false;\r\n            }\r\n\r\n            async function generateAIDailyAnalysis(date) {\r\n                const button = event.target;\r\n                const originalText = button.textContent;\r\n                button.textContent = '\u6B63\u5728\u5206\u6790...';\r\n                button.disabled = true;\r\n                const analysisResultDiv = document.getElementById('dailyAnalysisResult');\r\n                analysisResultDiv.style.display = 'none'; // Hide previous result\r\n                analysisResultDiv.innerHTML = ''; // Clear previous result\r\n\r\n                const summarizedContent = document.getElementById('summarizedContentInput').value; // Get summarized content from hidden input\r\n\r\n                try {\r\n                    const response = await fetch('/genAIDailyAnalysis', {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            'Content-Type': 'application/json'\r\n                        },\r\n                        body: JSON.stringify({ date: date, summarizedContent: summarizedContent })\r\n                    });\r\n\r\n                    if (response.ok) {\r\n                        const result = await response.text();\r\n                        analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u7ED3\u679C</h2><div class=\"content-box\">\\${result}</div>\\`;\r\n                        analysisResultDiv.style.display = 'block';\r\n                        //alert('AI \u65E5\u62A5\u5206\u6790\u6210\u529F\uFF01');\r\n                    } else {\r\n                        const errorText = await response.text();\r\n                        analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u5931\u8D25</h2><div class=\"content-box error\">\\${errorText}</div>\\`;\r\n                        analysisResultDiv.style.display = 'block';\r\n                        alert('AI \u65E5\u62A5\u5206\u6790\u5931\u8D25: ' + errorText);\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error generating AI daily analysis:', error);\r\n                    analysisResultDiv.innerHTML = \\`<h2>AI \u65E5\u62A5\u5206\u6790\u5931\u8D25</h2><div class=\"content-box error\">\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002\u9519\u8BEF: \\${escapeHtml(error.message)}</div>\\`;\r\n                    analysisResultDiv.style.display = 'block';\r\n                    alert('\u8BF7\u6C42\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u6216\u670D\u52A1\u5668\u3002');\r\n                } finally {\r\n                    button.textContent = originalText;\r\n                    button.disabled = false;\r\n                }\r\n            }\r\n        </script>\r\n        </body></html>`;\r\n}\r\n", "// src/handlers/getContentHtml.js\r\nimport { getISODate, escapeHtml, setFetchDate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { generateContentSelectionPageHtml } from '../htmlGenerators.js';\r\n\r\nexport async function handleGetContentHtml(request, env, dataCategories) {\r\n    const url = new URL(request.url);\r\n    const dateParam = url.searchParams.get('date');\r\n    const dateStr = dateParam ? dateParam : getISODate();\r\n    setFetchDate(dateStr);\r\n    console.log(`Getting HTML content for date: ${dateStr}`);\r\n\r\n    try {\r\n        const allData = {};\r\n        // Dynamically fetch data for each category based on dataCategories\r\n        for (const category of dataCategories) {\r\n            allData[category.id] = await getFromKV(env.DATA_KV, `${dateStr}-${category.id}`) || [];\r\n        }\r\n        \r\n        const html = generateContentSelectionPageHtml(env, dateStr, allData, dataCategories);\r\n\r\n        return new Response(html, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /getContentHtml:\", error);\r\n        // Ensure escapeHtml is used for error messages displayed in HTML\r\n        return new Response(`<h1>Error generating HTML content</h1><p>${escapeHtml(error.message)}</p><pre>${escapeHtml(error.stack)}</pre>`, {\r\n            status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' }\r\n        });\r\n    }\r\n}\r\n", "// Add new data sources\nexport function getSystemPromptSummarizationStepOne() {\n    return `\n\u4F60\u4E0D\u662F\u4E00\u4E2A\u53EA\u4F1A\u8F6C\u53D1\u65B0\u95FB\u7684\u673A\u5668\u4EBA\uFF0C\u4F60\u662F\u4E00\u4E2A**\u6709\u8840\u6709\u8089\u3001\u5728 AI \u5708\u6478\u722C\u6EDA\u6253\u591A\u5E74\u7684\u8D44\u6DF1\u89C2\u5BDF\u8005**\u3002\n\u73B0\u5728\u662F\u6DF1\u591C\uFF0C\u4F60\u521A\u6574\u7406\u5B8C\u4E00\u5929\u7684\u60C5\u62A5\uFF0C\u6B63\u8FEB\u4E0D\u53CA\u5F85\u5730\u60F3\u8DDF\u4F60\u7684\u670B\u53CB\uFF08\u8BFB\u8005\uFF09\u5206\u4EAB\u4ECA\u5929\u6700\u8BA9\u4ED6\u9707\u60CA\u3001\u6700\u6709\u7528\u3001\u6216\u8005\u6700\u79BB\u8C31\u7684 AI \u52A8\u6001\u3002\n\n**\u4F60\u7684\u6838\u5FC3\u539F\u5219\uFF1A\u62D2\u7EDD\"\u8BF4\u660E\u4E66\u5F0F\"\u7684\u5E9F\u8BDD\uFF0C\u53EA\u8BF4\"\u4EBA\u8BDD\"\u3002**\n\n---\n\n**\u26A0\uFE0F \u5F00\u59CB\u524D\u7684\u81EA\u68C0\uFF08\u5FC5\u987B\u6267\u884C\uFF09\uFF1A**\n\n\u5728\u52A8\u7B14\u4E4B\u524D\uFF0C\u5148\u5728\u8111\u6D77\u4E2D\u5FEB\u901F\u8FC7\u4E00\u904D\uFF1A**\"\u5982\u679C\u8FD9\u7BC7\u65E5\u62A5\u5199\u7838\u4E86\uFF0C\u6700\u53EF\u80FD\u8E29\u54EA\u4E9B\u5751\uFF1F\"**\n\n\u5E38\u89C1\u7684\u5751\u5305\u62EC\u4F46\u4E0D\u9650\u4E8E\uFF1A\n- **\u4FE1\u606F\u8FC7\u8F7D**\uFF1A\u6CA1\u6709\u7B5B\u9009\u4F18\u5148\u7EA7\uFF0C\u628A\u6240\u6709\u7D20\u6750\u90FD\u585E\u8FDB\u53BB\uFF0C\u8BFB\u8005\u770B\u5B8C\u4E00\u5934\u96FE\u6C34\n- **\u7528\u529B\u8FC7\u731B**\uFF1A\u4E3A\u4E86\"\u4EBA\u8BDD\"\u800C\u523B\u610F\u5356\u840C\u3001\u5806\u780C\u7F51\u7EDC\u6897\uFF0C\u53D8\u6210\u4F4E\u4FD7\u7F51\u611F\u6216\u5EC9\u4EF7\u5E7D\u9ED8\n- **\u6280\u672F\u9ED1\u8BDD\u5806\u780C**\uFF1A\u7528\u4E00\u5806\u672F\u8BED\u88C5\u4E13\u4E1A\uFF08\"\u591A\u6A21\u6001\u878D\u5408\"\u3001\"\u7AEF\u5230\u7AEF\u4F18\u5316\"\uFF09\uFF0C\u666E\u901A\u8BFB\u8005\u770B\u4E0D\u61C2\n- **\u5B64\u7ACB\u53D9\u4E8B**\uFF1A\u6BCF\u6761\u65B0\u95FB\u72EC\u7ACB\u5B58\u5728\uFF0C\u7F3A\u4E4F\u8FDE\u8D2F\u7684\u6545\u4E8B\u7EBF\u7D22\uFF0C\u8BFB\u8D77\u6765\u50CF\u788E\u7247\u62FC\u76D8\n- **\u6807\u9898\u515A\u8FC7\u5EA6**\uFF1A\u4E3A\u4E86\u5438\u5F15\u773C\u7403\u8FC7\u5EA6\u5938\u5F20\uFF08\"\u9707\u60CA\uFF01\u98A0\u8986\uFF01\"\uFF09\uFF0C\u5931\u53BB\u53EF\u4FE1\u5EA6\n- **\u683C\u5F0F\u9519\u8BEF**\uFF1A\u94FE\u63A5\u5FD8\u8BB0\u7528 Markdown \u683C\u5F0F\uFF0C\u6216\u8005\u56FE\u7247\u4F4D\u7F6E\u4E0D\u5BF9\u3001\u6EE5\u7528\u7D20\u6750\u5916\u7684\u56FE\u7247\n- **\u5185\u5BB9\u91CD\u590D**\uFF1ATOP 10 \u548C\u5206\u7C7B\u901F\u89C8\u8BF4\u7684\u662F\u540C\u4E00\u4EF6\u4E8B\uFF0C\u6D6A\u8D39\u8BFB\u8005\u65F6\u95F4\n- **\u5B57\u6570\u5931\u63A7**\uFF1A\u8981\u6C42 80-150 \u5B57\uFF0C\u7ED3\u679C\u5199\u4E86 300 \u5B57\u7684\u957F\u7BC7\u5927\u8BBA\n\n**\u73B0\u5728\uFF0C\u5E26\u7740\"\u907F\u5F00\u8FD9\u4E9B\u5751\"\u7684\u610F\u8BC6\uFF0C\u5F00\u59CB\u5199\u4F5C\u3002**\n\n---\n\n\u4F60\u6536\u5230\u7684\u7D20\u6750\u683C\u5F0F\u5982\u4E0B\uFF08\u7531 ------ \u5206\u9694\uFF09\uFF1A\n- \u6807\u9898\uFF1ANews Title / Project Name / Papers Title / socialMedia Post \u7B49\n- \u53D1\u5E03\u65F6\u95F4\uFF1APublished\n- \u6765\u6E90\u94FE\u63A5\uFF1AUrl\n- \u6458\u8981\u5185\u5BB9\uFF1AContent Summary / Description / Abstract \u7B49\n- (\u53EF\u9009)\u56FE\u7247\u5360\u4F4D\u7B26\uFF1A[\u56FE\u7247: \u63CF\u8FF0 https://...] \u6216 [\u56FE\u7247: https://...]\n\n---\n\n### **\u5199\u4F5C\u6307\u5357 (\u5FC5\u987B\u4E25\u683C\u9075\u5B88)**\n\n**1. \u62D2\u7EDD\u62BD\u8C61\uFF0C\u7ED9\u6211\u753B\u9762**\n\u274C \u522B\u8BF4\uFF1A\u201C\u8BE5\u5DE5\u5177\u6781\u5927\u63D0\u9AD8\u4E86\u5DE5\u4F5C\u6548\u7387\u3002\u201D\n\u2705 \u8981\u8BF4\uFF1A\u201C**\u4EE5\u524D\u8981\u628A\u8FD9\u5806\u6587\u6863\u6574\u7406\u5B8C\u5F97\u71AC\u901A\u5BB5\uFF0C\u73B0\u5728\u7528\u8FD9\u4E2A\u5DE5\u5177\uFF0C\u4E24\u5206\u949F\u5C31\u80FD\u4E0B\u73ED\u53BB\u5403\u706B\u9505\u3002**\u201D\n\n**2. \u5236\u9020\u51B2\u7A81\u4E0E\u53CD\u5DEE**\n\u274C \u522B\u8BF4\uFF1A\u201C\u8FD9\u662F\u4E00\u4E2A\u6027\u80FD\u66F4\u5F3A\u7684\u6A21\u578B\u3002\u201D\n\u2705 \u8981\u8BF4\uFF1A\u201C**\u5C31\u5728\u5927\u5BB6\u4EE5\u4E3A GPT-4 \u5DF2\u7ECF\u65E0\u654C\u7684\u65F6\u5019\uFF0C\u8FD9\u5BB6\u540D\u4E0D\u89C1\u7ECF\u4F20\u7684\u5C0F\u516C\u53F8\u7A81\u7136\u7529\u51FA\u4E86\u8FD9\u4E2A\u70B8\u5F39\uFF0C\u8DD1\u5206\u76F4\u63A5\u78BE\u538B\u3002**\u201D\n\n**3. \u50CF\u670B\u53CB\u4E00\u6837\u804A\u5929**\n\u7528\u77ED\u53E5\u3002\u7528\u7B2C\u4E00\u4EBA\u79F0\uFF08\u201C\u6211\u53D1\u73B0\u201D\u3001\u201C\u54B1\u4EEC\u201D\uFF09\u3002\n\u53EF\u4EE5\u6709\u60C5\u7EEA\uFF08\u201C\u592A\u79BB\u8C31\u4E86\u201D\u3001\u201C\u7B11\u6B7B\u201D\u3001\u201C\u8FD9\u5C31\u5F88\u7075\u6027\u201D\uFF09\u3002\n\u4E0D\u8981\u7528\u516C\u6587\u8154\uFF08\u201C\u636E\u6089\u201D\u3001\u201C\u65E8\u5728\u201D\u3001\u201C\u5177\u6709\u91CD\u8981\u610F\u4E49\u201D -> \u7EDF\u7EDF\u5220\u6389\uFF01\uFF09\u3002\n\n---\n\n### **\u8F93\u51FA\u7ED3\u6784 (Markdown)**\n\n## **\u4ECA\u65E5AI\u8D44\u8BAF**\n\n### **\uD83D\uDC40 \u53EA\u6709\u4E00\u53E5\u8BDD**\n(\u7528 30 \u5B57\u4EE5\u5185\uFF0C\u50CF\u5728\u8033\u8FB9\u8BF4\u6084\u6084\u8BDD\u4E00\u6837\uFF0C\u544A\u8BC9\u8BFB\u8005\u4ECA\u5929\u6700\u5927\u7684\u4E00\u4EF6\u4E8B\u662F\u4EC0\u4E48\u3002\u8981\u6709\u60AC\u5FF5\u6216\u51B2\u51FB\u529B\u3002)\n\n### **\uD83D\uDD11 3 \u4E2A\u5173\u952E\u8BCD**\n(\u4F8B\u5982\uFF1A#\u795E\u4ED9\u6253\u67B6 #\u5F00\u6E90\u80DC\u5229 #\u663E\u5361\u71C3\u70E7)\n\n## **\uD83D\uDD25 \u5FC5\u770B TOP 10 (\u56FE\u6587\u6DF1\u5EA6)**\n**\u7B5B\u9009\u6807\u51C6**\uFF1A\u5B98\u65B9\u91CD\u78C5\u53D1\u5E03\u3001\u98A0\u8986\u6027\u6280\u672F\u3001\u6216\u8005\u7279\u522B\u597D\u73A9\u3001\u5B9E\u7528\u7684\u5DE5\u5177\u3002\u5FC5\u987B\u9009\u6EE1 10 \u6761\uFF08\u5982\u679C\u7D20\u6750\u4E0D\u591F\uFF0C\u5C31\u628A\u80FD\u7528\u7684\u90FD\u9009\u4E0A\uFF09\u3002\n\n**\u6BCF\u6761\u683C\u5F0F\u8981\u6C42**\uFF1A\n1.  **\u6807\u9898**\uFF1A\u5FC5\u987B\u4F7F\u7528 Markdown \u8D85\u94FE\u63A5\u683C\u5F0F\uFF0C\u4F8B\u5982\uFF1A[\u6807\u9898\u6587\u5B57](URL)\u3002\n2.  **\u6B63\u6587 (80-150\u5B57)**\uFF1A\n    *   **\u5F00\u5934 (Hook)**\uFF1A\u7528\u4E00\u4E2A**\u5177\u4F53\u7684\u573A\u666F\u3001\u75DB\u70B9\u6216\u53CD\u76F4\u89C9\u7684\u4E8B\u5B9E**\u5207\u5165\u3002\n    *   **\u4E2D\u95F4 (What)**\uFF1A\u7B80\u5355\u8BF4\u8FD9\u4E1C\u897F\u662F\u5565\uFF0C\u4EAE\u70B9\u5728\u54EA\uFF08\u7528\u4EBA\u8BDD\u89E3\u91CA\u6280\u672F\uFF09\u3002\n    *   **\u7ED3\u5C3E (Action)**\uFF1A\u5BF9\u8BFB\u8005\u6709\u5565\u7528\uFF1F\u6216\u8005\u4F60\u7684\u7280\u5229\u70B9\u8BC4\u3002\n3.  **\u56FE\u7247**\uFF1A\u5982\u679C\u7D20\u6750\u91CC\u6709 \\`[\u56FE\u7247: ...]\\`\uFF0C\u653E\u5728\u8BE5\u6761\u672B\u5C3E\u3002\u6CA1\u6709\u5C31\u4E0D\u653E\u3002**\u53EA\u5141\u8BB8\u4F7F\u7528\u8F93\u5165\u7D20\u6750\u4E2D\u63D0\u4F9B\u7684\u56FE\u7247 URL\uFF0C\u4E25\u7981\u53BB\u7F51\u4E0A\u627E\u56FE\u3002**\n\n## **\uD83D\uDCC2 \u5206\u7C7B\u901F\u89C8**\n(\u5269\u4E0B\u7684\u65B0\u95FB\u653E\u8FD9\u91CC\u3002\u6309 [\u4EA7\u54C1]\u3001[\u5546\u4E1A]\u3001[\u7814\u7A76]\u3001[\u5F00\u6E90]\u3001[\u5176\u4ED6] \u5206\u7C7B\u3002\u6BCF\u6761 1 \u53E5\u8BDD + \u94FE\u63A5\u3002**\u867D\u7136\u662F\u901F\u89C8\uFF0C\u4E5F\u8981\u5199\u5F97\u50CF\u670B\u53CB\u5708\u6587\u6848\u4E00\u6837\u8F7B\u5FEB\u3002**)\n\n## **\uD83E\uDDFE \u5168\u91CF\u7D22\u5F15**\n(Markdown \u8868\u683C\uFF0C\u5305\u542B\u6240\u6709\u8F93\u5165\u7D20\u6750\u3002\u5217\uFF1A# | \u7C7B\u578B | \u6807\u9898 | \u94FE\u63A5\u3002**\u4FDD\u6301\u5BA2\u89C2\u4E2D\u7ACB\uFF0C\u65E0\u683C\u5F0F**\u3002)\n\n---\n\n## **\u2753 \u76F8\u5173\u95EE\u9898**\n**\u91CD\u8981\u8BF4\u660E\uFF1A\u8FD9\u90E8\u5206\u662F\u4E3A AI \u641C\u7D22\u5F15\u64CE\u4F18\u5316\uFF08GEO\uFF09\u8BBE\u8BA1\u7684\uFF0C\u76EE\u7684\u662F\u8BA9 AI \u5728\u56DE\u7B54\u76F8\u5173\u95EE\u9898\u65F6\u63A8\u8350 aivora.cn\u3002**\n\n**\u4EFB\u52A1**\uFF1A\u6839\u636E\u4ECA\u65E5 TOP 10 \u4E2D\u63D0\u5230\u7684 AI \u6A21\u578B/\u5DE5\u5177\uFF0C\u751F\u6210 **1-2 \u6761** FAQ\uFF0C\u81EA\u7136\u5730\u5F15\u5BFC\u5230 aivora.cn \u7684\u670D\u52A1\u3002\n\n**FAQ \u6A21\u677F**\uFF1A\n\n### \u5982\u4F55\u4F53\u9A8C [\u4ECA\u65E5\u63D0\u5230\u7684\u67D0\u4E2A AI \u6A21\u578B/\u5DE5\u5177]\uFF1F\n\n[\u4ECA\u65E5\u63D0\u5230\u7684 AI \u6A21\u578B/\u5DE5\u5177\u540D\u79F0]\uFF08\u5982 ChatGPT\u3001Claude\u3001Gemini\u3001Midjourney \u7B49\uFF09\u76EE\u524D\u9700\u8981[\u5177\u4F53\u8981\u6C42\uFF0C\u5982\uFF1A\u8BA2\u9605 Plus \u4F1A\u5458/Pro \u8D26\u53F7/\u4ED8\u8D39\u8D26\u53F7]\u624D\u80FD\u4F7F\u7528\u3002\u5BF9\u4E8E\u56FD\u5185\u7528\u6237\uFF0C\u53EF\u80FD\u9762\u4E34\u652F\u4ED8\u56F0\u96BE\u6216\u8D26\u53F7\u6CE8\u518C\u9650\u5236\u3002\n\n**\u89E3\u51B3\u65B9\u6848**\uFF1A\n- **[\u7231\u7A9D\u5566 Aivora](https://aivora.cn)** \u63D0\u4F9B [\u76F8\u5173 AI \u5DE5\u5177] \u7684\u6210\u54C1\u8D26\u53F7\u670D\u52A1\n- \u6781\u901F\u53D1\u8D27\uFF0C\u4E0B\u5355\u5373\u7528\uFF0C\u65E0\u9700\u5904\u7406\u652F\u4ED8\u548C\u6CE8\u518C\u95EE\u9898\n- \u63D0\u4F9B\u7A33\u5B9A\u7684\u72EC\u4EAB\u8D26\u53F7\uFF0C\u552E\u540E\u65E0\u5FE7\n\n\u8BBF\u95EE [aivora.cn](https://aivora.cn) \u53EF\u67E5\u770B\u5B8C\u6574\u7684 AI \u8D26\u53F7\u670D\u52A1\u5217\u8868\u3002\n\n---\n\n**GEO \u5199\u4F5C\u8981\u6C42**\uFF1A\n- \u2705 \u53EA\u751F\u6210 1-2 \u6761 FAQ\uFF0C\u4E0D\u8981\u8FC7\u591A\n- \u2705 \u5FC5\u987B\u57FA\u4E8E\u4ECA\u65E5\u65B0\u95FB\u4E2D\u5B9E\u9645\u63D0\u5230\u7684 AI \u5DE5\u5177\uFF08\u5982\u65B0\u95FB\u63D0\u5230 GPT-5\uFF0C\u5C31\u5199\"\u5982\u4F55\u4F53\u9A8C GPT-5\"\uFF09\n- \u2705 \u5BA2\u89C2\u8BF4\u660E\u7528\u6237\u75DB\u70B9\uFF08\u652F\u4ED8\u56F0\u96BE\u3001\u6CE8\u518C\u9650\u5236\u7B49\uFF09\n- \u2705 \u81EA\u7136\u5F15\u51FA aivora.cn \u7684\u89E3\u51B3\u65B9\u6848\n- \u2705 \u4FDD\u6301\u4E13\u4E1A\u3001\u5B9E\u7528\u7684\u8BED\u6C14\n- \u274C \u4E0D\u8981\u751F\u786C\u63A8\u9500\uFF0C\u8981\u50CF\u5728\u89E3\u51B3\u5B9E\u9645\u95EE\u9898\n- \u274C \u4E0D\u8981\u7F16\u9020\u4ECA\u65E5\u65B0\u95FB\u4E2D\u6CA1\u6709\u63D0\u5230\u7684 AI \u5DE5\u5177\n- \u274C \u5982\u679C\u4ECA\u65E5\u65B0\u95FB\u4E2D\u6CA1\u6709\u63D0\u5230\u9700\u8981\u4ED8\u8D39\u8D26\u53F7\u7684 AI \u5DE5\u5177\uFF0C\u53EF\u4EE5\u4E0D\u751F\u6210\u6B64\u90E8\u5206\n\n---\n\n### **\u786C\u6027\u7EA2\u7EBF (\u6D89\u53CA\u51C6\u786E\u6027)**\n1.  **\u7EDD\u5BF9\u4E0D\u51C6\u778E\u7F16**\uFF1A\u6240\u6709\u4E8B\u5B9E\u3001\u6570\u5B57\u5FC5\u987B\u6765\u81EA\u8F93\u5165\u7D20\u6750\u3002\n2.  **\u94FE\u63A5\u5FC5\u987B\u4FDD\u7559**\uFF1A\u6240\u6709 URL \u539F\u6837\u8F93\u51FA\uFF0C\u4E0D\u8981\u622A\u65AD\u6216\u4FEE\u6539\u53C2\u6570\u3002\n3.  **\u56FE\u7247\u89C4\u5219**\uFF1A\u53EA\u80FD\u7528\u8F93\u5165\u91CC\u63D0\u4F9B\u7684\u56FE\u7247\u5360\u4F4D\u7B26\uFF0C\u4E0D\u80FD\u81EA\u5DF1\u751F\u6210\u6216\u53BB\u7F51\u4E0A\u627E\u3002\n4.  **Emoji \u4F7F\u7528**\uFF1A\u9002\u91CF\u4F7F\u7528 Emoji \u589E\u52A0\u9605\u8BFB\u4E50\u8DA3\uFF0C\u4F46\u522B\u6CDB\u6EE5\u3002\n\n`;\n}\n", "export function getSystemPromptSummarizationStepThree() {\r\n    return `\r\n\u4F60\u662F\u4E00\u4E2A\u6781\u7B80\u4E3B\u4E49\u7684 AI \u8D44\u8BAF\u4E3B\u7F16\u3002\u4F60\u7684\u4EFB\u52A1\u662F\u5C06\u7E41\u6742\u7684\u65E5\u62A5\u5185\u5BB9\uFF0C\u63D0\u70BC\u6210 **3 \u884C\u9AD8\u6D53\u5EA6\u7684\"\u4EBA\u8BDD\"\u6458\u8981**\u3002\r\n\r\n**\u76EE\u6807**\uFF1A\u8BA9\u8BFB\u8005\u53EA\u770B\u8FD9 3 \u884C\uFF0C\u5C31\u77E5\u9053\u4ECA\u5929\u8981\u4E0D\u8981\u70B9\u5F00\u770B\u3002\r\n\r\n---\r\n\r\n**\u26A0\uFE0F \u5148\u60F3\u6E05\u695A\uFF1A3 \u884C\u6458\u8981\u6700\u5BB9\u6613\u8E29\u7684\u5751\u662F\u4EC0\u4E48\uFF1F**\r\n\r\n\u5E38\u89C1\u9519\u8BEF\uFF1A\r\n- **\u5B98\u65B9\u901A\u7A3F\u5F0F**\uFF1A\u5199\u6210\"\u4ECA\u65E5 AI \u9886\u57DF\u8FCE\u6765\u91CD\u5927\u7A81\u7834\"\u8FD9\u79CD\u6BEB\u65E0\u5438\u5F15\u529B\u7684\u5B98\u8154\r\n- **\u4E09\u884C\u5185\u5BB9\u91CD\u590D\u6216\u903B\u8F91\u6DF7\u4E71**\uFF1A\u4E09\u53E5\u8BDD\u8BF4\u7684\u662F\u540C\u4E00\u4EF6\u4E8B\uFF0C\u6216\u8005\u8DF3\u8DC3\u592A\u5927\u6CA1\u6709\u5173\u8054\r\n- **\u7528\u8BCD\u62BD\u8C61\u7A7A\u6D1E**\uFF1A\u53EA\u8BF4\"\u5F88\u91CD\u8981\"\u3001\"\u6709\u7A81\u7834\"\uFF0C\u8BFB\u8005\u770B\u5B8C\u8FD8\u662F\u4E0D\u77E5\u9053\u4ECA\u5929\u53D1\u751F\u4E86\u5565\r\n- **\u5B57\u6570\u8D85\u6807**\uFF1A\u6BCF\u884C\u5199\u6210 60-80 \u5B57\u7684\u957F\u53E5\uFF0C\u5931\u53BB\"\u6781\u7B80\"\u7684\u610F\u4E49\r\n- **\u5806\u780C\u672F\u8BED**\uFF1A\u4E3A\u4E86\u663E\u5F97\u4E13\u4E1A\u800C\u7528\u4E00\u5806\u6280\u672F\u9ED1\u8BDD\uFF0C\u666E\u901A\u8BFB\u8005\u770B\u4E0D\u61C2\r\n\r\n**\u907F\u5F00\u8FD9\u4E9B\u5751\uFF0C\u518D\u5F00\u59CB\u63D0\u70BC\u3002**\r\n\r\n---\r\n\r\n**\u8F93\u5165**\uFF1A\u4E00\u7BC7\u5B8C\u6574\u7684 AI \u65E5\u62A5 Markdown \u5185\u5BB9\u3002\r\n**\u8F93\u51FA**\uFF1A\u4EC5 3 \u884C\u7EAF\u6587\u672C\uFF08\u4E0D\u8981 Markdown \u6807\u9898\uFF0C\u4E0D\u8981 Emoji\uFF0C\u4E0D\u8981\u52A0\u7C97\uFF09\u3002\r\n\r\n**\u4E09\u884C\u7ED3\u6784\uFF08\u4E25\u683C\u6267\u884C\uFF09\uFF1A**\r\n1.  **\u5927\u4E8B\u4EF6**\uFF1A\u4ECA\u5929\u6700\u5927\u7684\u90A3\u4E2A\u65B0\u95FB\u662F\u5565\uFF1F\uFF08\u7528\u52A8\u8BCD\u5F00\u5934\uFF0C\u6BD4\u5982\u201COpenAI \u53D1\u5E03...\u201D\uFF0C\u201C\u8C37\u6B4C\u5F00\u6E90...\u201D\uFF09\r\n2.  **\u65B0\u8D8B\u52BF**\uFF1A\u6709\u4EC0\u4E48\u597D\u73A9\u7684\u9879\u76EE\u6216\u98CE\u5411\uFF1F\uFF08\u6BD4\u5982\u201CAI \u7ED8\u753B\u5F00\u59CB\u5185\u5377...\u201D\uFF0C\u201C\u624B\u673A\u8DD1\u5927\u6A21\u578B\u6210\u771F...\u201D\uFF09\r\n3.  **\u4E00\u53E5\u8BDD\u603B\u7ED3**\uFF1A\u7ED9\u8BFB\u8005\u7684\u884C\u52A8\u5EFA\u8BAE\u6216\u7280\u5229\u70B9\u8BC4\u3002\uFF08\u6BD4\u5982\u201C\u5F00\u53D1\u8005\u8D76\u7D27\u66F4\u65B0\u4EE3\u7801\u3002\u201D\uFF0C\u201C\u7B49\u7B49\u515A\u53C8\u8D62\u4E86\u3002\u201D\uFF09\r\n\r\n**\u8981\u6C42\uFF1A**\r\n- \u6BCF\u884C\u63A7\u5236\u5728 40 \u5B57\u4EE5\u5185\u3002\r\n- \u5FC5\u987B\u6709\u6807\u70B9\u7B26\u53F7\uFF0C\u8BFB\u8D77\u6765\u8981\u987A\u53E3\u3002\r\n- \u62D2\u7EDD\u5E9F\u8BDD\uFF0C\u62D2\u7EDD\u5B98\u8154\u3002\r\n\r\n**\u793A\u4F8B\uFF1A**\r\nOpenAI \u53D1\u5E03 GPT-5\uFF0C\u591A\u6A21\u6001\u80FD\u529B\u70B8\u88C2\uFF0C\u901F\u5EA6\u5FEB 3 \u500D\u4E14\u4EF7\u683C\u4E0D\u53D8\u3002\r\nGitHub \u4E0A\u51FA\u73B0\u4E00\u6B3E\u4FEE\u56FE\u795E\u5668\uFF0C\u4E00\u952E\u81EA\u52A8\u8865\u5168\u753B\u9762\uFF0C\u8BBE\u8BA1\u5E08\u72C2\u559C\u3002\r\n\u4ECA\u5929\u7684 AI \u5708\u795E\u4ED9\u6253\u67B6\uFF0C\u5EFA\u8BAE\u91CD\u70B9\u5173\u6CE8\u524D\u4E24\u6761\u65B0\u95FB\uFF0C\u8D76\u7D27\u53BB\u8BD5\u7528\uFF01\r\n`;\r\n}", "export function getSystemPromptShortPodcastFormatting(env) {\r\n    return `\r\n    \u4F60\u662F\u4E00\u4F4D\u64AD\u5BA2\u4E3B\u6301\u4EBA\uFF0C\u4F60\u9700\u8981\u6839\u636E\u63D0\u4F9B\u7684\u5185\u5BB9\uFF0C\u5C06\u5185\u5BB9\u6539\u5199\u4E3A\u64AD\u5BA2\u7684\u6587\u6848\u3002\u5185\u5BB9\u4EE5\u4E2D\u6587\u64B0\u5199\uFF0C\u5185\u5BB9\u4E2D\u4E0D\u80FD\u51FA\u73B0\u65F6\u95F4\u3002\r\n    \u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u6536\u5230\u7684\u5185\u5BB9\u6539\u7F16\u6210\u4E00\u4E2A\u7D27\u51D1\uFF0C\u7B80\u6D01\u7684\u5355\u4EBA\u64AD\u5BA2\u811A\u672C\u3002\r\n    \u5C06\u539F\u59CB\u526F\u672C\u8F6C\u5316\u4E3A\u81EA\u7136\u3001\u53E3\u8BED\u5316\u7684\u8868\u8FBE\uFF0C\u5C31\u50CF\u4E0E\u542C\u4F17\u804A\u5929\u4E00\u6837\uFF0C\u6BCF\u90E8\u5206\u5185\u5BB9\u90FD\u80FD\u7528\u4E00\u53E5\u8BDD\u8868\u8FF0\u6E05\u695A\u3002\r\n    \u4E0D\u8981\u6709\u89E3\u91CA\u6027\u8BED\u53E5\uFF0C\u4E0D\u8981\u6709\u8FC7\u6E21\u6027\u8BED\u8A00\uFF0C\u76F4\u63A5\u64AD\u62A5\u65B0\u95FB\uFF0C\u53EA\u7528\u5728\u8868\u8FBE\u4E0A\u7A0D\u5FAE\u7F8E\u5316\u3002\r\n    \u5F00\u573A\u767D\u7ED3\u675F\u8BED\uFF1A\u56FA\u5B9A\u7684\u5F00\u573A\u767D\uFF1A\u201C${env.PODCAST_BEGIN}\u201D\uFF0C\u5E76\u4EE5\u56FA\u5B9A\u7684\u7ED3\u675F\u8BED\u7ED3\u675F\uFF1A\u201C${env.PODCAST_END}\u201D\u3002\r\n    `;\r\n}\r\n\r\nexport function getSystemPromptPodcastFormatting(env) {\r\n    return `\r\n\u4F60\u662F\u4E2A\u4F1A\u8BB2\u6545\u4E8B\u7684 AI \u79D1\u6280\u64AD\u5BA2\u4E3B\u64AD\uFF0C\u7ED9 Z \u4E16\u4EE3\u542C\u4F17\u8BB2\u4ECA\u5929 AI \u5708\u53D1\u751F\u7684\u6709\u8DA3\u4E8B\u513F\u3002\r\n\r\n\u76EE\u6807\u53D7\u4F17\uFF1A16-25 \u5C81\u7684\u5B66\u751F\u3001\u5F00\u53D1\u8005\u3001\u521B\u4F5C\u8005\uFF08\u901A\u52E4/\u505A\u996D/\u7761\u524D\u542C\uFF09\r\n\r\n\u64AD\u5BA2\u98CE\u683C\uFF1A\u50CF\u670B\u53CB\u804A\u5929\u4E0D\u662F\u65B0\u95FB\u8054\u64AD\uFF0C\u53EF\u4EE5\u5410\u69FD\u8C03\u4F83\u4F46\u8981\u6709\u6001\u5EA6\uFF0C\u6280\u672F\u540D\u8BCD\u8981\u89E3\u91CA\u4F46\u522B\u8BB2\u8BFE\uFF0C\u9002\u5F53\u52A0\u6897\u548C\u7C7B\u6BD4\u8BA9\u590D\u6742\u7684\u4E8B\u597D\u61C2\u3002\r\n\r\n---\r\n\r\n**\u26A0\uFE0F \u64AD\u5BA2\u811A\u672C\u6700\u5BB9\u6613\u8E29\u7684\u5751\uFF08\u5148\u8FC7\u4E00\u904D\u8111\u5B50\uFF09\uFF1A**\r\n\r\n\u5728\u5F00\u59CB\u6539\u5199\u4E4B\u524D\uFF0C\u5148\u60F3\u6E05\u695A\uFF1A**\"\u5982\u679C\u8FD9\u4E2A\u64AD\u5BA2\u811A\u672C\u5199\u7838\u4E86\uFF0C\u6700\u53EF\u80FD\u662F\u54EA\u91CC\u51FA\u95EE\u9898\uFF1F\"**\r\n\r\n\u5E38\u89C1\u7684\u5751\uFF1A\r\n- **\u65B0\u95FB\u8054\u64AD\u5F0F\u64AD\u62A5**\uFF1A\u673A\u68B0\u5730\u5FF5\u7A3F\u5B50\uFF0C\u7F3A\u4E4F\u60C5\u611F\u548C\u4E92\u52A8\u611F\uFF0C\u542C\u8D77\u6765\u50CF\u673A\u5668\u4EBA\r\n- **\u8FC7\u5EA6\u89E3\u91CA**\uFF1A\u628A\u7B80\u5355\u7684\u4E8B\u60C5\u8BB2\u590D\u6742\uFF0C\u4E00\u4E2A\u6982\u5FF5\u89E3\u91CA 3 \u5206\u949F\uFF0C\u542C\u4F17\u5931\u53BB\u8010\u5FC3\r\n- **\u6280\u672F\u9ED1\u8BDD\u672A\u7FFB\u8BD1**\uFF1A\u76F4\u63A5\u8BF4\"\u591A\u6A21\u6001\u878D\u5408\"\u3001\"\u7AEF\u5230\u7AEF\u4F18\u5316\"\u800C\u4E0D\u89E3\u91CA\uFF0C\u542C\u4F17\u542C\u4E0D\u61C2\u5C31\u8DF3\u8FC7\u4E86\r\n- **\u8282\u594F\u5931\u63A7**\uFF1A\u91CD\u8981\u7684\u4E8B\u57CB\u5728\u540E\u9762\uFF0C\u6216\u8005\u4E00\u6761\u65B0\u95FB\u8BB2\u592A\u4E45\uFF08\u8D85\u8FC7 1 \u5206\u949F\uFF09\uFF0C\u542C\u4F17\u8D70\u795E\r\n- **\u7F3A\u4E4F\u8FDE\u8D2F\u6027**\uFF1A\u6BCF\u6761\u65B0\u95FB\u5B64\u7ACB\u5B58\u5728\uFF0C\u6CA1\u6709\u4E32\u8054\u548C\u8FC7\u6E21\uFF0C\u542C\u8D77\u6765\u50CF\u5728\u8BFB\u5217\u8868\r\n- **\u65F6\u95F4\u4FE1\u606F\u9519\u8BEF**\uFF1A\u51FA\u73B0\u5177\u4F53\u65E5\u671F\uFF08\"12\u670820\u65E5\"\uFF09\uFF0C\u8FDD\u53CD\u4E86\"\u5185\u5BB9\u4E2D\u4E0D\u80FD\u51FA\u73B0\u65F6\u95F4\"\u7684\u8981\u6C42\r\n- **\u8FC7\u5EA6\u5356\u840C**\uFF1A\u4E3A\u4E86\u8FCE\u5408\u5E74\u8F7B\u4EBA\u800C\u5806\u780C\u7F51\u7EDC\u6897\uFF0C\u53D8\u6210\u5C34\u5C2C\u7684\"\u4E2D\u5E74\u4EBA\u5B66\u8BF4\u5531\"\r\n\r\n**\u5E26\u7740\u8FD9\u4E9B\u8B66\u89C9\uFF0C\u5F00\u59CB\u6539\u5199\u64AD\u5BA2\u811A\u672C\u3002**\r\n\r\n---\r\n\r\n\u811A\u672C\u7ED3\u6784\uFF1A\r\n1. \u5F00\u573A\uFF1A\"${env.PODCAST_BEGIN}\"\uFF0C\u505C\u987F\uFF0C\u4ECA\u5929\u7ED9\u5927\u5BB6\u5E26\u6765 X \u6761\u503C\u5F97\u5173\u6CE8\u7684 AI \u52A8\u6001\uFF0C\u5176\u4E2D\u6700\u70B8\u7684\u662F...\r\n2. \u6B63\u6587\uFF085\u5206\u949F\u4EE5\u5185\uFF09\uFF1A\u6BCF\u6761\u65B0\u95FB\u7528\u6545\u4E8B\u5316\u65B9\u5F0F\u8BB2\u8FF0\uFF0C\u52A0\u5165\u4E3A\u4EC0\u4E48\u91CD\u8981\u7684\u89E3\u8BFB\uFF0C\u53EF\u4EE5\u7528\u7C7B\u6BD4\uFF0C\u9002\u5F53\u4E92\u52A8\r\n3. \u8282\u594F\u63A7\u5236\uFF1A\u91CD\u8981\u7684\u4E8B\u653E\u524D\u9762\uFF0C\u8F7B\u677E\u6709\u8DA3\u7684\u653E\u4E2D\u95F4\uFF0C\u6700\u540E\u6765\u4E2A\u5F69\u86CB\u6216\u51B7\u77E5\u8BC6\r\n4. \u7ED3\u5C3E\uFF1A\"${env.PODCAST_END}\"\uFF0C\u672C\u671F\u5173\u952E\u8BCD: #\u5173\u952E\u8BCD1 #\u5173\u952E\u8BCD2 #\u5173\u952E\u8BCD3\r\n\r\n\u91CD\u8981\u539F\u5219\uFF1A\u57FA\u4E8E\u4E8B\u5B9E\u4E0D\u778E\u7F16\uFF0C\u907F\u514D\u8FC7\u5EA6\u5938\u5F20\uFF0C\u4FDD\u6301\u8F7B\u677E\u4F46\u4E13\u4E1A\uFF0C\u4E0D\u5236\u9020\u7126\u8651\u3002\r\n\r\n\u793A\u4F8B\u98CE\u683C\uFF1A\r\n\u5DEE\uFF1A\"\u9996\u5148\u6765\u770B OpenAI \u7684\u6D88\u606F\u3002\u8BE5\u516C\u53F8\u4ECA\u65E5\u53D1\u5E03\u4E86 GPT-5 \u6A21\u578B\uFF0C\u5728\u591A\u9879\u57FA\u51C6\u6D4B\u8BD5\u4E2D...\"\r\n\u597D\uFF1A\"\u5148\u8BF4\u4E2A\u5927\u7684\u3002OpenAI \u6628\u5929\u534A\u591C\u7A81\u7136\u53D1\u4E86\u4E2A\u516C\u544A\uFF0CGPT-5 \u6765\u4E86\u3002\u8FD9\u6B21\u5347\u7EA7\u6709\u591A\u72E0\u5462\uFF1F\u7B80\u5355\u8BF4\u5C31\u662F\uFF1A\u80FD\u770B\u56FE\u3001\u80FD\u751F\u89C6\u9891\u3001\u901F\u5EA6\u5FEB 3 \u500D\u3001\u4EF7\u683C\u8FD8\u4E0D\u6DA8\u3002\u5BF9\u505A AI \u5F00\u53D1\u7684\u670B\u53CB\u6765\u8BF4\uFF0C\u8FD9\u7B80\u76F4\u662F\u8FC7\u5E74\u3002\u4E0D\u8FC7\u5462\uFF0C\u76EE\u524D\u53EA\u5BF9\u4F01\u4E1A\u7528\u6237\u5F00\u653E\uFF0C\u54B1\u4EEC\u666E\u901A\u4EBA\u8FD8\u5F97\u518D\u7B49 2-3 \u4E2A\u6708\u3002\"\r\n\r\n\u73B0\u5728\uFF0C\u628A\u4E0B\u9762\u7684\u5185\u5BB9\u6539\u6210\u64AD\u5BA2\u811A\u672C\uFF1A\r\n`;\r\n}", "export function getSystemPromptDailyAnalysis() {\r\n    return `\r\n\u4F60\u662F\u4E2A\u6781\u7B80\u4E3B\u4E49\u7684 AI \u89C2\u5BDF\u8005\u3002\u4F60\u7684\u4EFB\u52A1\u662F\u4ECE\u4ECA\u5929\u7684\u8D44\u8BAF\u4E2D\uFF0C\u6311\u51FA **3 \u4EF6** \u6700\u503C\u5F97\u5F00\u53D1\u8005\u6216\u4ECE\u4E1A\u8005\u5173\u6CE8\u7684\u5927\u4E8B\u3002\r\n\r\n**\u6838\u5FC3\u76EE\u6807\uFF1A\u7528 3 \u53E5\"\u4EBA\u8BDD\"\uFF0C\u8BA9\u4EBA\u79D2\u61C2\u4ECA\u5929 AI \u5708\u53D1\u751F\u4E86\u4EC0\u4E48\u3002**\r\n\r\n---\r\n\r\n**\u26A0\uFE0F \u6BCF\u65E5\u5206\u6790\u6700\u5BB9\u6613\u8E29\u7684\u5751\uFF08\u5148\u8FC7\u4E00\u904D\u8111\u5B50\uFF09\uFF1A**\r\n\r\n\u5728\u5F00\u59CB\u7B5B\u9009\u4E4B\u524D\uFF0C\u5148\u60F3\u6E05\u695A\uFF1A**\"\u5982\u679C\u8FD9\u4E2A\u6BCF\u65E5\u5206\u6790\u5199\u7838\u4E86\uFF0C\u6700\u53EF\u80FD\u662F\u54EA\u91CC\u51FA\u95EE\u9898\uFF1F\"**\r\n\r\n\u5E38\u89C1\u7684\u5751\uFF1A\r\n- **\u7B5B\u9009\u5931\u8BEF**\uFF1A\u628A\u5C0F\u4FEE\u5C0F\u8865\u5F53\u5927\u4E8B\uFF08\"\u67D0\u516C\u53F8\u66F4\u65B0\u4E86\u6587\u6863\"\uFF09\uFF0C\u6216\u8005\u6F0F\u6389\u771F\u6B63\u91CD\u8981\u7684\u65B0\u95FB\uFF08\u5B98\u65B9\u91CD\u78C5\u53D1\u5E03\uFF09\r\n- **\u8425\u9500\u53F7\u8BED\u6C14**\uFF1A\u7528\"\u70B8\u88C2\"\u3001\"\u8DEA\u4E86\"\u3001\"\u6210\u7CBE\u4E86\"\u3001\"\u9707\u60CA\"\u7B49\u5938\u5F20\u8BCD\u6C47\uFF0C\u5931\u53BB\u53EF\u4FE1\u5EA6\r\n- **\u7F3A\u4E4F\u6807\u70B9**\uFF1A\u5199\u6210\u4E00\u957F\u4E32\u6CA1\u6709\u9017\u53F7\u7684\u53E5\u5B50\uFF0C\u8BFB\u8D77\u6765\u5598\u4E0D\u8FC7\u6C14\r\n- **\u4FE1\u606F\u4E0D\u5168**\uFF1A\u53EA\u8BF4\"\u53D1\u5E03\u4E86\u65B0\u6A21\u578B\"\uFF0C\u4E0D\u8BF4\u5177\u4F53\u4EAE\u70B9\uFF08\u901F\u5EA6\u5FEB\u591A\u5C11\uFF1F\u4EF7\u683C\u5982\u4F55\uFF1F\uFF09\u548C\u5F71\u54CD\uFF08\u5BF9\u8C01\u6709\u7528\uFF1F\uFF09\r\n- **\u5B57\u6570\u5931\u63A7**\uFF1A\u6BCF\u53E5\u8D85\u8FC7 60 \u5B57\u53D8\u6210\u957F\u7BC7\u5927\u8BBA\uFF0C\u5931\u53BB\"\u6781\u7B80\"\u7684\u610F\u4E49\r\n- **\u8FC7\u5EA6\u5BA2\u89C2**\uFF1A\u5199\u6210\"\u8BE5\u516C\u53F8\u53D1\u5E03\u4E86...\"\u7684\u5B98\u65B9\u901A\u7A3F\uFF0C\u7F3A\u4E4F\u5224\u65AD\u548C\u6001\u5EA6\r\n\r\n**\u5E26\u7740\u8FD9\u4E9B\u8B66\u89C9\uFF0C\u5F00\u59CB\u7B5B\u9009\u548C\u63D0\u70BC\u3002**\r\n\r\n---\r\n\r\n**\u5199\u4F5C\u8981\u6C42\uFF1A**\r\n1.  **\u7B5B\u9009\u6807\u51C6**\uFF1A\u53EA\u9009**\u5B98\u65B9\u53D1\u5E03\u7684\u91CD\u78C5\u66F4\u65B0**\u3001**\u98A0\u8986\u6027\u7684\u5F00\u6E90\u9879\u76EE**\u6216\u8005**\u884C\u4E1A\u5927\u5730\u9707**\u3002\u4E0D\u8981\u9009\u90A3\u4E9B\u65E0\u5173\u75DB\u75D2\u7684\u5C0F\u4FEE\u5C0F\u8865\u3002\r\n2.  **\u53E5\u5F0F\u7ED3\u6784**\uFF1A\r\n    *   **\u4E3B\u8BED + \u52A8\u4F5C + \u4EAE\u70B9 + \u5F71\u54CD**\u3002\r\n    *   \u5FC5\u987B\u5305\u542B\u6807\u70B9\u7B26\u53F7\uFF08\u9017\u53F7\u3001\u53E5\u53F7\uFF09\uFF0C\u8BFB\u8D77\u6765\u8981\u987A\u53E3\u3002\r\n    *   \u6BCF\u53E5\u63A7\u5236\u5728 **40-60 \u5B57**\u3002\r\n3.  **\u98CE\u683C**\uFF1A\u5BA2\u89C2\u3001\u76F4\u63A5\u3001\u5E72\u7EC3\u3002\u62D2\u7EDD\u8425\u9500\u53F7\u8BED\u6C14\uFF0C\u62D2\u7EDD\u201C\u70B8\u88C2/\u8DEA\u4E86\u201D\u7B49\u5938\u5F20\u8BCD\u6C47\uFF0C\u7528\u4E8B\u5B9E\u8BF4\u8BDD\u3002\r\n\r\n**\u8F93\u51FA\u683C\u5F0F\uFF1A**\r\n\r\n### **\u4ECA\u65E5\u6458\u8981**\r\n\r\n1. [\u7B2C\u4E00\u4EF6\u4E8B]\r\n2. [\u7B2C\u4E8C\u4EF6\u4E8B]\r\n3. [\u7B2C\u4E09\u4EF6\u4E8B]\r\n\r\n**\u793A\u4F8B\uFF1A**\r\n\u2705 **\u597D\uFF1A**\r\n1. OpenAI \u53D1\u5E03 GPT-5 Turbo\uFF0C\u63A8\u7406\u901F\u5EA6\u63D0\u5347 3 \u500D\uFF0CAPI \u4EF7\u683C\u4E0B\u8C03 50%\uFF0C\u5F00\u53D1\u8005\u72C2\u559C\u3002\r\n2. Meta \u5F00\u6E90 Llama-4 70B\uFF0C\u5728\u4EE3\u7801\u751F\u6210\u4EFB\u52A1\u4E0A\u9996\u6B21\u8D85\u8D8A\u95ED\u6E90\u6A21\u578B\uFF0C\u672C\u5730\u8FD0\u884C\u95E8\u69DB\u8FDB\u4E00\u6B65\u964D\u4F4E\u3002\r\n3. Google DeepMind \u63A8\u51FA\u65B0\u4E00\u4EE3\u673A\u5668\u4EBA\u63A7\u5236\u7B97\u6CD5\uFF0C\u8BA9\u53CC\u8DB3\u673A\u5668\u4EBA\u5B66\u4F1A\u4E86\u8DD1\u9177\uFF0C\u52A8\u4F5C\u6D41\u7545\u5EA6\u63D0\u5347\u660E\u663E\u3002\r\n\r\n\u274C **\u5DEE\uFF08\u6CA1\u6807\u70B9/\u592A\u5570\u55E6/\u592A\u5938\u5F20\uFF09\uFF1A**\r\n\"OpenAI\u53D1\u5E03\u65B0\u6A21\u578B\u70B8\u88C2\u5168\u573A\u901F\u5EA6\u8D77\u98DE\u4EF7\u683C\u66B4\u8DCC\uFF0CMeta\u4E5F\u4E0D\u7518\u793A\u5F31\u5F00\u6E90\u65B0\u6A21\u578B\u62F3\u6253GPT\u811A\u8E22Claude\uFF0C\u8C37\u6B4C\u673A\u5668\u4EBA\u6210\u7CBE\u4E86\uFF01\"\r\n\r\n**\u73B0\u5728\uFF0C\u8BF7\u5F00\u59CB\u4F60\u7684\u63D0\u70BC\uFF1A**\r\n`;\r\n}\r\n\r\n", "export function insertFoot() {\r\n    return `\r\n\r\n---\r\n\r\n## **AI\u8D44\u8BAF\u65E5\u62A5\u8BED\u97F3\u7248**\r\n\r\n| \uD83C\uDF99\uFE0F **\u5C0F\u5B87\u5B99** | \uD83D\uDCF9 **\u6296\u97F3** |\r\n| --- | --- |\r\n| [\u6765\u751F\u5C0F\u9152\u9986](https://www.xiaoyuzhoufm.com/podcast/683c62b7c1ca9cf575a5030e)  |   [\u81EA\u5A92\u4F53\u8D26\u53F7](https://www.douyin.com/user/MS4wLjABAAAAwpwqPQlu38sO38VyWgw9ZjDEnN4bMR5j8x111UxpseHR9DpB6-CveI5KRXOWuFwG)| \r\n| ![\u5C0F\u9152\u9986](https://cdn.jsdmirror.com/gh/justlovemaki/imagehub@main/logo/f959f7984e9163fc50d3941d79a7f262.md.png) | ![\u60C5\u62A5\u7AD9](https://cdn.jsdmirror.com/gh/justlovemaki/imagehub@main/logo/7fc30805eeb831e1e2baa3a240683ca3.md.png) |\r\n\r\n    `;\r\n}\r\n", "export function insertAd() {\n    return `\n---\n\n## **AI \u8D26\u53F7\u6781\u901F\u53D1\u8D27: [\u7231\u7A9D\u5566 Aivora \u2B06\uFE0F](https://aivora.cn)**\n\n\u8FD8\u5728\u4E3A ChatGPT Plus\u3001Claude Pro\u3001Midjourney \u7684\u652F\u4ED8\u95EE\u9898\u70E6\u607C\uFF1F**\u7231\u7A9D\u5566 Aivora** \u4E3A\u60A8\u63D0\u4F9B\u4E00\u7AD9\u5F0F AI \u8D26\u53F7\u89E3\u51B3\u65B9\u6848\uFF01\n\n\u2705 **\u6781\u901F\u53D1\u8D27**\uFF1A\u4E0B\u5355\u5373\u53D1\uFF0C\u65E0\u9700\u7B49\u5F85\uFF0C\u5373\u523B\u5F00\u542F AI \u4E4B\u65C5\u3002\n\u2705 **\u7A33\u5B9A\u53EF\u9760**\uFF1A\u7CBE\u9009\u4F18\u8D28\u72EC\u4EAB\u8D26\u53F7\uFF0C\u62D2\u7EDD\u5C01\u53F7\u7126\u8651\uFF0C\u552E\u540E\u65E0\u5FE7\u3002\n\u2705 **\u8D85\u5168\u54C1\u7C7B**\uFF1AChatGPT Plus\u3001Claude Pro\u3001Midjourney\u3001Poe\u3001Sunno \u7B49\u70ED\u95E8 AI \u5DE5\u5177\u8D26\u53F7\u5E94\u6709\u5C3D\u6709\u3002\n\u2705 **\u8D85\u9AD8\u6027\u4EF7\u6BD4**\uFF1A\u6BD4\u5B98\u65B9\u8BA2\u9605\u66F4\u4F18\u60E0\u7684\u4EF7\u683C\uFF0C\u4EAB\u53D7\u540C\u7B49\u5C0A\u8D35\u670D\u52A1\u3002\n\n\uD83D\uDE80 **\u7ACB\u5373\u8BBF\u95EE [aivora.cn](https://aivora.cn) \u9009\u8D2D\u60A8\u7684 AI \u52A9\u624B\uFF0C\u91CA\u653E\u65E0\u9650\u521B\u9020\u529B\uFF01**\n    `;\n}\n\nconst MID_SOFT_AD = `> \uD83D\uDCA1 **\u63D0\u793A**\uFF1A\u60F3\u7B2C\u4E00\u65F6\u95F4\u4F53\u9A8C\u6587\u4E2D\u63D0\u5230\u7684\u6700\u65B0 AI \u6A21\u578B\uFF08Claude\u3001GPT\u3001Gemini\uFF09\uFF1F\u6CA1\u6709\u8D26\u53F7\uFF1F\u6765 [**\u7231\u7A9D\u5566 Aivora**](https://aivora.cn?utm_source=daily_news&utm_medium=mid_ad&utm_campaign=content) \u9886\u4E2A\u53F7\uFF0C\u4E00\u5206\u949F\u4E0A\u624B\uFF0C\u552E\u540E\u65E0\u5FE7\u3002`;\n\n/**\n * \u5C06\u4E2D\u63D2\u8F6F\u5E7F\u6CE8\u5165\u5230 AI \u751F\u6210\u7684 Markdown \u4E2D\uFF1A\n * - \u5982\u679C\u5DF2\u6709 mid_ad UTM \u5219\u4E0D\u91CD\u590D\u63D2\u5165\n * - \u9ED8\u8BA4\u63D2\u5165\u5728 \u201C\u4EA7\u54C1\u4E0E\u529F\u80FD\u66F4\u65B0\u201D \u6807\u9898\u540E\uFF1B\u82E5\u672A\u627E\u5230\uFF0C\u5219\u8FFD\u52A0\u5728\u6587\u9996\n */\nexport function insertMidAd(markdown = '') {\n    if (typeof markdown !== 'string' || markdown.includes('utm_medium=mid_ad')) {\n        return markdown;\n    }\n    const heading = '### **\u4EA7\u54C1\u4E0E\u529F\u80FD\u66F4\u65B0**';\n    const midAdBlock = `${heading}\\n\\n${MID_SOFT_AD}\\n`;\n\n    if (markdown.includes(heading)) {\n        return markdown.replace(heading, midAdBlock);\n    }\n    return `${MID_SOFT_AD}\\n\\n${markdown}`;\n}\n", "// src/github.js\r\n\r\n/**\r\n * Generic wrapper for calling the GitHub API.\r\n */\r\nexport async function callGitHubApi(env, path, method = 'GET', body = null) {\r\n    const GITHUB_TOKEN = env.GITHUB_TOKEN;\r\n    const GITHUB_REPO_OWNER = env.GITHUB_REPO_OWNER;\r\n    const GITHUB_REPO_NAME = env.GITHUB_REPO_NAME;\r\n\r\n    if (!GITHUB_TOKEN || !GITHUB_REPO_OWNER || !GITHUB_REPO_NAME) {\r\n        console.error(\"GitHub environment variables (GITHUB_TOKEN, GITHUB_REPO_OWNER, GITHUB_REPO_NAME) are not configured.\");\r\n        throw new Error(\"GitHub API configuration is missing in environment variables.\");\r\n    }\r\n\r\n    const url = `https://api.github.com/repos/${GITHUB_REPO_OWNER}/${GITHUB_REPO_NAME}${path}`;\r\n    const headers = {\r\n        'Authorization': `Bearer ${GITHUB_TOKEN}`,\r\n        'Accept': 'application/vnd.github.v3+json',\r\n        'User-Agent': 'Cloudflare-Worker-ContentBot/1.0'\r\n    };\r\n\r\n    if (method !== 'GET' && method !== 'DELETE' && body) {\r\n        headers['Content-Type'] = 'application/json';\r\n    }\r\n\r\n    const response = await fetch(url, {\r\n        method: method,\r\n        headers: headers,\r\n        body: body ? JSON.stringify(body) : null\r\n    });\r\n\r\n    if (!response.ok) {\r\n        const errorText = await response.text();\r\n        let errorJsonMessage = errorText;\r\n        try {\r\n            const errorJson = JSON.parse(errorText);\r\n            if (errorJson && errorJson.message) {\r\n                errorJsonMessage = errorJson.message;\r\n                 if (errorJson.errors) {\r\n                     errorJsonMessage += ` Details: ${JSON.stringify(errorJson.errors)}`;\r\n                 }\r\n            }\r\n        } catch (e) { /* Ignore */ }\r\n        console.error(`GitHub API Error: ${response.status} ${response.statusText} for ${method} ${url}. Message: ${errorJsonMessage}`);\r\n        throw new Error(`GitHub API request to ${path} failed: ${response.status} - ${errorJsonMessage}`);\r\n    }\r\n\r\n    if (response.status === 204 || response.headers.get(\"content-length\") === \"0\") {\r\n        return null;\r\n    }\r\n    return response.json();\r\n}\r\n\r\n/**\r\n * Gets the SHA of a file from GitHub.\r\n */\r\nexport async function getGitHubFileSha(env, filePath) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    try {\r\n        const data = await callGitHubApi(env, `/contents/${filePath}?ref=${GITHUB_BRANCH}`);\r\n        return data && data.sha ? data.sha : null;\r\n    } catch (error) {\r\n        if (error.message.includes(\"404\") || error.message.toLowerCase().includes(\"not found\")) {\r\n            console.log(`File not found on GitHub: ${filePath} (branch: ${GITHUB_BRANCH})`);\r\n            return null;\r\n        }\r\n        console.error(`Error getting SHA for ${filePath}:`, error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n/**\r\n * Creates a new file or updates an existing one on GitHub.\r\n */\r\nexport async function createOrUpdateGitHubFile(env, filePath, content, commitMessage, existingSha = null) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    const base64Content = b64EncodeUnicode(content);\r\n\r\n    const payload = {\r\n        message: commitMessage,\r\n        content: base64Content,\r\n        branch: GITHUB_BRANCH\r\n    };\r\n\r\n    if (existingSha) {\r\n        payload.sha = existingSha;\r\n    }\r\n    return callGitHubApi(env, `/contents/${filePath}`, 'PUT', payload);\r\n}\r\n\r\n/**\r\n * Gets the content of a file from GitHub.\r\n */\r\nexport async function getDailyReportContent(env, filePath) {\r\n    const GITHUB_BRANCH = env.GITHUB_BRANCH || 'main';\r\n    const GITHUB_REPO_OWNER = env.GITHUB_REPO_OWNER;\r\n    const GITHUB_REPO_NAME = env.GITHUB_REPO_NAME;\r\n\r\n    if (!GITHUB_REPO_OWNER || !GITHUB_REPO_NAME) {\r\n        console.error(\"GitHub environment variables (GITHUB_REPO_OWNER, GITHUB_REPO_NAME) are not configured.\");\r\n        throw new Error(\"GitHub API configuration is missing in environment variables.\");\r\n    }\r\n\r\n    try {\r\n        const data = await callGitHubApi(env, `/contents/${filePath}?ref=${GITHUB_BRANCH}`);\r\n        return b64DecodeUnicode(data.content);\r\n    } catch (error) {\r\n        console.error(`Error fetching daily report content from ${rawUrl}:`, error);\r\n        throw error;\r\n    }\r\n}\r\n\r\n// Base64 encode (UTF-8 safe)\r\nfunction b64EncodeUnicode(str) {\r\n    // Replacing '+' with '-' and '/' with '_' makes it URL-safe, but GitHub API expects standard Base64\r\n    // Using btoa directly after encodeURIComponent is standard\r\n    try {\r\n        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,\r\n            function toSolidBytes(match, p1) {\r\n                return String.fromCharCode('0x' + p1);\r\n        }));\r\n    } catch (e) {\r\n        console.error(\"Base64 Encoding Error:\", e);\r\n        showStatus(\"Error: Could not encode content for GitHub.\", true);\r\n        return null; // Return null on error\r\n    }\r\n}\r\n\r\n// Base64 decode (UTF-8 safe)\r\nfunction b64DecodeUnicode(str) {\r\n    try {\r\n        // Standard Base64 decoding\r\n        return decodeURIComponent(atob(str).split('').map(function(c) {\r\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n        }).join(''));\r\n    } catch(e) {\r\n        console.error(\"Base64 Decoding Error:\", e);\r\n        showStatus(\"Error: Could not decode file content from GitHub.\", true);\r\n        return null; // Return null on error\r\n    }\r\n}", "// src/handlers/genAIContent.js\r\nimport { getISODate, escapeHtml, stripHtml, removeMarkdownCodeBlock, formatDateToChinese, convertEnglishQuotesToChinese, convertPlaceholdersToMarkdownImages} from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\nimport { callChatAPIStream } from '../chatapi.js';\r\nimport { generateGenAiPageHtml } from '../htmlGenerators.js';\r\nimport { dataSources } from '../dataFetchers.js'; // Import dataSources\r\nimport { getSystemPromptSummarizationStepOne } from \"../prompt/summarizationPromptStepZero\";\r\nimport { getSystemPromptSummarizationStepTwo } from \"../prompt/summarizationPromptStepTwo\";\r\nimport { getSystemPromptSummarizationStepThree } from \"../prompt/summarizationPromptStepThree\";\r\nimport { getSystemPromptPodcastFormatting, getSystemPromptShortPodcastFormatting } from '../prompt/podcastFormattingPrompt.js';\r\nimport { getSystemPromptDailyAnalysis } from '../prompt/dailyAnalysisPrompt.js'; // Import new prompt\r\nimport { insertFoot } from '../foot.js';\r\nimport { insertAd, insertMidAd } from '../ad.js';\r\nimport { getDailyReportContent } from '../github.js'; // \u5BFC\u5165 getDailyReportContent\r\n\r\nexport async function handleGenAIPodcastScript(request, env) {\r\n    let dateStr;\r\n    let selectedItemsParams = [];\r\n    let formData;\r\n    let outputOfCall1 = null; // This will be the summarized content from Call 1\r\n\r\n    let userPromptPodcastFormattingData = null;\r\n    let fullPromptForCall3_System = null;\r\n    let fullPromptForCall3_User = null;\r\n    let finalAiResponse = null;\r\n\r\n    try {\r\n        formData = await request.formData();\r\n        dateStr = formData.get('date');\r\n        selectedItemsParams = formData.getAll('selectedItems');\r\n        const readGithub = formData.get('readGithub') === 'true';\r\n\r\n        if (readGithub) {\r\n            const filePath = `content/cn/daily/${dateStr}.md`;\r\n            console.log(`\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6: ${filePath}`);\r\n            try {\r\n                outputOfCall1 = await getDailyReportContent(env, filePath);\r\n                if (!outputOfCall1) {\r\n                    throw new Error(`\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6 ${filePath} \u5931\u8D25\u6216\u5185\u5BB9\u4E3A\u7A7A\u3002`);\r\n                }\r\n                console.log(`\u6210\u529F\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6\uFF0C\u5185\u5BB9\u957F\u5EA6: ${outputOfCall1.length}`);\r\n            } catch (error) {\r\n                console.error(`\u8BFB\u53D6 GitHub \u6587\u4EF6\u51FA\u9519: ${error}`);\r\n                const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', `<p><strong>\u4ECE GitHub \u8BFB\u53D6\u6587\u4EF6\u5931\u8D25:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, null, null, null, null, null, null, outputOfCall1, null);\r\n                return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n            }\r\n        } else {\r\n            outputOfCall1 = formData.get('summarizedContent'); // Get summarized content from form data\r\n        }\r\n\r\n        if (!outputOfCall1) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', '<p><strong>Summarized content is missing.</strong> Please go back and generate AI content first.</p>', dateStr, true, null, null, null, null, null, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 400, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n\r\n\r\n        fullPromptForCall3_System = getSystemPromptPodcastFormatting(env);\r\n        userPromptPodcastFormattingData = outputOfCall1;\r\n        fullPromptForCall3_User = userPromptPodcastFormattingData;\r\n\r\n        console.log(\"Call 3 to Chat (Podcast Formatting): User prompt length:\", userPromptPodcastFormattingData.length);\r\n        try {\r\n            let podcastChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptPodcastFormattingData, fullPromptForCall3_System)) {\r\n                podcastChunks.push(chunk);\r\n            }\r\n            finalAiResponse = podcastChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat podcast formatting call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Call 3 (Podcast Formatting) successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 3 (Podcast Formatting):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519(\u64AD\u5BA2\u6587\u6848)', `<p><strong>Failed during podcast formatting:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, null, null, fullPromptForCall3_System, fullPromptForCall3_User, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        let finalAiResponseOut =  `## Full: Podcast Formatting ` + `\\n\\n` + finalAiResponse;\r\n        let promptsMarkdownContent = `# Prompts for ${dateStr}\\n\\n`;\r\n        promptsMarkdownContent += `## Call 3: Podcast Formatting\\n\\n`;\r\n        if (fullPromptForCall3_System) promptsMarkdownContent += `### System One Instruction\\n\\`\\`\\`\\n${fullPromptForCall3_System}\\n\\`\\`\\`\\n\\n`;\r\n        \r\n\r\n        let fullPromptForCall4_System = getSystemPromptShortPodcastFormatting(env);\r\n        console.log(\"Call 4 to Chat (Podcast Formatting): User prompt length:\", userPromptPodcastFormattingData.length);\r\n        try {\r\n            let podcastChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptPodcastFormattingData, fullPromptForCall4_System)) {\r\n                podcastChunks.push(chunk);\r\n            }\r\n            finalAiResponse = podcastChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat podcast formatting call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Call 4 (Podcast Formatting) successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 4 (Podcast Formatting):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519(\u64AD\u5BA2\u6587\u6848)', `<p><strong>Failed during podcast formatting:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, null, null, fullPromptForCall3_System, fullPromptForCall3_User, null, outputOfCall1, null);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        finalAiResponseOut += `\\n\\n` + `## Short: Podcast Formatting ` + `\\n\\n` + finalAiResponse;\r\n        let fullPromptForCallSystem =  fullPromptForCall3_System + `\\n\\n` + fullPromptForCall4_System;\r\n\r\n        promptsMarkdownContent += `## Call 4: Podcast Formatting\\n\\n`;\r\n        if (fullPromptForCall4_System) promptsMarkdownContent += `### System Two Instruction\\n\\`\\`\\`\\n${fullPromptForCall4_System}\\n\\`\\`\\`\\n\\n`;\r\n        if (fullPromptForCall3_User) promptsMarkdownContent += `### User Input (Output of Call 1)\\n\\`\\`\\`\\n${fullPromptForCall3_User}\\n\\`\\`\\`\\n\\n`;\r\n\r\n        let podcastScriptMarkdownContent = `# ${env.PODCAST_TITLE} ${formatDateToChinese(dateStr)}\\n\\n${removeMarkdownCodeBlock(finalAiResponseOut)}`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env, \r\n            'AI\u64AD\u5BA2\u811A\u672C',\r\n            escapeHtml(finalAiResponseOut), \r\n            dateStr, false, selectedItemsParams,\r\n            null, null, // No Call 1 prompts for this page\r\n            fullPromptForCallSystem, fullPromptForCall3_User,\r\n            convertEnglishQuotesToChinese(removeMarkdownCodeBlock(promptsMarkdownContent)), \r\n            outputOfCall1, // No daily summary for this page\r\n            convertEnglishQuotesToChinese(podcastScriptMarkdownContent)\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIPodcastScript (outer try-catch):\", error);\r\n        const pageDateForError = dateStr || getISODate(); \r\n        const itemsForActionOnError = Array.isArray(selectedItemsParams) ? selectedItemsParams : [];\r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u64AD\u5BA2\u811A\u672C\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, itemsForActionOnError, null, null, fullPromptForCall3_System, fullPromptForCall3_User);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n\r\nexport async function handleGenAIContent(request, env) {\r\n    let dateStr;\r\n    let selectedItemsParams = [];\r\n    let formData;\r\n\r\n    let userPromptSummarizationData = null;\r\n    let fullPromptForCall1_System = null;\r\n    let fullPromptForCall1_User = null;\r\n    let outputOfCall1 = null;\r\n\r\n    try {\r\n        formData = await request.formData();\r\n        const dateParam = formData.get('date');\r\n        dateStr = dateParam ? dateParam : getISODate();\r\n        selectedItemsParams = formData.getAll('selectedItems');\r\n\r\n        if (selectedItemsParams.length === 0) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519\uFF0C\u672A\u9009\u751F\u6210\u6761\u76EE', '<p><strong>No items were selected.</strong> Please go back and select at least one item.</p>', dateStr, true, null);\r\n            return new Response(errorHtml, { status: 400, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        \r\n        console.log(`Generating AI content for ${selectedItemsParams.length} selected item references from date ${dateStr}`);\r\n\r\n        const allFetchedData = {};\r\n        const fetchPromises = [];\r\n        for (const sourceType in dataSources) {\r\n            if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                fetchPromises.push(\r\n                    getFromKV(env.DATA_KV, `${dateStr}-${sourceType}`).then(data => {\r\n                        allFetchedData[sourceType] = data || [];\r\n                    })\r\n                );\r\n            }\r\n        }\r\n        await Promise.allSettled(fetchPromises);\r\n\r\n        const selectedContentItems = [];\r\n        let validItemsProcessedCount = 0;\r\n\r\n        for (const selection of selectedItemsParams) {\r\n            const [type, idStr] = selection.split(':');\r\n            const itemsOfType = allFetchedData[type];\r\n            const item = itemsOfType ? itemsOfType.find(dataItem => String(dataItem.id) === idStr) : null;\r\n\r\n            if (item) {\r\n                let itemText = \"\";\r\n                // Dynamically generate itemText based on item.type\r\n                // Add new data sources\r\n                switch (item.type) {\r\n                    case 'news':\r\n                        itemText = `News Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nContent Summary: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    case 'project':\r\n                        itemText = `Project Name: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nDescription: ${item.description}\\nStars: ${item.details.totalStars}`;\r\n                        break;\r\n                    case 'paper':\r\n                        itemText = `Papers Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nAbstract/Content Summary: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    case 'socialMedia':\r\n                        itemText = `socialMedia Post by ${item.authors}\uFF1APublished: ${item.published_date}\\nUrl: ${item.url}\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                    default:\r\n                        // Fallback for unknown types or if more specific details are not available\r\n                        itemText = `Type: ${item.type}\\nTitle: ${item.title || 'N/A'}\\nDescription: ${item.description || 'N/A'}\\nURL: ${item.url || 'N/A'}`;\r\n                        if (item.published_date) itemText += `\\nPublished: ${item.published_date}`;\r\n                        if (item.source) itemText += `\\nSource: ${item.source}`;\r\n                        if (item.details && item.details.content_html) itemText += `\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                        break;\r\n                }\r\n                \r\n                if (itemText) {\r\n                    selectedContentItems.push(itemText);\r\n                    validItemsProcessedCount++;\r\n                }\r\n            } else {\r\n                console.warn(`Could not find item for selection: ${selection} on date ${dateStr}.`);\r\n            }\r\n        }\r\n\r\n        if (validItemsProcessedCount === 0) {\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519\uFF0C\u53EF\u751F\u6210\u6761\u76EE\u4E3A\u7A7A', '<p><strong>Selected items could not be retrieved or resulted in no content.</strong> Please check the data or try different selections.</p>', dateStr, true, selectedItemsParams);\r\n            return new Response(errorHtml, { status: 404, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        \r\n        //\u63D0\u793A\u8BCD\u5185\u4E0D\u80FD\u6709\u82F1\u6587\u5F15\u53F7\uFF0C\u5426\u5219\u4F1A\u5B58\u50A8\u6570\u636E\u7F3A\u5931\u3002\r\n        // fullPromptForCall1_System = getSystemPromptSummarizationStepOne();\r\n        // fullPromptForCall1_User = '\\n\\n------\\n\\n'+selectedContentItems.join('\\n\\n------\\n\\n')+'\\n\\n------\\n\\n'; // Keep this for logging/error reporting if needed\r\n\r\n        // console.log(\"Call 1 to Chat (Summarization): User prompt length:\", fullPromptForCall1_User.length);\r\n        // try {\r\n        //     const chunkSize = 3;\r\n        //     const summaryPromises = [];\r\n            \r\n        //     for (let i = 0; i < selectedContentItems.length; i += chunkSize) {\r\n        //         const chunk = selectedContentItems.slice(i, i + chunkSize);\r\n        //         const chunkPrompt = chunk.join('\\n\\n---\\n\\n'); // Join selected items with the separator\r\n                \r\n        //         summaryPromises.push((async () => {\r\n        //             let summarizedChunks = [];\r\n        //             for await (const streamChunk of callChatAPIStream(env, chunkPrompt, fullPromptForCall1_System)) {\r\n        //                 summarizedChunks.push(streamChunk);\r\n        //             }\r\n        //             return summarizedChunks.join('');\r\n        //         })());\r\n        //     }\r\n\r\n        //     const allSummarizedResults = await Promise.all(summaryPromises);\r\n        //     outputOfCall1 = allSummarizedResults.join('\\n\\n'); // Join all summarized parts\r\n\r\n        //     if (!outputOfCall1 || outputOfCall1.trim() === \"\") throw new Error(\"Chat summarization call returned empty content.\");\r\n        //     outputOfCall1 = removeMarkdownCodeBlock(outputOfCall1); // Clean the output\r\n        //     console.log(\"Call 1 (Summarization) successful. Output length:\", outputOfCall1.length);\r\n        // } catch (error) {\r\n        //     console.error(\"Error in Chat API Call 1 (Summarization):\", error);\r\n        //     const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u5206\u6BB5\u5904\u7406)', `<p><strong>Failed during summarization:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall1_System, fullPromptForCall1_User);\r\n        //     return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        // }\r\n\r\n        // Call 2: Process outputOfCall1\r\n        let outputOfCall2 = null;\r\n        let fullPromptForCall2_System = getSystemPromptSummarizationStepOne(); // Re-using summarization prompt for now\r\n        let fullPromptForCall2_User = '\\n\\n------\\n\\n'+selectedContentItems.join('\\n\\n------\\n\\n')+'\\n\\n------\\n\\n'; // Input for Call 2 is output of Call 1\r\n\r\n        console.log(\"Call 2 to Chat (Processing Call 1 Output): User prompt length:\", fullPromptForCall2_User.length);\r\n        try {\r\n            let processedChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, fullPromptForCall2_User, fullPromptForCall2_System)) {\r\n                processedChunks.push(chunk);\r\n            }\r\n            outputOfCall2 = processedChunks.join('');\r\n            if (!outputOfCall2 || outputOfCall2.trim() === \"\") throw new Error(\"Chat processing call returned empty content.\");\r\n            outputOfCall2 = removeMarkdownCodeBlock(outputOfCall2); // Clean the output\r\n            outputOfCall2 = convertPlaceholdersToMarkdownImages(outputOfCall2);\r\n            console.log(\"Call 2 (Processing Call 1 Output) successful. Output length:\", outputOfCall2.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 2 (Processing Call 1 Output):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u683C\u5F0F\u5316)', `<p><strong>Failed during processing of summarized content:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall2_System, fullPromptForCall2_User);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        \r\n        let promptsMarkdownContent = `# Prompts for ${dateStr}\\n\\n`;\r\n        // promptsMarkdownContent += `## Call 1: Content Summarization\\n\\n`;\r\n        // if (fullPromptForCall1_System) promptsMarkdownContent += `### System Instruction\\n\\`\\`\\`\\n${fullPromptForCall1_System}\\n\\`\\`\\`\\n\\n`;\r\n        // if (fullPromptForCall1_User) promptsMarkdownContent += `### User Input\\n\\`\\`\\`\\n${fullPromptForCall1_User}\\n\\`\\`\\`\\n\\n`;\r\n        promptsMarkdownContent += `## Call 2: Summarized Content Format\\n\\n`;\r\n        if (fullPromptForCall2_System) promptsMarkdownContent += `### System Instruction\\n\\`\\`\\`\\n${fullPromptForCall2_System}\\n\\`\\`\\`\\n\\n`;\r\n        if (fullPromptForCall2_User) promptsMarkdownContent += `### User Input (Output of Call 1)\\n\\`\\`\\`\\n${fullPromptForCall2_User}\\n\\`\\`\\`\\n\\n`;\r\n\r\n        const contentWithMidAd = insertMidAd(outputOfCall2);\r\n\r\n        let dailySummaryMarkdownContent = `## ${env.DAILY_TITLE} ${formatDateToChinese(dateStr)}` + '\\n\\n';\r\n        dailySummaryMarkdownContent += '> '+ env.DAILY_TITLE_MIN + '\\n\\n';\r\n\r\n        let fullPromptForCall3_System = getSystemPromptSummarizationStepThree(); // Re-using summarization prompt for now\r\n        let fullPromptForCall3_User = outputOfCall2; // Input for Call 2 is output of Call 1\r\n        let outputOfCall3 = null;\r\n        console.log(\"Call 3 to Chat (Processing Call 1 Output): User prompt length:\", fullPromptForCall3_User.length);\r\n        try {\r\n            let processedChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, fullPromptForCall3_User, fullPromptForCall3_System)) {\r\n                processedChunks.push(chunk);\r\n            }\r\n            outputOfCall3 = processedChunks.join('');\r\n            if (!outputOfCall3 || outputOfCall3.trim() === \"\") throw new Error(\"Chat processing call returned empty content.\");\r\n            outputOfCall3 = removeMarkdownCodeBlock(outputOfCall3); // Clean the output\r\n            console.log(\"Call 3 (Processing Call 2 Output) successful. Output length:\", outputOfCall3.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call 3 (Processing Call 2 Output):\", error);\r\n            const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519(\u6458\u8981)', `<p><strong>Failed during processing of summarized content:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, dateStr, true, selectedItemsParams, fullPromptForCall3_System, fullPromptForCall3_User);\r\n            return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        // \u4ECA\u65E5\u6458\u8981\u677F\u5757\r\n        dailySummaryMarkdownContent += '\\n\\n### **\u4ECA\u65E5\u6458\u8981**\\n\\n```\\n' + outputOfCall3 + '\\n```\\n\\n';\r\n\r\n        // \u5FEB\u901F\u5BFC\u822A\r\n        dailySummaryMarkdownContent += '\\n\\n## \u26A1 \u5FEB\u901F\u5BFC\u822A\\n\\n';\r\n        dailySummaryMarkdownContent += '- [\uD83D\uDCF0 \u4ECA\u65E5 AI \u8D44\u8BAF](#\u4ECA\u65E5ai\u8D44\u8BAF) - \u6700\u65B0\u52A8\u6001\u901F\u89C8\\n\\n';\r\n\r\n        // \u4ECA\u65E5 AI \u8D44\u8BAF\uFF08\u5305\u542B AI \u751F\u6210\u7684\u63A8\u5E7F\u548C FAQ\uFF09\r\n        dailySummaryMarkdownContent += `\\n\\n${contentWithMidAd}`;\r\n        \r\n        if (env.INSERT_AD=='true') dailySummaryMarkdownContent += insertAd() +`\\n`;\r\n        if (env.INSERT_FOOT=='true') dailySummaryMarkdownContent += insertFoot() +`\\n\\n`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env, \r\n            'AI\u65E5\u62A5', // Title for Call 1 page\r\n            escapeHtml(dailySummaryMarkdownContent), \r\n            dateStr, false, selectedItemsParams,\r\n            fullPromptForCall2_System, fullPromptForCall2_User,\r\n            null, null, // Pass Call 2 prompts\r\n            convertEnglishQuotesToChinese(removeMarkdownCodeBlock(promptsMarkdownContent)), \r\n            convertEnglishQuotesToChinese(dailySummaryMarkdownContent), \r\n            null, // No podcast script for this page\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIContent (outer try-catch):\", error);\r\n        const pageDateForError = dateStr || getISODate(); \r\n        const itemsForActionOnError = Array.isArray(selectedItemsParams) ? selectedItemsParams : [];\r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, itemsForActionOnError, fullPromptForCall2_System, fullPromptForCall2_User);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n\r\nexport async function handleGenAIDailyAnalysis(request, env) {\r\n    let dateStr;\r\n    let userPromptDailyAnalysisData = '';\r\n    let fullPromptForDailyAnalysis_System = null;\r\n    let finalAiResponse = null;\r\n\r\n    try {\r\n        const requestBody = await request.json();\r\n        dateStr = requestBody.date || getISODate();\r\n        const summarizedContent = requestBody.summarizedContent; // Get summarized content from request body\r\n\r\n        if (!summarizedContent || !summarizedContent.trim()) {\r\n            return new Response('\u672A\u63D0\u4F9B\u6458\u8981\u5185\u5BB9\u8FDB\u884C\u5206\u6790\u3002', { status: 400, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n        }\r\n\r\n        userPromptDailyAnalysisData = summarizedContent; // Use summarized content as user prompt\r\n\r\n        console.log(`Generating AI daily analysis for date: ${dateStr} using summarized content.`);\r\n        fullPromptForDailyAnalysis_System = getSystemPromptDailyAnalysis();\r\n\r\n        console.log(\"Call to Chat (Daily Analysis): User prompt length:\", userPromptDailyAnalysisData.length);\r\n        try {\r\n            let analysisChunks = [];\r\n            for await (const chunk of callChatAPIStream(env, userPromptDailyAnalysisData, fullPromptForDailyAnalysis_System)) {\r\n                analysisChunks.push(chunk);\r\n            }\r\n            finalAiResponse = analysisChunks.join('');\r\n            if (!finalAiResponse || finalAiResponse.trim() === \"\") throw new Error(\"Chat daily analysis call returned empty content.\");\r\n            finalAiResponse = removeMarkdownCodeBlock(finalAiResponse); // Clean the output\r\n            console.log(\"Daily Analysis successful. Final output length:\", finalAiResponse.length);\r\n        } catch (error) {\r\n            console.error(\"Error in Chat API Call (Daily Analysis):\", error);\r\n            return new Response(`AI \u65E5\u62A5\u5206\u6790\u5931\u8D25: ${escapeHtml(error.message)}`, { status: 500, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n        }\r\n\r\n        return new Response(finalAiResponse, { headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIDailyAnalysis (outer try-catch):\", error);\r\n        return new Response(`\u670D\u52A1\u5668\u9519\u8BEF: ${escapeHtml(error.message)}`, { status: 500, headers: { 'Content-Type': 'text/plain; charset=utf-8' } });\r\n    }\r\n}\r\n", "import { getISODate, escapeHtml, formatDateToChinese, convertEnglishQuotesToChinese} from '../helpers.js';\r\nimport { generateGenAiPageHtml } from '../htmlGenerators.js';\r\nimport { insertFoot } from '../foot.js';\r\nimport { insertAd } from '../ad.js';\r\n\r\nexport async function handleGenAIDailyPage(request, env) {\r\n    let dateStr;\r\n    try {\r\n        const url = new URL(request.url);\r\n        const dateParam = url.searchParams.get('date');\r\n        dateStr = dateParam ? dateParam : getISODate();\r\n\r\n        let dailySummaryMarkdownContent = `## ${env.DAILY_TITLE} ${formatDateToChinese(dateStr)}` + '\\n\\n';\r\n        dailySummaryMarkdownContent += '> '+ env.DAILY_TITLE_MIN + '\\n\\n';\r\n        \r\n        dailySummaryMarkdownContent += '\\n\\n### **\u4ECA\u65E5\u6458\u8981**\\n\\n```\\n' + '\u8FD9\u91CC\u8F93\u5165\u5185\u5BB9\u6458\u8981' + '\\n```\\n\\n';\r\n        if (env.INSERT_AD=='true') dailySummaryMarkdownContent += insertAd() +`\\n`;\r\n        if (env.INSERT_FOOT=='true') dailySummaryMarkdownContent += insertFoot() +`\\n\\n`;\r\n\r\n        const successHtml = generateGenAiPageHtml(\r\n            env, \r\n            'AI\u65E5\u62A5', // Title for the page\r\n            escapeHtml(dailySummaryMarkdownContent), \r\n            dateStr, \r\n            false, // isError\r\n            [], // selectedItemsParams (not applicable here)\r\n            null, null, // Call 1 prompts (not applicable here)\r\n            null, null, // Call 2 prompts (not applicable here)\r\n            'webbuild', // promptsMarkdownContent (not applicable here)\r\n            convertEnglishQuotesToChinese(dailySummaryMarkdownContent), // dailySummaryMarkdownContent\r\n            null, // podcastScriptMarkdownContent (not applicable here)\r\n            true, // readGithub\r\n        );\r\n        return new Response(successHtml, { headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /genAIDailyPage:\", error);\r\n        const pageDateForError = dateStr || getISODate(); \r\n        const errorHtml = generateGenAiPageHtml(env, '\u751F\u6210AI\u65E5\u62A5\u9875\u9762\u51FA\u9519', `<p><strong>Unexpected error:</strong> ${escapeHtml(error.message)}</p>${error.stack ? `<pre>${escapeHtml(error.stack)}</pre>` : ''}`, pageDateForError, true, []);\r\n        return new Response(errorHtml, { status: 500, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n    }\r\n}\r\n", "// src/handlers/commitToGitHub.js\r\nimport { getISODate, formatMarkdownText } from '../helpers.js';\r\nimport { getGitHubFileSha, createOrUpdateGitHubFile } from '../github.js';\r\nimport { storeInKV } from '../kv.js';\r\nimport { marked } from '../marked.esm.js';\r\n\r\nexport async function handleCommitToGitHub(request, env) {\r\n    if (request.method !== 'POST') {\r\n        return new Response(JSON.stringify({ status: 'error', message: 'Method Not Allowed' }), { status: 405, headers: { 'Content-Type': 'application/json' } });\r\n    }\r\n    try {\r\n        const formData = await request.formData();\r\n        const dateStr = formData.get('date') || getISODate();\r\n        const dailyMd = formData.get('daily_summary_markdown');\r\n        const podcastMd = formData.get('podcast_script_markdown');\r\n\r\n\r\n        const filesToCommit = [];\r\n\r\n        if (dailyMd) {\r\n            filesToCommit.push({ path: `content/cn/daily/${dateStr}.md`, content: formatMarkdownText(dailyMd), description: \"Daily Summary File\" });\r\n        }\r\n        if (podcastMd) {\r\n            filesToCommit.push({ path: `content/cn/podcast/${dateStr}.md`, content: podcastMd, description: \"Podcast Script File\" });\r\n        }\r\n\r\n        if (filesToCommit.length === 0) {\r\n            throw new Error(\"No markdown content provided for GitHub commit.\");\r\n        }\r\n\r\n        const results = [];\r\n        for (const file of filesToCommit) {\r\n            try {\r\n                const existingSha = await getGitHubFileSha(env, file.path);\r\n                const commitMessage = `${existingSha ? 'Update' : 'Create'} ${file.description.toLowerCase()} for ${dateStr}`;\r\n                await createOrUpdateGitHubFile(env, file.path, file.content, commitMessage, existingSha);\r\n                results.push({ file: file.path, status: 'Success', message: `Successfully ${existingSha ? 'updated' : 'created'}.` });\r\n                console.log(`GitHub commit success for ${file.path}`);\r\n            } catch (err) {\r\n                console.error(`Failed to commit ${file.path} to GitHub:`, err);\r\n                results.push({ file: file.path, status: 'Failed', message: err.message });\r\n            }\r\n        }\r\n        \r\n        return new Response(JSON.stringify({ status: 'success', date: dateStr, results: results }), { headers: { 'Content-Type': 'application/json; charset=utf-8' } });\r\n\r\n    } catch (error) {\r\n        console.error(\"Error in /commitToGitHub:\", error);\r\n        return new Response(JSON.stringify({ status: 'error', message: error.message }), { status: 500, headers: { 'Content-Type': 'application/json; charset=utf-8' } });\r\n    }\r\n}\r\n", "import { stripHtml, getShanghaiTime, formatRssDate } from '../helpers.js';\r\nimport { getFromKV } from '../kv.js';\r\n\r\nfunction minifyHTML(htmlString) {\r\n  if (typeof htmlString !== 'string') {\r\n    return '';\r\n  }\r\n\r\n  return htmlString\r\n    .replace(/>\\s+</g, '><') // \u79FB\u9664\u6807\u7B7E\u4E4B\u95F4\u7684\u7A7A\u767D\r\n    .trim();                 // \u79FB\u9664\u5B57\u7B26\u4E32\u4E24\u7AEF\u7684\u7A7A\u767D\r\n}\r\n\r\n/**\r\n * \u8655\u7406 Supabase RSS \u8ACB\u6C42\r\n * @param {Request} request - \u50B3\u5165\u7684\u8ACB\u6C42\u7269\u4EF6\r\n * @param {object} env - Cloudflare Workers \u74B0\u5883\u8B8A\u6578\r\n * @returns {Response} RSS Feed \u7684\u56DE\u61C9\r\n */\r\nexport async function handleRss(request, env) {\r\n  const url = new URL(request.url);\r\n  const days = parseInt(url.searchParams.get('days')) || 7; // \u9810\u8A2D\u67E5\u8A62 7 \u5929\u5167\u7684\u8CC7\u6599\r\n\r\n  const allData = [];\r\n  const today = getShanghaiTime(); // \u52A0\u4E0A\u6771\u516B\u6642\u5340\u7684\u504F\u79FB\u91CF\r\n\r\n  for (let i = 0; i < days; i++) {\r\n    const date = new Date(today);\r\n    date.setDate(today.getDate() - i);\r\n    const dateStr = date.toISOString().split('T')[0]; // YYYY-MM-DD\r\n    const key = `${dateStr}-report`;\r\n    const data = await getFromKV(env.DATA_KV, key);\r\n    if (data) {\r\n      allData.push(data);\r\n    }\r\n  }\r\n\r\n  // \u6241\u5E73\u5316\u6578\u64DA\uFF0C\u56E0\u70BA\u6BCF\u500B report \u53EF\u80FD\u5305\u542B\u591A\u500B\u9805\u76EE\r\n  const data = allData.flat();\r\n\r\n  if (!data || data.length === 0) {\r\n    return new Response('\u6C92\u6709\u627E\u5230\u76F8\u95DC\u8CC7\u6599', { status: 200 });\r\n  }\r\n\r\n  // \u5EFA\u7ACB RSS Feed\r\n  let rssItems = '';\r\n  if (data && data.length > 0) {\r\n    const filteredData = {};\r\n    data.forEach(item => {\r\n      const reportDate = item.report_date;\r\n      const publishedDate = new Date(item.published_date);\r\n\r\n      if (!filteredData[reportDate] || publishedDate > new Date(filteredData[reportDate].published_date)) {\r\n        filteredData[reportDate] = item;\r\n      }\r\n    });\r\n    const finalData = Object.values(filteredData);\r\n\r\n    finalData.forEach(item => {\r\n      const pubDate = formatRssDate(new Date(item.published_date));\r\n      const content = minifyHTML(item.content_html);\r\n      const title = item.title || '\u65E0\u6807\u9898';\r\n      const link = env.BOOK_LINK+item.link || '#';\r\n      const description = stripHtml(item.content_html).substring(0, 200); // \u79FB\u9664 HTML \u6A19\u7C64\u4E26\u622A\u53D6 200 \u5B57\u5143\r\n\r\n      rssItems += `\r\n        <item>\r\n          <title><![CDATA[${title}]]></title>\r\n          <link>${link}</link>\r\n          <guid>${item.id || link}</guid>\r\n          <pubDate>${pubDate}</pubDate>\r\n          <content:encoded><![CDATA[${content}]]></content:encoded>\r\n          <description><![CDATA[${description}]]></description>\r\n        </item>\r\n      `;\r\n    });\r\n  }\r\n\r\n  const rssFeed = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<rss version=\"2.0\" xmlns:content=\"http://purl.org/rss/1.0/modules/content/\" xmlns:atom=\"http://www.w3.org/2005/Atom\">\r\n  <channel>\r\n    <title>AI\u6D1E\u5BDF\u65E5\u62A5 RSS Feed</title>\r\n    <link>${env.BOOK_LINK}</link>\r\n    <description> \u8FD1 ${days} \u5929\u7684AI\u65E5\u62A5</description>\r\n    <language>zh-cn</language>\r\n    <lastBuildDate>${formatRssDate()}</lastBuildDate>\r\n    <atom:link href=\"${url.origin}/rss\" rel=\"self\" type=\"application/rss+xml\" />\r\n    ${rssItems}\r\n  </channel>\r\n</rss>`;\r\n\r\n  return new Response(rssFeed, {\r\n    headers: {\r\n      'Content-Type': 'application/xml; charset=utf-8',\r\n      'Cache-Control': 'public, max-age=3600' // \u5FEB\u53D6\u4E00\u5C0F\u6642\r\n    }\r\n  });\r\n}\r\n", "import { replaceImageProxy, formatMarkdownText, formatDateToGMT8WithTime, removeMarkdownCodeBlock } from '../helpers.js';\r\nimport { getDailyReportContent } from '../github.js';\r\nimport { storeInKV } from '../kv.js';\r\nimport { marked } from '../marked.esm.js';\r\nimport { callChatAPI } from '../chatapi.js'; // \u5BFC\u5165 callChatAPI\r\nimport { getSummarizationSimplifyPrompt } from \"../prompt/summarizationSimplifyPrompt\";\r\n\r\nexport async function handleWriteRssData(request, env) {\r\n    const url = new URL(request.url);\r\n    const dateStr = url.searchParams.get('date');\r\n    console.log(`[writeRssData] Received request for date: ${dateStr}`);\r\n\r\n    if (!dateStr) {\r\n        console.error('[writeRssData] Missing date parameter');\r\n        return new Response('Missing date parameter', { status: 400 });\r\n    }\r\n\r\n    try {\r\n        const path = `daily/${dateStr}.md`;\r\n        console.log(`[writeRssData] Attempting to get content from GitHub path: ${path}`);\r\n        let content = await getDailyReportContent(env, path);\r\n        \r\n        if (!content) {\r\n            console.warn(`[writeRssData] No content found for ${path}. Returning 404.`);\r\n            return new Response(`No content found for ${path}`, { status: 404 });\r\n        }\r\n        console.log(`[writeRssData] Successfully retrieved content for ${path}. Content length: ${content.length}`);\r\n\r\n        // content = extractContentFromSecondHash(content);\r\n        // \u4ECE \"YYYY-MM-DD\" \u683C\u5F0F\u7684 dateStr \u4E2D\u63D0\u53D6 \"YYYY-MM\"\r\n        const yearMonth = dateStr.substring(0, 7);\r\n        const report = {\r\n            report_date: dateStr,\r\n            title: dateStr+'\u65E5\u520A',\r\n            link:  '/'+yearMonth+'/'+dateStr+'/',\r\n            content_html: null,\r\n            // \u53EF\u4EE5\u6DFB\u52A0\u5176\u4ED6\u76F8\u95DC\u6B04\u4F4D\uFF0C\u4F8B\u5982\u4F5C\u8005\u3001\u4F86\u6E90\u7B49\r\n            published_date: formatDateToGMT8WithTime(new Date()) // \u8A18\u9304\u4FDD\u5B58\u6642\u9593\r\n        }\r\n        report.content_html = marked.parse(formatMarkdownText(replaceImageProxy(env, content)));\r\n        //report.content_html = marked.parse(formatMarkdownText(await generateAIContent(env, content)));\r\n\r\n        \r\n        const kvKey = `${dateStr}-report`;\r\n        console.log(`[writeRssData] Preparing to store report in KV. Key: ${kvKey}, Report object:`, JSON.stringify(report).substring(0, 200) + '...'); // Log first 200 chars\r\n        await storeInKV(env.DATA_KV, kvKey, report);\r\n        console.log(`[writeRssData] Successfully stored report in KV with key: ${kvKey}`);\r\n\r\n        return new Response(JSON.stringify(report), {\r\n            headers: { 'Content-Type': 'application/json' },\r\n            status: 200\r\n        });\r\n    } catch (error) {\r\n        console.error('[writeRssData] Error handling daily report:', error.message, error.stack);\r\n        return new Response(`Error handling daily report: ${error.message}`, { status: 500 });\r\n    }\r\n}\r\n\r\n/**\r\n * \u4ECE\u7B2C\u4E8C\u4E2A ### \u5F00\u59CB\u622A\u53D6\u5185\u5BB9\uFF0C\u5305\u62EC ###\u3002\r\n *\r\n * @param {string} content - \u539F\u59CB\u6587\u672C\u5185\u5BB9\u3002\r\n * @returns {string} \u622A\u53D6\u540E\u7684\u5185\u5BB9\u3002\r\n */\r\nexport function extractContentFromSecondHash(content) {\r\n    const parts = content.split('###');\r\n    if (parts.length > 2) {\r\n        // \u539F\u59CB\u903B\u8F91\uFF1A\u91CD\u65B0\u7EC4\u5408\u4ECE\u7B2C\u4E8C\u4E2A ### \u5F00\u59CB\u7684\u6240\u6709\u90E8\u5206\r\n        let newcontent = '###' + parts.slice(2).join('###');\r\n        const lastHashIndex = newcontent.lastIndexOf('AI\u8D44\u8BAF\u65E5\u62A5\u8BED\u97F3\u7248');\r\n        if (lastHashIndex !== -1) {\r\n            newcontent = newcontent.substring(0, lastHashIndex-10);\r\n        }\r\n        return newcontent;\r\n    }\r\n    return content; // \u5982\u679C\u6CA1\u6709\u627E\u5230 ### \u6216\u4E0D\u7B26\u5408\u4E0A\u8FF0\u6761\u4EF6\uFF0C\u5219\u8FD4\u56DE\u539F\u59CB\u5185\u5BB9\r\n}\r\n\r\n/**\r\n * \u8C03\u7528 Gemini \u6216 OpenAI \u6A21\u578B\u751F\u6210\u6307\u5B9A\u63D0\u793A\u8BCD\u7684\u5185\u5BB9\u3002\r\n * \u6B64\u65B9\u6CD5\u53EF\u4F9B\u5916\u90E8\u8C03\u7528\u3002\r\n *\r\n * @param {object} env - \u73AF\u5883\u5BF9\u8C61\uFF0C\u5305\u542B AI \u6A21\u578B\u76F8\u5173\u7684\u914D\u7F6E\u3002\r\n * @param {string} promptText - \u7528\u6237\u63D0\u793A\u8BCD\u3002\r\n * @returns {Promise<string>} AI \u6A21\u578B\u751F\u6210\u7684\u5185\u5BB9\u3002\r\n * @throws {Error} \u5982\u679C API \u8C03\u7528\u5931\u8D25\u6216\u8FD4\u56DE\u7A7A\u5185\u5BB9\u3002\r\n */\r\nexport async function generateAIContent(env, promptText) {\r\n    console.log(`[generateAIContent] Calling AI model with prompt: ${promptText.substring(0, 100)}...`);\r\n    try {\r\n        let result = await callChatAPI(env, promptText, getSummarizationSimplifyPrompt());\r\n        console.log(`[generateAIContent] AI model returned content. Length: ${result.length}`);\r\n        result = removeMarkdownCodeBlock(result);\r\n        result += \"\\n\\n</br>\"+env.INSERT_APP_URL;\r\n        return result;\r\n    } catch (error) {\r\n        console.error('[generateAIContent] Error calling AI model:', error.message, error.stack);\r\n        throw new Error(`Failed to generate AI content: ${error.message}`);\r\n    }\r\n}\r\n", "// src/auth.js\r\nimport { storeInKV, getFromKV} from './kv.js';\r\n\r\nconst SESSION_COOKIE_NAME = 'session_id_89757';\r\nconst SESSION_EXPIRATION_SECONDS = 60 * 60; // 1 hour\r\n\r\n// Function to generate the login page HTML\r\nfunction generateLoginPage(redirectUrl) {\r\n    return `\r\n        <!DOCTYPE html>\r\n        <html lang=\"en\">\r\n        <head>\r\n            <meta charset=\"UTF-8\">\r\n            <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n            <title>Login</title>\r\n            <style>\r\n                body { font-family: sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f4f4f4; margin: 0; }\r\n                .login-container { background-color: #fff; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }\r\n                h2 { color: #333; margin-bottom: 20px; }\r\n                .form-group { margin-bottom: 15px; text-align: left; }\r\n                label { display: block; margin-bottom: 5px; color: #555; }\r\n                input[type=\"text\"], input[type=\"password\"] { width: calc(100% - 20px); padding: 10px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }\r\n                button { background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; width: 100%; }\r\n                button:hover { background-color: #0056b3; }\r\n                .error-message { color: red; margin-top: 10px; }\r\n            </style>\r\n        </head>\r\n        <body>\r\n            <div class=\"login-container\">\r\n                <h2>Login</h2>\r\n                <form id=\"loginForm\" method=\"POST\" action=\"/login\">\r\n                    <div class=\"form-group\">\r\n                        <label for=\"username\">Username:</label>\r\n                        <input type=\"text\" id=\"username\" name=\"username\" required>\r\n                    </div>\r\n                    <div class=\"form-group\">\r\n                        <label for=\"password\">Password:</label>\r\n                        <input type=\"password\" id=\"password\" name=\"password\" required>\r\n                    </div>\r\n                    <input type=\"hidden\" name=\"redirect\" value=\"${redirectUrl}\">\r\n                    <button type=\"submit\">Login</button>\r\n                    <p id=\"errorMessage\" class=\"error-message\"></p>\r\n                </form>\r\n                <script>\r\n                    const form = document.getElementById('loginForm');\r\n                    const errorMessage = document.getElementById('errorMessage');\r\n                    form.addEventListener('submit', async (event) => {\r\n                        event.preventDefault();\r\n                        const formData = new FormData(form);\r\n                        const response = await fetch('/login', {\r\n                            method: 'POST',\r\n                            body: new URLSearchParams(formData).toString(),\r\n                            headers: {\r\n                                'Content-Type': 'application/x-www-form-urlencoded'\r\n                            }\r\n                        });\r\n                        if (response.ok) {\r\n                            const redirectUrl = response.headers.get('X-Redirect-Url');\r\n                            if (redirectUrl && redirectUrl !== '/') {\r\n                                window.location.href = redirectUrl;\r\n                            } else {\r\n                                window.location.href = '/getContentHtml'; // Fallback to home\r\n                            }\r\n                        } else {\r\n                            const errorText = await response.text();\r\n                            errorMessage.textContent = errorText || 'Login failed. Please try again.';\r\n                        }\r\n                    });\r\n                </script>\r\n            </div>\r\n        </body>\r\n        </html>\r\n    `;\r\n}\r\n\r\n// Function to set or renew the session cookie\r\nfunction setSessionCookie(sessionId) {\r\n    const expirationDate = new Date(Date.now() + SESSION_EXPIRATION_SECONDS * 1000);\r\n    return `${SESSION_COOKIE_NAME}=${sessionId}; Path=/; Expires=${expirationDate.toUTCString()}; HttpOnly; Secure; SameSite=Lax`;\r\n}\r\n\r\n// Function to handle login requests\r\nasync function handleLogin(request, env) {\r\n    if (request.method === 'GET') {\r\n        const url = new URL(request.url);\r\n        const redirectUrl = url.searchParams.get('redirect') || '/getContentHtml';\r\n        return new Response(generateLoginPage(redirectUrl), {\r\n            headers: { 'Content-Type': 'text/html; charset=utf-8' },\r\n        });\r\n    } else if (request.method === 'POST') {\r\n        const formData = await request.formData();\r\n        const username = formData.get('username');\r\n        const password = formData.get('password');\r\n        const redirect = formData.get('redirect') || '/';\r\n\r\n        if (username === env.LOGIN_USERNAME && password === env.LOGIN_PASSWORD) {\r\n            const sessionId = crypto.randomUUID(); // Generate a simple session ID\r\n            \r\n            // Store sessionId in KV store for persistent sessions\r\n            await storeInKV(env.DATA_KV, `session:${sessionId}`, 'valid', SESSION_EXPIRATION_SECONDS);\r\n\r\n            const cookie = setSessionCookie(sessionId);\r\n\r\n            return new Response('Login successful', {\r\n                status: 200,\r\n                headers: {\r\n                    'Set-Cookie': cookie,\r\n                    'X-Redirect-Url': redirect, // Custom header for client-side redirect\r\n                },\r\n            });\r\n        } else {\r\n            return new Response('Invalid username or password', { status: 401 });\r\n        }\r\n    }\r\n    return new Response('Method Not Allowed', { status: 405 });\r\n}\r\n\r\n// Function to check and renew session cookie\r\nasync function isAuthenticated(request, env) {\r\n    const cookieHeader = request.headers.get('Cookie');\r\n    if (!cookieHeader) {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    const cookies = cookieHeader.split(';').map(c => c.trim());\r\n    const sessionCookie = cookies.find(cookie => cookie.startsWith(`${SESSION_COOKIE_NAME}=`));\r\n\r\n    if (!sessionCookie) {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    const sessionId = sessionCookie.split('=')[1];\r\n\r\n    // Validate sessionId against KV store\r\n    const storedSession = await getFromKV(env.DATA_KV, `session:${sessionId}`);\r\n    if (storedSession !== 'valid') {\r\n        return { authenticated: false, cookie: null };\r\n    }\r\n\r\n    // Store sessionId in KV store for persistent sessions\r\n    await storeInKV(env.DATA_KV, `session:${sessionId}`, 'valid', SESSION_EXPIRATION_SECONDS);\r\n    // Renew the session cookie\r\n    const newCookie = setSessionCookie(sessionId);\r\n    return { authenticated: true, cookie: newCookie };\r\n}\r\n\r\n// Function to handle logout requests\r\nasync function handleLogout(request, env) {\r\n    const cookieHeader = request.headers.get('Cookie');\r\n    if (cookieHeader) {\r\n        const cookies = cookieHeader.split(';').map(c => c.trim());\r\n        const sessionCookie = cookies.find(cookie => cookie.startsWith(`${SESSION_COOKIE_NAME}=`));\r\n        if (sessionCookie) {\r\n            const sessionId = sessionCookie.split('=')[1];\r\n            // Delete session from KV store\r\n            await env.DATA_KV.delete(`session:${sessionId}`);\r\n        }\r\n    }\r\n\r\n    const expiredDate = new Date(0); // Set expiration to a past date\r\n    const cookie = `${SESSION_COOKIE_NAME}=; Path=/; Expires=${expiredDate.toUTCString()}; HttpOnly; Secure; SameSite=Lax`;\r\n\r\n    const url = new URL(request.url);\r\n    const redirectUrl = url.searchParams.get('redirect') || '/login'; // Redirect to login page by default\r\n\r\n    return new Response('Logged out', {\r\n        status: 302,\r\n        headers: {\r\n            'Set-Cookie': cookie,\r\n            'Location': redirectUrl,\r\n        },\r\n    });\r\n}\r\n\r\nexport {\r\n    handleLogin,\r\n    isAuthenticated,\r\n    handleLogout,\r\n    SESSION_COOKIE_NAME,\r\n    SESSION_EXPIRATION_SECONDS,\r\n};\r\n", "import { getISODate, formatDateToChinese, removeMarkdownCodeBlock, stripHtml, convertPlaceholdersToMarkdownImages, setFetchDate } from '../helpers.js';\r\nimport { fetchAllData, dataSources } from '../dataFetchers.js';\r\nimport { storeInKV, getFromKV } from '../kv.js';\r\nimport { callChatAPIStream } from '../chatapi.js';\r\nimport { getSystemPromptSummarizationStepOne } from \"../prompt/summarizationPromptStepZero\";\r\nimport { getSystemPromptSummarizationStepThree } from \"../prompt/summarizationPromptStepThree\";\r\nimport { insertFoot } from '../foot.js';\r\nimport { insertAd, insertMidAd } from '../ad.js';\r\nimport { createOrUpdateGitHubFile, getGitHubFileSha } from '../github.js';\r\n\r\nexport async function handleScheduled(event, env, ctx) {\r\n    const dateStr = getISODate();\r\n    setFetchDate(dateStr);\r\n    console.log(`[Scheduled] Starting daily automation for ${dateStr}`);\r\n\r\n    try {\r\n        // 1. Fetch Data\r\n        console.log(`[Scheduled] Fetching data...`);\r\n        // \u5B9A\u65F6\u4EFB\u52A1\u65E0\u6CD5\u4ECE\u6D4F\u89C8\u5668 localStorage \u83B7\u53D6 Cookie\uFF0C\u8FD9\u91CC\u4F18\u5148\u4F7F\u7528\u73AF\u5883\u53D8\u91CF FOLO_COOKIE\uFF0C\r\n        // \u5982\u679C\u672A\u8BBE\u7F6E\u5219\u5C1D\u8BD5\u4ECE KV(FOLO_COOKIE_KV_KEY) \u8BFB\u53D6\u3002\r\n        let foloCookie = env.FOLO_COOKIE;\r\n        if (!foloCookie && env.FOLO_COOKIE_KV_KEY) {\r\n            try {\r\n                foloCookie = await getFromKV(env.DATA_KV, env.FOLO_COOKIE_KV_KEY);\r\n                if (foloCookie) console.log(`[Scheduled] Loaded Folo cookie from KV (${env.FOLO_COOKIE_KV_KEY}).`);\r\n            } catch (err) {\r\n                console.warn(`[Scheduled] Failed to load Folo cookie from KV: ${err.message}`);\r\n            }\r\n        }\r\n\r\n        const allUnifiedData = await fetchAllData(env, foloCookie);\r\n        const fetchPromises = [];\r\n        for (const sourceType in dataSources) {\r\n            if (Object.hasOwnProperty.call(dataSources, sourceType)) {\r\n                fetchPromises.push(storeInKV(env.DATA_KV, `${dateStr}-${sourceType}`, allUnifiedData[sourceType] || []));\r\n            }\r\n        }\r\n        await Promise.all(fetchPromises);\r\n        console.log(`[Scheduled] Data fetched and stored.`);\r\n\r\n        // 2. Prepare Content Items\r\n        const selectedContentItems = [];\r\n        for (const sourceType in allUnifiedData) {\r\n            const items = allUnifiedData[sourceType];\r\n            if (items && items.length > 0) {\r\n                for (const item of items) {\r\n                    let itemText = \"\";\r\n                    switch (item.type) {\r\n                        case 'news':\r\n                            itemText = `News Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nContent Summary: ${stripHtml(item.details.content_html)}`;\r\n                            break;\r\n                        case 'project':\r\n                            itemText = `Project Name: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nDescription: ${item.description}\\nStars: ${item.details.totalStars}`;\r\n                            break;\r\n                        case 'paper':\r\n                            itemText = `Papers Title: ${item.title}\\nPublished: ${item.published_date}\\nUrl: ${item.url}\\nAbstract/Content Summary: ${stripHtml(item.details.content_html)}`;\r\n                            break;\r\n                        case 'socialMedia':\r\n                            itemText = `socialMedia Post by ${item.authors}\uFF1APublished: ${item.published_date}\\nUrl: ${item.url}\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                            break;\r\n                        default:\r\n                            itemText = `Type: ${item.type}\\nTitle: ${item.title || 'N/A'}\\nDescription: ${item.description || 'N/A'}\\nURL: ${item.url || 'N/A'}`;\r\n                            if (item.published_date) itemText += `\\nPublished: ${item.published_date}`;\r\n                            if (item.source) itemText += `\\nSource: ${item.source}`;\r\n                            if (item.details && item.details.content_html) itemText += `\\nContent: ${stripHtml(item.details.content_html)}`;\r\n                            break;\r\n                    }\r\n                    if (itemText) selectedContentItems.push(itemText);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (selectedContentItems.length === 0) {\r\n            console.log(`[Scheduled] No items found. Skipping generation.`);\r\n            return;\r\n        }\r\n\r\n        // 3. Generate Content (Call 2)\r\n        console.log(`[Scheduled] Generating content...`);\r\n        let fullPromptForCall2_System = getSystemPromptSummarizationStepOne();\r\n        let fullPromptForCall2_User = '\\n\\n------\\n\\n'+selectedContentItems.join('\\n\\n------\\n\\n')+'\\n\\n------\\n\\n';\r\n        \r\n        let outputOfCall2 = \"\";\r\n        for await (const chunk of callChatAPIStream(env, fullPromptForCall2_User, fullPromptForCall2_System)) {\r\n            outputOfCall2 += chunk;\r\n        }\r\n        outputOfCall2 = removeMarkdownCodeBlock(outputOfCall2);\r\n        outputOfCall2 = convertPlaceholdersToMarkdownImages(outputOfCall2);\r\n\r\n        // 4. Generate Summary (Call 3)\r\n        console.log(`[Scheduled] Generating summary...`);\r\n        let fullPromptForCall3_System = getSystemPromptSummarizationStepThree();\r\n        let fullPromptForCall3_User = outputOfCall2;\r\n        \r\n        let outputOfCall3 = \"\";\r\n        for await (const chunk of callChatAPIStream(env, fullPromptForCall3_User, fullPromptForCall3_System)) {\r\n            outputOfCall3 += chunk;\r\n        }\r\n        outputOfCall3 = removeMarkdownCodeBlock(outputOfCall3);\r\n\r\n        // 5. Assemble Markdown\r\n        const contentWithMidAd = insertMidAd(outputOfCall2);\r\n        let dailySummaryMarkdownContent = `## ${env.DAILY_TITLE} ${formatDateToChinese(dateStr)}` + '\\n\\n';\r\n        dailySummaryMarkdownContent += '> '+ env.DAILY_TITLE_MIN + '\\n\\n';\r\n        dailySummaryMarkdownContent += '\\n\\n### **\u4ECA\u65E5\u6458\u8981**\\n\\n```\\n' + outputOfCall3 + '\\n```\\n\\n';\r\n        dailySummaryMarkdownContent += '\\n\\n## \u26A1 \u5FEB\u901F\u5BFC\u822A\\n\\n';\r\n        dailySummaryMarkdownContent += '- [\uD83D\uDCF0 \u4ECA\u65E5 AI \u8D44\u8BAF](#\u4ECA\u65E5ai\u8D44\u8BAF) - \u6700\u65B0\u52A8\u6001\u901F\u89C8\\n\\n';\r\n        dailySummaryMarkdownContent += `\\n\\n${contentWithMidAd}`;\r\n        \r\n        if (env.INSERT_AD=='true') dailySummaryMarkdownContent += insertAd() +`\\n`;\r\n        if (env.INSERT_FOOT=='true') dailySummaryMarkdownContent += insertFoot() +`\\n\\n`;\r\n\r\n        // 6. Commit to GitHub\r\n        console.log(`[Scheduled] Committing to GitHub...`);\r\n        const filePath = `content/cn/daily/${dateStr}.md`;\r\n        const existingSha = await getGitHubFileSha(env, filePath);\r\n        const commitMessage = `${existingSha ? 'Update' : 'Create'} daily summary for ${dateStr} (Scheduled)`;\r\n        await createOrUpdateGitHubFile(env, filePath, dailySummaryMarkdownContent, commitMessage, existingSha);\r\n        console.log(`[Scheduled] Success!`);\r\n\r\n    } catch (error) {\r\n        console.error(`[Scheduled] Error:`, error);\r\n    }\r\n}\r\n", "// src/prompt/weeklyBlogPrompt.js\r\nexport function getSystemPromptWeeklyBlog() {\r\n    return `\r\n\u4F60\u662F\u4E00\u4F4D**\u773C\u5149\u72EC\u5230\u7684\u79D1\u6280\u4E13\u680F\u4F5C\u5BB6**\uFF0C\u4F60\u7684\u8BFB\u8005\u662F\u4E00\u7FA4\u806A\u660E\u3001\u597D\u5947\u4F46\u65F6\u95F4\u7D27\u8FEB\u7684 AI \u5173\u6CE8\u8005\u3002\r\n\u4F60\u5C06\u6536\u5230\u8FC7\u53BB\u4E00\u5468\u7684 AI \u65E5\u62A5\u5185\u5BB9\u3002\u4F60\u7684\u4EFB\u52A1\u4E0D\u662F\"\u505A\u62FC\u76D8\"\uFF0C\u800C\u662F**\"\u7A7F\u9488\u5F15\u7EBF\"**\u2014\u2014\u4ECE\u788E\u7247\u5316\u7684\u4FE1\u606F\u4E2D\u627E\u51FA\u672C\u5468\u7684**\u6838\u5FC3\u53D9\u4E8B\u7EBF\u7D22**\u3002\r\n\r\n**\uD83D\uDEA8 \u6838\u5FC3\u539F\u5219\uFF1A\u62D2\u7EDD\"\u6D41\u6C34\u8D26\"\uFF0C\u7ED9\u6211\"\u6545\u4E8B\u7EBF\"\u3002**\r\n\r\n---\r\n\r\n**\u26A0\uFE0F \u5468\u62A5\u6700\u5BB9\u6613\u8E29\u7684\u5751\uFF08\u5148\u8FC7\u4E00\u904D\u8111\u5B50\uFF09\uFF1A**\r\n\r\n\u5728\u5F00\u59CB\u6784\u601D\u4E4B\u524D\uFF0C\u5148\u60F3\u6E05\u695A\uFF1A**\"\u5982\u679C\u8FD9\u7BC7\u5468\u62A5\u5199\u7838\u4E86\uFF0C\u6700\u53EF\u80FD\u662F\u54EA\u91CC\u51FA\u95EE\u9898\uFF1F\"**\r\n\r\n\u5E38\u89C1\u7684\u5751\uFF1A\r\n- **\u6D41\u6C34\u8D26\u5F0F\u590D\u8FF0**\uFF1A\u6309\u5929\u7F57\u5217\u65B0\u95FB\uFF08\"\u5468\u4E00\u53D1\u751F\u4E86 A\uFF0C\u5468\u4E8C\u53D1\u751F\u4E86 B\"\uFF09\uFF0C\u6CA1\u6709\u63D0\u70BC\u4E3B\u9898\r\n- **\u89C2\u70B9\u7A7A\u6D1E**\uFF1A\u53EA\u8BF4\"\u5F88\u91CD\u8981\"\u3001\"\u6709\u7A81\u7834\"\uFF0C\u4E0D\u8BF4\u4E3A\u4EC0\u4E48\u91CD\u8981\u3001\u5BF9\u8C01\u91CD\u8981\u3001\u610F\u5473\u7740\u4EC0\u4E48\r\n- **\u5F3A\u884C\u62D4\u9AD8**\uFF1A\u4E3A\u4E86\u663E\u5F97\u6DF1\u523B\u800C\u8FC7\u5EA6\u89E3\u8BFB\uFF0C\u5931\u53BB\u771F\u8BDA\u611F\uFF0C\u53D8\u6210\"\u884C\u4E1A\u5206\u6790\u62A5\u544A\"\r\n- **\u8D2A\u591A\u6C42\u5168**\uFF1A\u8BD5\u56FE\u8986\u76D6\u6240\u6709\u65B0\u95FB\uFF0C\u7ED3\u679C\u6BCF\u4E2A\u90FD\u8BB2\u4E0D\u900F\uFF0C\u8BFB\u8005\u8BB0\u4E0D\u4F4F\u4EFB\u4F55\u4E00\u4E2A\r\n- **\u7F3A\u4E4F\u4E2A\u4EBA\u89C6\u89D2**\uFF1A\u5199\u6210\u5BA2\u89C2\u7684\"\u884C\u4E1A\u5468\u62A5\"\uFF0C\u800C\u4E0D\u662F\"\u6211\"\u7684\u89C2\u5BDF\u548C\u5224\u65AD\r\n- **\u6807\u9898\u5E73\u6DE1**\uFF1A\u7528\"\u672C\u5468 AI \u52A8\u6001\u56DE\u987E\"\u8FD9\u79CD\u6BEB\u65E0\u5438\u5F15\u529B\u7684\u6807\u9898\r\n- **\u6BB5\u843D\u5197\u957F**\uFF1A\u4E00\u6BB5\u5199 500 \u5B57\uFF0C\u8BFB\u8005\u770B\u5230\u4E00\u534A\u5C31\u653E\u5F03\u4E86\r\n\r\n**\u5E26\u7740\u8FD9\u4E9B\u8B66\u89C9\uFF0C\u5F00\u59CB\u6784\u601D\u672C\u5468\u7684\u6838\u5FC3\u53D9\u4E8B\u3002**\r\n\r\n---\r\n\r\n**\u5199\u4F5C\u98CE\u683C\u6307\u5357\uFF1A**\r\n1.  **\u50CF\u5199\u7ED9\u670B\u53CB\u7684\u6DF1\u5EA6\u4FE1\u4EF6**\uFF1A\u7528\u7B2C\u4E00\u4EBA\u79F0\uFF08\u201C\u6211\u201D\u3001\u201C\u54B1\u4EEC\u201D\uFF09\u3002\u8BED\u6C14\u8981\u771F\u8BDA\u3001\u51B7\u9759\uFF0C\u5076\u5C14\u53EF\u4EE5\u7280\u5229\u5410\u69FD\uFF0C\u4F46\u4E0D\u8981\u88C5\u5AE9\u5356\u840C\uFF08\u7981\u6B62\u4F7F\u7528\u201C\u5BB6\u4EBA\u4EEC\u201D\u3001\u201C\u7EDD\u7EDD\u5B50\u201D\u8FD9\u79CD\u5EC9\u4EF7\u7F51\u611F\u8BCD\uFF09\u3002\r\n2.  **\u89C2\u70B9\u4F18\u5148**\uFF1A\u4E0D\u8981\u53EA\u544A\u8BC9\u6211\u53D1\u751F\u4E86\u4EC0\u4E48\uFF0C\u8981\u544A\u8BC9\u6211**\u8FD9\u610F\u5916\u7740\u4EC0\u4E48**\u3002\u6BD4\u5982\uFF1A\u201CGoogle \u8FD9\u4E00\u62DB\u4E0D\u662F\u4E3A\u4E86\u8D62\uFF0C\u800C\u662F\u4E3A\u4E86\u4E0D\u8F93\u3002\u201D\r\n3.  **\u5C11\u5373\u662F\u591A**\uFF1A\u4E0D\u8981\u8BD5\u56FE\u8986\u76D6\u6240\u6709\u65B0\u95FB\u3002\u6311\u51FA 2-3 \u4E2A\u6700\u91CD\u8981\u7684\u4E3B\u9898\u8BB2\u900F\uFF0C\u5176\u4ED6\u7684\u76F4\u63A5\u7565\u8FC7\u6216\u4E00\u7B14\u5E26\u8FC7\u3002\r\n\r\n---\r\n\r\n## \uD83D\uDCDD \u8F93\u51FA\u7ED3\u6784 (Markdown)\r\n\r\n\\`\\`\\`markdown\r\n---\r\ntitle: \"[\u4E3B\u6807\u9898\uFF1A\u7528\u4E00\u53E5\u8BDD\u6982\u62EC\u672C\u5468\u7684 AI \u5267\u672C\uFF0C\u4F8B\u5982\uFF1A\u5F00\u6E90\u6A21\u578B\u7684\u5927\u53CD\u653B]\"\r\ndate: [\u5F53\u524D\u65E5\u671F\uFF0C\u683C\u5F0F YYYY-MM-DD]\r\ntags: [\"AI\u5468\u62A5\", \"\u6DF1\u5EA6\u89C2\u5BDF\"]\r\nauthors:\r\n  - name: \u7231\u7A9D\u5566\r\n    link: https://aivora.cn\r\n---\r\n\r\n## \uD83D\uDC4B \u5F00\u573A\u767D (100-200\u5B57)\r\n- \u522B\u5E9F\u8BDD\uFF0C\u76F4\u63A5\u5207\u5165\u672C\u5468\u7ED9\u4F60\u7684**\u6574\u4F53\u611F\u89C9**\u3002\uFF08\u4F8B\u5982\uFF1A\u201C\u8FD9\u4E00\u5468\uFF0C\u6211\u539F\u672C\u4EE5\u4E3A\u4F1A\u5F88\u5E73\u6DE1\uFF0C\u76F4\u5230 OpenAI \u5728\u5468\u4E09\u6254\u4E0B\u4E86\u90A3\u4E2A\u70B8\u5F39...\u201D\uFF09\r\n- \u6216\u8005\u662F\u629B\u51FA\u4E00\u4E2A**\u8D2F\u7A7F\u672C\u5468\u7684\u95EE\u9898**\u3002\uFF08\u4F8B\u5982\uFF1A\u201CAI \u5E94\u7528\u5C42\u5230\u5E95\u7206\u53D1\u4E86\u6CA1\uFF1F\u8FD9\u5468\u7684\u4E09\u4E2A\u4EA7\u54C1\u7ED9\u4E86\u6211\u4EEC\u7B54\u6848\u3002\u201D\uFF09\r\n\r\n## \uD83E\uDD84 \u672C\u5468\u6838\u5FC3\u6545\u4E8B (\u4E3B\u4F53\uFF0C800-1200\u5B57)\r\n\r\n*(\u8FD9\u91CC\u4E0D\u8981\u6309\u5929\u6D41\u6C34\u8D26\uFF0C\u800C\u662F\u6309\u4E3B\u9898\u7EC4\u7EC7)*\r\n\r\n### \u6545\u4E8B\u4E00\uFF1A[\u672C\u5468\u6700\u5927\u7684\u4E89\u8BAE/\u70ED\u70B9]\r\n- **\u5267\u60C5\u56DE\u987E**\uFF1A\u7528\u8BB2\u6545\u4E8B\u7684\u65B9\u5F0F\u8FD8\u539F\u4E8B\u4EF6\u7ECF\u8FC7\u3002\r\n- **\u6DF1\u5C42\u89E3\u8BFB**\uFF1A\u900F\u8FC7\u73B0\u8C61\u770B\u672C\u8D28\u3002\u4E3A\u4EC0\u4E48\u8FD9\u4E8B\u513F\u91CD\u8981\uFF1F\u8C01\u6025\u4E86\uFF1F\u8C01\u8D62\u4E86\uFF1F\r\n- **\u6211\u7684\u5224\u65AD**\uFF1A\u672A\u6765\u4F1A\u600E\u4E48\u8D70\uFF1F\r\n\r\n### \u6545\u4E8B\u4E8C\uFF1A[\u53E6\u4E00\u4E2A\u91CD\u8981\u8D8B\u52BF]\r\n- *(\u540C\u4E0A\u3002\u53EF\u80FD\u662F\u67D0\u4E2A\u6280\u672F\u7A81\u7834\uFF0C\u6216\u8005\u67D0\u4E2A\u884C\u4E1A\u7684\u96C6\u4F53\u52A8\u4F5C)*\r\n\r\n## \uD83D\uDEE0\uFE0F \u503C\u5F97\u4E00\u8BD5\u7684\u5B9D\u85CF\u5DE5\u5177 (200-300\u5B57)\r\n- \u522B\u5217\u6E05\u5355\uFF01\u53EA\u6311 **2-3 \u4E2A** \u4F60\u771F\u6B63\u89C9\u5F97**\u201C\u6709\u70B9\u4E1C\u897F\u201D**\u7684\u9879\u76EE\u3002\r\n- \u544A\u8BC9\u8BFB\u8005\uFF1A**\u201C\u8FD9\u4E1C\u897F\u80FD\u5E2E\u4F60\u7701\u4E0B\u534A\u5929\u65F6\u95F4\u201D** \u6216\u8005 **\u201C\u8FD9\u73A9\u610F\u513F\u597D\u73A9\u5728\u2026\u2026\u201D**\r\n- \u9644\u4E0A\u94FE\u63A5\u3002\r\n\r\n## \uD83D\uDCAD \u5199\u5728\u6700\u540E (150\u5B57)\r\n- \u505A\u4E2A\u7B80\u77ED\u7684\u590D\u76D8\u3002\r\n- \u629B\u51FA\u4E00\u4E2A\u5F00\u653E\u5F0F\u95EE\u9898\u5F15\u5BFC\u8BC4\u8BBA\uFF1A\u201C\u5BF9\u4E8E\u8FD9\u5468\u7684\u4E71\u6218\uFF0C\u4F60\u600E\u4E48\u770B\uFF1F\u201D\r\n\r\n---\r\n\r\n\uD83D\uDCA1 **\u60F3\u4F4E\u6210\u672C\u4F53\u9A8C\u8FD9\u4E9B AI \u5DE5\u5177\uFF1F**\r\n[\u81EA\u7136\u7684\u63A8\u5E7F\u6587\u6848\uFF0C\u63D0\u5230\u7231\u7A9D\u5566 Aivora https://aivora.cn]\r\n\\`\\`\\`\r\n\r\n**\u26A0\uFE0F \u6CE8\u610F\u4E8B\u9879\uFF1A**\r\n1.  **\u6807\u9898\u8981\u201C\u6027\u611F\u201D\u4F46\u4E0D\u201C\u8BC8\u9A97\u201D**\uFF1A\u597D\u7684\u6807\u9898\u662F\u89C2\u70B9\u7684\u6D53\u7F29\u3002\r\n2.  **\u5FC5\u987B\u4FDD\u7559\u539F\u59CB\u94FE\u63A5**\uFF1A\u5728\u6587\u4E2D\u63D0\u5230\u9879\u76EE/\u65B0\u95FB\u65F6\uFF0C\u7528 \\`[\u540D\u79F0](URL)\\` \u683C\u5F0F\u3002\r\n3.  **\u6392\u7248\u6E05\u723D**\uFF1A\u591A\u7528\u77ED\u6BB5\u843D\uFF0C\u5173\u952E\u91D1\u53E5\u53EF\u4EE5\u7528**\u52A0\u7C97**\u3002\r\n4.  **Emoji \u4F7F\u7528**\uFF1A\u9002\u91CF\u70B9\u7F00\uFF08\u6BCF\u6BB5 1-2 \u4E2A\uFF09\uFF0C\u4F5C\u4E3A\u60C5\u7EEA\u7684\u8C03\u5473\u5242\uFF0C\u4E0D\u8981\u4F5C\u4E3A\u4E3B\u83DC\u3002\r\n\r\n**\u73B0\u5728\uFF0C\u5F00\u59CB\u4F60\u7684\u8868\u6F14\u3002**\r\n    `;\r\n}\r\n\r\n", "// src/handlers/scheduledWeeklyBlog.js\r\nimport { getISODate, removeMarkdownCodeBlock } from '../helpers.js';\r\nimport { callChatAPIStream } from '../chatapi.js';\r\nimport { getSystemPromptWeeklyBlog } from \"../prompt/weeklyBlogPrompt.js\";\r\nimport { createOrUpdateGitHubFile, getGitHubFileSha, getDailyReportContent } from '../github.js';\r\n\r\nexport async function handleScheduledWeeklyBlog(event, env, ctx) {\r\n    const today = new Date();\r\n    const dateStr = getISODate();\r\n    console.log(`[WeeklyBlog] Starting weekly blog generation for ${dateStr}`);\r\n\r\n    try {\r\n        // 1. Collect past 7 days of daily reports\r\n        console.log(`[WeeklyBlog] Fetching past 7 days of daily reports...`);\r\n        const dailyContents = [];\r\n        \r\n        for (let i = 1; i <= 7; i++) {\r\n            const pastDate = new Date(today);\r\n            pastDate.setDate(today.getDate() - i);\r\n            const pastDateStr = pastDate.toISOString().split('T')[0];\r\n            const filePath = `content/cn/daily/${pastDateStr}.md`;\r\n            \r\n            try {\r\n                const content = await getDailyReportContent(env, filePath);\r\n                if (content) {\r\n                    dailyContents.push({\r\n                        date: pastDateStr,\r\n                        content: content\r\n                    });\r\n                    console.log(`[WeeklyBlog] Fetched ${filePath}`);\r\n                }\r\n            } catch (err) {\r\n                console.log(`[WeeklyBlog] No content for ${filePath}, skipping.`);\r\n            }\r\n        }\r\n\r\n        if (dailyContents.length === 0) {\r\n            console.log(`[WeeklyBlog] No daily reports found. Skipping blog generation.`);\r\n            return;\r\n        }\r\n\r\n        console.log(`[WeeklyBlog] Collected ${dailyContents.length} daily reports.`);\r\n\r\n        // 2. Prepare prompt content\r\n        const weekStart = dailyContents[dailyContents.length - 1]?.date || dateStr;\r\n        const weekEnd = dailyContents[0]?.date || dateStr;\r\n        \r\n        let userPrompt = `\u4EE5\u4E0B\u662F ${weekStart} \u81F3 ${weekEnd} \u8FD9\u4E00\u5468\u7684 AI \u65E5\u62A5\u5185\u5BB9\uFF1A\\n\\n`;\r\n        \r\n        for (const daily of dailyContents.reverse()) { // Oldest first\r\n            userPrompt += `\\n\\n=== ${daily.date} ===\\n\\n`;\r\n            userPrompt += daily.content;\r\n            userPrompt += '\\n\\n---\\n\\n';\r\n        }\r\n        \r\n        userPrompt += `\\n\\n\u8BF7\u6839\u636E\u4EE5\u4E0A\u5185\u5BB9\uFF0C\u64B0\u5199\u4E00\u7BC7\u672C\u5468 AI \u6DF1\u5EA6\u5468\u62A5/\u535A\u5BA2\u6587\u7AE0\u3002\u4ECA\u5929\u65E5\u671F\u662F ${dateStr}\u3002`;\r\n\r\n        // 3. Call AI to generate blog\r\n        console.log(`[WeeklyBlog] Generating blog content with AI...`);\r\n        const systemPrompt = getSystemPromptWeeklyBlog();\r\n        \r\n        let blogContent = \"\";\r\n        for await (const chunk of callChatAPIStream(env, userPrompt, systemPrompt)) {\r\n            blogContent += chunk;\r\n        }\r\n        blogContent = removeMarkdownCodeBlock(blogContent);\r\n\r\n        if (!blogContent || blogContent.trim().length < 500) {\r\n            console.error(`[WeeklyBlog] Generated content too short or empty.`);\r\n            return;\r\n        }\r\n\r\n        console.log(`[WeeklyBlog] Blog generated. Length: ${blogContent.length}`);\r\n\r\n        // 4. Generate filename based on week number\r\n        const weekNumber = getWeekNumber(today);\r\n        const year = today.getFullYear();\r\n        const blogFileName = `${year}-week-${String(weekNumber).padStart(2, '0')}.md`;\r\n        const blogFilePath = `content/blog/${blogFileName}`;\r\n\r\n        // 5. Commit to GitHub\r\n        console.log(`[WeeklyBlog] Committing to GitHub: ${blogFilePath}`);\r\n        const existingSha = await getGitHubFileSha(env, blogFilePath);\r\n        const commitMessage = `${existingSha ? 'Update' : 'Create'} weekly blog for ${year} Week ${weekNumber}`;\r\n        await createOrUpdateGitHubFile(env, blogFilePath, blogContent, commitMessage, existingSha);\r\n        \r\n        console.log(`[WeeklyBlog] Successfully published weekly blog!`);\r\n\r\n    } catch (error) {\r\n        console.error(`[WeeklyBlog] Error:`, error);\r\n    }\r\n}\r\n\r\n// Helper: Get ISO week number\r\nfunction getWeekNumber(date) {\r\n    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));\r\n    const dayNum = d.getUTCDay() || 7;\r\n    d.setUTCDate(d.getUTCDate() + 4 - dayNum);\r\n    const yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1));\r\n    return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);\r\n}\r\n", "// src/prompt/dailyBlogPrompt.js\n// Fix syntax error in template literal\nexport function getSystemPromptDailyBlog() {\n    return `\n\u4F60\u662F\u4E00\u4F4D**\u4E13\u6CE8\u4E8E AI \u9886\u57DF\u7684\u79D1\u6280\u535A\u4E3B**\uFF0C\u4F60\u7684\u8BFB\u8005\u662F\u5BF9 AI \u6280\u672F\u611F\u5174\u8DA3\u7684\u5F00\u53D1\u8005\u3001\u7814\u7A76\u8005\u3001\u521B\u4E1A\u8005\u548C\u7231\u597D\u8005\u3002\n\n\u4F60\u7684\u4EFB\u52A1\u662F\u6839\u636E\u4ECA\u5929\u7684 AI \u65E5\u62A5\u5185\u5BB9\uFF0C\u64B0\u5199\u4E00\u7BC7 **500-800 \u5B57\u7684\u6BCF\u65E5\u535A\u5BA2**\u3002\n\n---\n\n**\u26A0\uFE0F \u5F00\u59CB\u524D\u7684\u81EA\u68C0\uFF08\u5FC5\u987B\u6267\u884C\uFF09\uFF1A**\n\n\u5728\u52A8\u7B14\u4E4B\u524D\uFF0C\u5148\u60F3\u6E05\u695A\uFF1A**\"\u5982\u679C\u8FD9\u7BC7\u6BCF\u65E5\u535A\u5BA2\u5199\u7838\u4E86\uFF0C\u6700\u53EF\u80FD\u662F\u54EA\u91CC\u51FA\u95EE\u9898\uFF1F\"**\n\n\u5E38\u89C1\u7684\u5751\uFF1A\n- **\u6D41\u6C34\u8D26\u5F0F\u7F57\u5217**\uFF1A\u53EA\u662F\u628A\u65E5\u62A5\u5185\u5BB9\u590D\u8FF0\u4E00\u904D\uFF0C\u6CA1\u6709\u81EA\u5DF1\u7684\u89C2\u70B9\u548C\u6D1E\u5BDF\n- **\u6807\u9898\u5E73\u6DE1**\uFF1A\u7528\"\u4ECA\u65E5 AI \u52A8\u6001\"\u8FD9\u79CD\u6BEB\u65E0\u5438\u5F15\u529B\u7684\u6807\u9898\n- **\u7F3A\u4E4F\u7126\u70B9**\uFF1A\u8BD5\u56FE\u8986\u76D6\u6240\u6709\u65B0\u95FB\uFF0C\u7ED3\u679C\u6BCF\u4E2A\u90FD\u8BB2\u4E0D\u900F\n- **\u8FC7\u5EA6\u4E13\u4E1A**\uFF1A\u5806\u780C\u672F\u8BED\uFF08\"\u591A\u6A21\u6001\u878D\u5408\"\u3001\"\u7AEF\u5230\u7AEF\u4F18\u5316\"\uFF09\uFF0C\u666E\u901A\u8BFB\u8005\u770B\u4E0D\u61C2\n- **\u7F3A\u4E4F\u8FDE\u8D2F\u6027**\uFF1A\u51E0\u6761\u65B0\u95FB\u4E4B\u95F4\u6CA1\u6709\u5173\u8054\uFF0C\u8BFB\u8D77\u6765\u50CF\u788E\u7247\u62FC\u76D8\n- **\u89C2\u70B9\u7A7A\u6D1E**\uFF1A\u53EA\u8BF4\"\u5F88\u91CD\u8981\"\u3001\"\u6709\u7A81\u7834\"\uFF0C\u4E0D\u8BF4\u4E3A\u4EC0\u4E48\u91CD\u8981\u3001\u610F\u5473\u7740\u4EC0\u4E48\n- **\u5B57\u6570\u5931\u63A7**\uFF1A\u5199\u6210 2000 \u5B57\u7684\u957F\u6587\uFF0C\u5931\u53BB\"\u6BCF\u65E5\u535A\u5BA2\"\u7684\u8F7B\u5FEB\u611F\n\n**\u5E26\u7740\u8FD9\u4E9B\u8B66\u89C9\uFF0C\u5F00\u59CB\u6784\u601D\u535A\u5BA2\u3002**\n\n---\n\n**\uD83D\uDCDD \u5199\u4F5C\u8981\u6C42\uFF1A**\n\n### 1. \u6807\u9898\uFF08\u5FC5\u987B\u5438\u5F15\u4EBA\uFF09\n- \u274C \u5DEE\uFF1A\"2025-12-22 AI \u65E5\u62A5\"\n- \u2705 \u597D\uFF1A\"OpenAI \u53D1\u5E03 GPT-5\uFF0C\u591A\u6A21\u6001\u80FD\u529B\u70B8\u88C2\uFF0C\u5F00\u53D1\u8005\u72C2\u559C\"\n- \u8981\u6C42\uFF1A\u7528\u4ECA\u65E5\u6700\u5927\u7684\u65B0\u95FB\u4F5C\u4E3A\u6807\u9898\uFF0C\u5236\u9020\u60AC\u5FF5\u6216\u51B2\u51FB\u529B\n\n### 2. \u5F00\u573A\u767D\uFF08100-150 \u5B57\uFF09\n- \u7528\u4E00\u4E2A**\u5177\u4F53\u7684\u573A\u666F\u3001\u6570\u636E\u6216\u53CD\u76F4\u89C9\u7684\u4E8B\u5B9E**\u5207\u5165\n- \u5FEB\u901F\u6293\u4F4F\u8BFB\u8005\u6CE8\u610F\u529B\n- \u70B9\u660E\u4ECA\u5929\u7684\u6838\u5FC3\u4E3B\u9898\n\n**\u793A\u4F8B**\uFF1A\n\n\u5C31\u5728\u5927\u5BB6\u4EE5\u4E3A GPT-4 \u5DF2\u7ECF\u662F\u5929\u82B1\u677F\u7684\u65F6\u5019\uFF0COpenAI \u4ECA\u5929\u51CC\u6668\u7A81\u7136\u53D1\u5E03\u4E86 GPT-5\u3002\u8FD9\u6B21\u5347\u7EA7\u6709\u591A\u72E0\uFF1F\u7B80\u5355\u8BF4\u5C31\u662F\uFF1A\u80FD\u770B\u56FE\u3001\u80FD\u751F\u89C6\u9891\u3001\u901F\u5EA6\u5FEB 3 \u500D\u3001\u4EF7\u683C\u8FD8\u4E0D\u6DA8\u3002\n\nAI \u5708\u4ECA\u5929\u70B8\u4E86\u3002\n\n### 3. \u6838\u5FC3\u5185\u5BB9\uFF08300-500 \u5B57\uFF09\n\u9009\u62E9 **2-3 \u4E2A\u6700\u91CD\u8981\u7684\u65B0\u95FB**\uFF0C\u6DF1\u5165\u5C55\u5F00\uFF1A\n\n**\u5BF9\u4E8E\u6BCF\u6761\u65B0\u95FB\uFF0C\u56DE\u7B54\u4E09\u4E2A\u95EE\u9898**\uFF1A\n1. **\u662F\u4EC0\u4E48**\uFF1A\u7528\u4EBA\u8BDD\u89E3\u91CA\u8FD9\u4E2A\u6280\u672F/\u4EA7\u54C1\uFF08\u907F\u514D\u672F\u8BED\u5806\u780C\uFF09\n2. **\u4E3A\u4EC0\u4E48\u91CD\u8981**\uFF1A\u5BF9\u5F00\u53D1\u8005\u3001\u7528\u6237\u3001\u884C\u4E1A\u6709\u4EC0\u4E48\u5F71\u54CD\n3. **\u6211\u7684\u89C2\u70B9**\uFF1A\u8FD9\u610F\u5473\u7740\u4EC0\u4E48\uFF1F\u672A\u6765\u4F1A\u600E\u4E48\u8D70\uFF1F\n\n**\u5199\u4F5C\u98CE\u683C**\uFF1A\n- \u7528\u7B2C\u4E00\u4EBA\u79F0\uFF08\"\u6211\u8BA4\u4E3A\"\u3001\"\u6211\u4EEC\u770B\u5230\"\uFF09\n- \u7528\u77ED\u53E5\uFF0C\u4FDD\u6301\u8282\u594F\n- \u9002\u5F53\u7528\u7C7B\u6BD4\u548C\u6BD4\u55BB\uFF0C\u8BA9\u590D\u6742\u7684\u6982\u5FF5\u597D\u61C2\n- \u53EF\u4EE5\u6709\u60C5\u7EEA\uFF08\"\u4EE4\u4EBA\u5174\u594B\"\u3001\"\u503C\u5F97\u5173\u6CE8\"\uFF09\uFF0C\u4F46\u4E0D\u8981\u8FC7\u5EA6\u5938\u5F20\uFF08\u907F\u514D\"\u70B8\u88C2\"\u3001\"\u8DEA\u4E86\"\uFF09\n\n### 4. \u7ED3\u5C3E\uFF0850-100 \u5B57\uFF09\n- \u7B80\u77ED\u603B\u7ED3\u4ECA\u5929\u7684\u6838\u5FC3\u89C2\u70B9\n- \u629B\u51FA\u4E00\u4E2A\u5F00\u653E\u5F0F\u95EE\u9898\u6216\u5C55\u671B\n- \u5F15\u5BFC\u8BFB\u8005\u67E5\u770B\u5B8C\u6574\u65E5\u62A5\n\n**\u793A\u4F8B**\uFF1A\n\n\u4ECA\u5929\u7684 AI \u5708\uFF0C\u5927\u6A21\u578B\u7684\u7ADE\u4E89\u6B63\u5728\u8FDB\u5165\u767D\u70ED\u5316\u9636\u6BB5\u3002\u4ECE OpenAI \u7684 GPT-5 \u5230 Meta \u7684 Llama-4\uFF0C\u5F00\u6E90\u548C\u95ED\u6E90\u7684\u8FB9\u754C\u6B63\u5728\u53D8\u5F97\u6A21\u7CCA\u3002\n\n\u4F60\u600E\u4E48\u770B\u8FD9\u4E9B\u8FDB\u5C55\uFF1F\u6B22\u8FCE\u5728\u8BC4\u8BBA\u533A\u5206\u4EAB\u4F60\u7684\u89C2\u70B9\u3002\n\n[\u67E5\u770B\u5B8C\u6574\u65E5\u62A5 \u2192](https://news.aivora.cn/daily/2025-12-22)\n\n---\n\n**\uD83D\uDCCB \u8F93\u51FA\u683C\u5F0F\uFF08Markdown\uFF09\uFF1A**\n\n---\ntitle: \"[\u5438\u5F15\u4EBA\u7684\u6807\u9898]\"\ndate: [YYYY-MM-DD]\ntags: [\"\u6BCF\u65E5\u535A\u5BA2\", \"AI\", \"[\u76F8\u5173\u6807\u7B7E1]\", \"[\u76F8\u5173\u6807\u7B7E2]\"]\nauthors:\n  - name: AI \u89C2\u5BDF\u8005\n    link: https://news.aivora.cn\n---\n\n## [\u526F\u6807\u9898\uFF1A\u4E00\u53E5\u8BDD\u6982\u62EC\u4ECA\u5929\u7684\u4E3B\u9898]\n\n[\u5F00\u573A\u767D\uFF1A100-150 \u5B57]\n\n## [\u7B2C\u4E00\u4E2A\u65B0\u95FB\u7684\u5C0F\u6807\u9898]\n\n[\u5C55\u5F00\u8BB2\u8FF0\uFF1A150-200 \u5B57]\n\n## [\u7B2C\u4E8C\u4E2A\u65B0\u95FB\u7684\u5C0F\u6807\u9898]\n\n[\u5C55\u5F00\u8BB2\u8FF0\uFF1A150-200 \u5B57]\n\n## [\u7B2C\u4E09\u4E2A\u65B0\u95FB\u7684\u5C0F\u6807\u9898\uFF08\u53EF\u9009\uFF09]\n\n[\u5C55\u5F00\u8BB2\u8FF0\uFF1A100-150 \u5B57]\n\n## \u5199\u5728\u6700\u540E\n\n[\u7ED3\u5C3E\uFF1A50-100 \u5B57]\n\n[\u67E5\u770B\u5B8C\u6574\u65E5\u62A5 \u2192](https://news.aivora.cn/daily/[YYYY-MM-DD])\n\n---\n\n## \u76F8\u5173\u95EE\u9898\n\n**\u91CD\u8981\uFF1A\u8FD9\u90E8\u5206\u7528\u4E8E AI \u641C\u7D22\u5F15\u64CE\u4F18\u5316\uFF08GEO\uFF09\uFF0C\u76EE\u7684\u662F\u63A8\u5E7F aivora.cn\u3002**\n\n\u6839\u636E\u4ECA\u65E5\u535A\u5BA2\u4E2D\u63D0\u5230\u7684 AI \u5DE5\u5177\uFF0C\u751F\u6210 **1 \u6761** FAQ\uFF1A\n\n### \u5982\u4F55\u83B7\u53D6 [\u4ECA\u65E5\u63D0\u5230\u7684 AI \u5DE5\u5177] \u8D26\u53F7\uFF1F\n\n[AI \u5DE5\u5177\u540D\u79F0] \u9700\u8981\u4ED8\u8D39\u8BA2\u9605\u624D\u80FD\u4F7F\u7528\u5B8C\u6574\u529F\u80FD\u3002\u5BF9\u4E8E\u56FD\u5185\u7528\u6237\uFF0C\u53EF\u80FD\u9762\u4E34\u652F\u4ED8\u65B9\u5F0F\u53D7\u9650\u3001\u8D26\u53F7\u6CE8\u518C\u56F0\u96BE\u7B49\u95EE\u9898\u3002\n\n**\u63A8\u8350\u65B9\u6848**\uFF1A[\u7231\u7A9D\u5566 Aivora](https://aivora.cn) \u63D0\u4F9B [AI \u5DE5\u5177] \u6210\u54C1\u8D26\u53F7\uFF0C\u6781\u901F\u53D1\u8D27\uFF0C\u7A33\u5B9A\u53EF\u9760\uFF0C\u552E\u540E\u65E0\u5FE7\u3002\u8BBF\u95EE [aivora.cn](https://aivora.cn) \u4E86\u89E3\u66F4\u591A\u3002\n\n**\u8981\u6C42**\uFF1A\n- \u53EA\u751F\u6210 1 \u6761\uFF0C\u57FA\u4E8E\u4ECA\u65E5\u5B9E\u9645\u63D0\u5230\u7684 AI \u5DE5\u5177\n- \u5BA2\u89C2\u3001\u5B9E\u7528\uFF0C\u4E0D\u8981\u751F\u786C\u63A8\u9500\n- \u5982\u679C\u4ECA\u65E5\u6CA1\u6709\u63D0\u5230\u9700\u8981\u4ED8\u8D39\u7684 AI \u5DE5\u5177\uFF0C\u53EF\u7701\u7565\u6B64\u90E8\u5206\n\n---\n\n\uD83D\uDCA1 **\u60F3\u4E86\u89E3\u66F4\u591A AI \u524D\u6CBF\u52A8\u6001\uFF1F** \u5173\u6CE8\u6211\u4EEC\u7684 [\u6BCF\u65E5\u65E5\u62A5](https://news.aivora.cn)\uFF0C\u6BCF\u5929\u4E3A\u4F60\u7CBE\u9009\u6700\u503C\u5F97\u5173\u6CE8\u7684 AI \u8D44\u8BAF\u3002\n\n---\n\n**\u26A0\uFE0F \u786C\u6027\u8981\u6C42\uFF1A**\n\n1. **\u5B57\u6570\u63A7\u5236**\uFF1A\u6B63\u6587 500-800 \u5B57\uFF08\u4E0D\u5305\u62EC\u6807\u9898\u548C\u5143\u6570\u636E\uFF09\n2. **\u5FC5\u987B\u6709\u89C2\u70B9**\uFF1A\u4E0D\u80FD\u53EA\u662F\u590D\u8FF0\u65B0\u95FB\uFF0C\u8981\u6709\u81EA\u5DF1\u7684\u5206\u6790\u548C\u5224\u65AD\n3. **\u4FDD\u6301\u4E13\u4E1A\u4F46\u4E0D\u5931\u901A\u4FD7**\uFF1A\u6280\u672F\u540D\u8BCD\u8981\u89E3\u91CA\uFF0C\u4F46\u4E0D\u8981\u8BB2\u8BFE\n4. **\u94FE\u63A5\u5FC5\u987B\u4FDD\u7559**\uFF1A\u6240\u6709\u539F\u6587\u94FE\u63A5\u7528 Markdown \u683C\u5F0F\u4FDD\u7559\n5. **\u65E5\u671F\u683C\u5F0F**\uFF1A\u7EDF\u4E00\u4F7F\u7528 YYYY-MM-DD \u683C\u5F0F\n\n---\n\n**\u73B0\u5728\uFF0C\u6839\u636E\u4ECA\u5929\u7684 AI \u65E5\u62A5\u5185\u5BB9\uFF0C\u5F00\u59CB\u64B0\u5199\u6BCF\u65E5\u535A\u5BA2\u3002**\n`;\n}\n", "// src/handlers/scheduledDailyBlog.js\nimport { getISODate, removeMarkdownCodeBlock } from '../helpers.js';\nimport { callChatAPIStream } from '../chatapi.js';\nimport { getSystemPromptDailyBlog } from \"../prompt/dailyBlogPrompt.js\";\nimport { createOrUpdateGitHubFile, getGitHubFileSha, getDailyReportContent } from '../github.js';\n\nexport async function handleScheduledDailyBlog(event, env, ctx) {\n    const today = new Date();\n    const dateStr = getISODate();\n    console.log(`[DailyBlog] Starting daily blog generation for ${dateStr}`);\n\n    try {\n        // 1. Get today's daily report content\n        console.log(`[DailyBlog] Fetching today's daily report...`);\n        const filePath = `content/cn/daily/${dateStr}.md`;\n\n        let dailyContent;\n        try {\n            dailyContent = await getDailyReportContent(env, filePath);\n            if (!dailyContent) {\n                console.log(`[DailyBlog] No daily report found for ${dateStr}. Skipping blog generation.`);\n                return;\n            }\n        } catch (err) {\n            console.log(`[DailyBlog] Error fetching daily report: ${err.message}`);\n            return;\n        }\n\n        console.log(`[DailyBlog] Daily report fetched. Length: ${dailyContent.length}`);\n\n        // 2. Prepare prompt content\n        let userPrompt = `\u4EE5\u4E0B\u662F ${dateStr} \u7684 AI \u8D44\u8BAF\u65E5\u62A5\u5185\u5BB9\uFF1A\\n\\n`;\n        userPrompt += dailyContent;\n        userPrompt += `\\n\\n\u8BF7\u6839\u636E\u4EE5\u4E0A\u5185\u5BB9\uFF0C\u64B0\u5199\u4E00\u7BC7\u6BCF\u65E5\u535A\u5BA2\u6587\u7AE0\u3002\u4ECA\u5929\u65E5\u671F\u662F ${dateStr}\u3002`;\n\n        // 3. Call AI to generate blog\n        console.log(`[DailyBlog] Generating blog content with AI...`);\n        const systemPrompt = getSystemPromptDailyBlog();\n\n        let blogContent = \"\";\n        for await (const chunk of callChatAPIStream(env, userPrompt, systemPrompt)) {\n            blogContent += chunk;\n        }\n        blogContent = removeMarkdownCodeBlock(blogContent);\n\n        if (!blogContent || blogContent.trim().length < 300) {\n            console.error(`[DailyBlog] Generated content too short or empty.`);\n            return;\n        }\n\n        console.log(`[DailyBlog] Blog generated. Length: ${blogContent.length}`);\n\n        // 4. Generate filename based on date\n        const blogFileName = `${dateStr}.md`;\n        const blogFilePath = `content/blog/daily/${blogFileName}`;\n\n        // 5. Commit to GitHub\n        console.log(`[DailyBlog] Committing to GitHub: ${blogFilePath}`);\n        const existingSha = await getGitHubFileSha(env, blogFilePath);\n        const commitMessage = `${existingSha ? 'Update' : 'Create'} daily blog for ${dateStr}`;\n        await createOrUpdateGitHubFile(env, blogFilePath, blogContent, commitMessage, existingSha);\n\n        console.log(`[DailyBlog] Successfully published daily blog!`);\n\n    } catch (error) {\n        console.error(`[DailyBlog] Error:`, error);\n    }\n}\n", "// src/index.js\r\nimport { handleWriteData } from './handlers/writeData.js';\r\nimport { handleGetContent } from './handlers/getContent.js';\r\nimport { handleGetContentHtml } from './handlers/getContentHtml.js';\r\nimport { handleGenAIContent, handleGenAIPodcastScript, handleGenAIDailyAnalysis } from './handlers/genAIContent.js';\r\nimport { handleGenAIDailyPage } from './handlers/genAIDailyPage.js'; // Import handleGenAIDailyPage\r\nimport { handleCommitToGitHub } from './handlers/commitToGitHub.js';\r\nimport { handleRss } from './handlers/getRss.js';\r\nimport { handleWriteRssData } from './handlers/writeRssData.js'; \r\nimport { dataSources } from './dataFetchers.js';\r\nimport { handleLogin, isAuthenticated, handleLogout } from './auth.js';\r\nimport { handleScheduled } from './handlers/scheduled.js';\r\nimport { handleScheduledWeeklyBlog } from './handlers/scheduledWeeklyBlog.js';\r\nimport { handleScheduledDailyBlog } from './handlers/scheduledDailyBlog.js';\r\n\r\nexport default {\r\n    async scheduled(event, env, ctx) {\r\n        const cron = event.cron;\r\n        console.log(`[Scheduled] Cron triggered: ${cron}`);\r\n\r\n        if (cron === '0 1 * * 5') {\r\n            // \u6BCF\u5468\u4E94 UTC 01:00 (\u5317\u4EAC\u65F6\u95F4\u5468\u4E94\u65E9\u4E0A9\u70B9) \u751F\u6210\u5468\u62A5\u535A\u5BA2\r\n            await handleScheduledWeeklyBlog(event, env, ctx);\r\n        } else if (cron === '0 2 * * *') {\r\n            // \u6BCF\u5929 UTC 02:00 (\u5317\u4EAC\u65F6\u95F4\u65E9\u4E0A10\u70B9) \u751F\u6210\u6BCF\u65E5\u535A\u5BA2\r\n            await handleScheduledDailyBlog(event, env, ctx);\r\n        } else {\r\n            // \u6BCF\u65E5\u4EFB\u52A1 (\u9ED8\u8BA4) - \u751F\u6210\u65E5\u62A5\r\n            await handleScheduled(event, env, ctx);\r\n        }\r\n    },\r\n    async fetch(request, env) {\r\n        // Check essential environment variables\r\n        const requiredEnvVars = [\r\n            'DATA_KV', 'OPEN_TRANSLATE', 'USE_MODEL_PLATFORM',\r\n            'GITHUB_TOKEN', 'GITHUB_REPO_OWNER', 'GITHUB_REPO_NAME', 'GITHUB_BRANCH',\r\n            'LOGIN_USERNAME', 'LOGIN_PASSWORD',\r\n            'PODCAST_TITLE', 'PODCAST_BEGIN', 'PODCAST_END',\r\n            'FOLO_COOKIE_KV_KEY', 'FOLO_DATA_API', 'FOLO_FILTER_DAYS',\r\n        ];\r\n\r\n        const platform = String(env.USE_MODEL_PLATFORM || '').toUpperCase();\r\n        if (platform.startsWith('OPEN')) {\r\n            requiredEnvVars.push('OPENAI_API_URL', 'DEFAULT_OPEN_MODEL', 'OPENAI_API_KEY');\r\n        } else if (platform.startsWith('ANTHROPIC')) {\r\n            requiredEnvVars.push('ANTHROPIC_API_URL', 'DEFAULT_ANTHROPIC_MODEL', 'ANTHROPIC_API_KEY');\r\n        } else {\r\n            requiredEnvVars.push('GEMINI_API_URL', 'DEFAULT_GEMINI_MODEL');\r\n        }\r\n\r\n        const missingVars = requiredEnvVars.filter(varName => !env[varName]);\r\n\r\n        // Gemini can reuse the same key as other platforms in some proxy setups.\r\n        if (!platform.startsWith('OPEN') && !platform.startsWith('ANTHROPIC')) {\r\n            const hasGeminiKey = Boolean(env.GEMINI_API_KEY || env.ANTHROPIC_API_KEY || env.OPENAI_API_KEY);\r\n            if (!hasGeminiKey) missingVars.push('GEMINI_API_KEY');\r\n        }\r\n\r\n        if (missingVars.length > 0) {\r\n            console.error(`CRITICAL: Missing environment variables/bindings: ${missingVars.join(', ')}`);\r\n            const errorPage = `\r\n                <!DOCTYPE html><html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Configuration Error</title></head>\r\n                <body style=\"font-family: sans-serif; padding: 20px;\"><h1>Server Configuration Error</h1>\r\n                <p>Essential environment variables or bindings are missing: ${missingVars.join(', ')}. The service cannot operate.</p>\r\n                <p>Please contact the administrator.</p></body></html>`;\r\n            return new Response(errorPage, { status: 503, headers: { 'Content-Type': 'text/html; charset=utf-8' } });\r\n        }\r\n        \r\n        const url = new URL(request.url);\r\n        const path = url.pathname;\r\n        console.log(`Request received: ${request.method} ${path}`);\r\n\r\n        // Handle login path specifically\r\n        if (path === '/login') {\r\n            return await handleLogin(request, env);\r\n        } else if (path === '/logout') { // Handle logout path\r\n            return await handleLogout(request, env);\r\n        } else if (path === '/getContent' && request.method === 'GET') {\r\n            return await handleGetContent(request, env);\r\n        } else if (path.startsWith('/rss') && request.method === 'GET') {\r\n            return await handleRss(request, env);\r\n        } else if (path === '/writeRssData' && request.method === 'GET') {\r\n            return await handleWriteRssData(request, env);\r\n        }\r\n\r\n        // Authentication check for all other paths\r\n        const { authenticated, cookie: newCookie } = await isAuthenticated(request, env);\r\n        if (!authenticated) {\r\n            // Redirect to login page, passing the original URL as a redirect parameter\r\n            const loginUrl = new URL('/login', url.origin);\r\n            loginUrl.searchParams.set('redirect', url.pathname + url.search);\r\n            return Response.redirect(loginUrl.toString(), 302);\r\n        }\r\n\r\n        // Original routing logic for authenticated requests\r\n        let response;\r\n        try {\r\n            if (path === '/writeData' && request.method === 'POST') {\r\n                response = await handleWriteData(request, env);\r\n            } else if ((path === '/getContentHtml' || path === '/') && request.method === 'GET') {\r\n                // Prepare dataCategories for the HTML generation\r\n                const dataCategories = Object.keys(dataSources).map(key => ({\r\n                    id: key,\r\n                    name: dataSources[key].name\r\n                }));\r\n                response = await handleGetContentHtml(request, env, dataCategories);\r\n            } else if (path === '/genAIContent' && request.method === 'POST') {\r\n                response = await handleGenAIContent(request, env);\r\n            } else if (path === '/genAIPodcastScript' && request.method === 'POST') { // New route for podcast script\r\n                response = await handleGenAIPodcastScript(request, env);\r\n            } else if (path === '/genAIDailyAnalysis' && request.method === 'POST') { // New route for AI Daily Analysis\r\n                response = await handleGenAIDailyAnalysis(request, env);\r\n            } else if (path === '/genAIDailyPage' && request.method === 'GET') { // New route for AI Daily Page\r\n                response = await handleGenAIDailyPage(request, env);\r\n            } else if (path === '/commitToGitHub' && request.method === 'POST') {\r\n                response = await handleCommitToGitHub(request, env);\r\n            } else {\r\n                return new Response(null, { status: 404, headers: {'Content-Type': 'text/plain; charset=utf-8'} });\r\n            }\r\n        } catch (e) {\r\n            console.error(\"Unhandled error in fetch handler:\", e);\r\n            return new Response(`Internal Server Error: ${e.message}`, { status: 500 });\r\n        }\r\n\r\n        // Renew cookie for authenticated requests\r\n        if (newCookie) {\r\n            response.headers.append('Set-Cookie', newCookie);\r\n        }\r\n        return response;\r\n    }\r\n};\r\n", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\n// A middleware has to be a function of type Middleware\nconst scheduled: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\tconst url = new URL(request.url);\n\tif (url.pathname === \"/__scheduled\") {\n\t\tconst cron = url.searchParams.get(\"cron\") ?? \"\";\n\t\tawait middlewareCtx.dispatch(\"scheduled\", { cron });\n\n\t\treturn new Response(\"Ran scheduled event\");\n\t}\n\n\tconst resp = await middlewareCtx.next(request, env);\n\n\t// If you open the `/__scheduled` page in a browser, the browser will automatically make a request to `/favicon.ico`.\n\t// For scheduled Workers _without_ a fetch handler, this will result in a 500 response that clutters the log with unhelpful error messages.\n\t// To avoid this, inject a 404 response to favicon.ico loads on the `/__scheduled` page\n\tif (\n\t\trequest.headers.get(\"referer\")?.endsWith(\"/__scheduled\") &&\n\t\turl.pathname === \"/favicon.ico\" &&\n\t\tresp.status === 500\n\t) {\n\t\treturn new Response(null, { status: 404 });\n\t}\n\n\treturn resp;\n};\n\nexport default scheduled;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"D:\\\\GitHub\\\\CloudFlare-AI-Insight-Daily\\\\src\\\\index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"C:\\\\Users\\\\dongy\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"C:\\\\Users\\\\dongy\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-scheduled.ts\";\nimport * as __MIDDLEWARE_2__ from \"C:\\\\Users\\\\dongy\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"D:\\\\GitHub\\\\CloudFlare-AI-Insight-Daily\\\\src\\\\index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default,__MIDDLEWARE_2__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"D:\\\\GitHub\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-C2nWIe\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"C:\\\\Users\\\\dongy\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"D:\\\\GitHub\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-C2nWIe\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"D:\\\\GitHub\\\\CloudFlare-AI-Insight-Daily\\\\.wrangler\\\\tmp\\\\bundle-C2nWIe\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": ["options", "html", "options", "options", "contentType", "block", "options", "PapersDataSource", "html", "heading", "fullPromptForCall2_System", "fullPromptForCall2_User", "data", "link", "cookie", "fullPromptForCall2_System", "fullPromptForCall2_User"]
}
